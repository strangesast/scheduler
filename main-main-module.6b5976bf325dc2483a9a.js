(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{"/uUt":function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n("7o/Q");function i(t,e){return n=>n.lift(new o(t,e))}class o{constructor(t,e){this.compare=t,this.keySelector=e}call(t,e){return e.subscribe(new s(t,this.compare,this.keySelector))}}class s extends r.a{constructor(t,e,n){super(t),this.keySelector=n,this.hasKey=!1,"function"==typeof e&&(this.compare=e)}compare(t,e){return t===e}_next(t){let e;try{const{keySelector:n}=this;e=n?n(t):t}catch(r){return this.destination.error(r)}let n=!1;if(this.hasKey)try{const{compare:t}=this;n=t(this.key,e)}catch(r){return this.destination.error(r)}else this.hasKey=!0;n||(this.key=e,this.destination.next(t))}}},"6Joi":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,i=n("Tr+X"),o=(r=n("wj3C"))&&"object"==typeof r&&"default"in r?r.default:r,s=n("q/0M"),u=n("zVF4"),a=n("x7I3"),c=n("S+S0"),h=new s.Logger("@firebase/firestore");function f(){return h.logLevel}function l(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(h.logLevel<=s.LogLevel.DEBUG){var r=e.map(d);h.debug.apply(h,i.__spreadArrays(["Firestore (7.17.1): "+t],r))}}function p(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(h.logLevel<=s.LogLevel.ERROR){var r=e.map(d);h.error.apply(h,i.__spreadArrays(["Firestore (7.17.1): "+t],r))}}function d(t){if("string"==typeof t)return t;try{return JSON.stringify(t)}catch(i){return t}}function y(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE (7.17.1) INTERNAL ASSERTION FAILED: "+t;throw p(e),new Error(e)}function v(t,e){t||y()}function g(t,e){return t}function b(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}var m=function(){function t(){}return t.t=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=b(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},t}();function w(t,e){return t<e?-1:t>e?1:0}function _(t,e,n){return t.length===e.length&&t.every((function(t,r){return n(t,e[r])}))}function I(t){return t+"\0"}var E=function(t,e,n,r,i){this.s=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i},T=function(){function t(t,e){this.projectId=t,this.database=e||"(default)"}return Object.defineProperty(t.prototype,"i",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t.prototype.o=function(t){return w(this.projectId,t.projectId)||w(this.database,t.database)},t}();function A(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function O(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function N(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var S=function(){function t(t,e){this.h=t,this.u=e,this.l={}}return t.prototype.get=function(t){var e=this.h(t),n=this.l[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[1];if(this.u(o[0],t))return s}},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.set=function(t,e){var n=this.h(t),r=this.l[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.u(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.l[n]=[[t,e]]},t.prototype.delete=function(t){var e=this.h(t),n=this.l[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.u(n[r][0],t))return 1===n.length?delete this.l[e]:n.splice(r,1),!0;return!1},t.prototype.forEach=function(t){O(this.l,(function(e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];t(o[0],o[1])}}))},t.prototype._=function(){return N(this.l)},t}(),x={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},P=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).code=e,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return i.__extends(e,t),e}(Error),D=function(){function t(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new P(x.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new P(x.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new P(x.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new P(x.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return t.now=function(){return t.fromMillis(Date.now())},t.fromDate=function(e){return t.fromMillis(e.getTime())},t.fromMillis=function(e){var n=Math.floor(e/1e3);return new t(n,1e6*(e-1e3*n))},t.prototype.toDate=function(){return new Date(this.toMillis())},t.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},t.prototype.T=function(t){return this.seconds===t.seconds?w(this.nanoseconds,t.nanoseconds):w(this.seconds,t.seconds)},t.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},t.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},t.prototype.valueOf=function(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},t}(),k=function(){function t(t){this.timestamp=t}return t.I=function(e){return new t(e)},t.min=function(){return new t(new D(0,0))},t.prototype.o=function(t){return this.timestamp.T(t.timestamp)},t.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},t.prototype.m=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},t.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},t.prototype.A=function(){return this.timestamp},t}(),j=function(){function t(t,e,n){void 0===e?e=0:e>t.length&&y(),void 0===n?n=t.length-e:n>t.length-e&&y(),this.segments=t,this.offset=e,this.R=n}return Object.defineProperty(t.prototype,"length",{get:function(){return this.R},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return 0===t.P(this,e)},t.prototype.child=function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach((function(t){n.push(t)})):n.push(e),this.g(n)},t.prototype.limit=function(){return this.offset+this.length},t.prototype.V=function(t){return this.g(this.segments,this.offset+(t=void 0===t?1:t),this.length-t)},t.prototype.p=function(){return this.g(this.segments,this.offset,this.length-1)},t.prototype.v=function(){return this.segments[this.offset]},t.prototype.S=function(){return this.get(this.length-1)},t.prototype.get=function(t){return this.segments[this.offset+t]},t.prototype._=function(){return 0===this.length},t.prototype.D=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.C=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},t.prototype.F=function(){return this.segments.slice(this.offset,this.limit())},t.P=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0},t}(),L=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i.__extends(e,t),e.prototype.g=function(t,n,r){return new e(t,n,r)},e.prototype.$=function(){return this.F().join("/")},e.prototype.toString=function(){return this.$()},e.N=function(t){if(t.indexOf("//")>=0)throw new P(x.INVALID_ARGUMENT,"Invalid path ("+t+"). Paths must not contain // in them.");return new e(t.split("/").filter((function(t){return t.length>0})))},e.k=function(){return new e([])},e}(j),C=/^[_a-zA-Z][_a-zA-Z0-9]*$/,R=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i.__extends(e,t),e.prototype.g=function(t,n,r){return new e(t,n,r)},e.M=function(t){return C.test(t)},e.prototype.$=function(){return this.F().map((function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),e.M(t)||(t="`"+t+"`"),t})).join(".")},e.prototype.toString=function(){return this.$()},e.prototype.O=function(){return 1===this.length&&"__name__"===this.get(0)},e.L=function(){return new e(["__name__"])},e.q=function(t){for(var n=[],r="",i=0,o=function(){if(0===r.length)throw new P(x.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");n.push(r),r=""},s=!1;i<t.length;){var u=t[i];if("\\"===u){if(i+1===t.length)throw new P(x.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var a=t[i+1];if("\\"!==a&&"."!==a&&"`"!==a)throw new P(x.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=a,i+=2}else"`"===u?(s=!s,i++):"."!==u||s?(r+=u,i++):(o(),i++)}if(o(),s)throw new P(x.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new e(n)},e.k=function(){return new e([])},e}(j),U=function(){function t(t){this.path=t}return t.B=function(e){return new t(L.N(e).V(5))},t.prototype.U=function(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t},t.prototype.isEqual=function(t){return null!==t&&0===L.P(this.path,t.path)},t.prototype.toString=function(){return this.path.toString()},t.P=function(t,e){return L.P(t.path,e.path)},t.W=function(t){return t.length%2==0},t.j=function(e){return new t(new L(e.slice()))},t}();function M(t){return null==t}function F(t){return-0===t&&1/t==-1/0}function V(t){return"number"==typeof t&&Number.isInteger(t)&&!F(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}var q=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.K=null};function B(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new q(t,e,n,r,i,o,s)}function z(t){var e=g(t);if(null===e.K){var n=e.path.$();null!==e.collectionGroup&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map((function(t){return function(t){return t.field.$()+t.op.toString()+Lt(t.value)}(t)})).join(","),n+="|ob:",n+=e.orderBy.map((function(t){return(e=t).field.$()+e.dir;var e})).join(","),M(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=Sn(e.startAt)),e.endAt&&(n+="|ub:",n+=Sn(e.endAt)),e.K=n}return e.K}function G(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n=0;n<t.orderBy.length;n++)if(!jn(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(var r=0;r<t.filters.length;r++)if(o=e.filters[r],!((i=t.filters[r])instanceof _n&&o instanceof _n&&i.op===o.op&&i.field.isEqual(o.field)&&Pt(i.value,o.value)))return!1;var i,o;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Pn(t.startAt,e.startAt)&&Pn(t.endAt,e.endAt)}function W(t){return U.W(t.path)&&null===t.collectionGroup&&0===t.filters.length}var Q=function(){function t(t){this.G=t}return t.fromBase64String=function(e){return new t(atob(e))},t.fromUint8Array=function(e){return new t(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(e))},t.prototype.toBase64=function(){return btoa(this.G)},t.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.G)},t.prototype.H=function(){return 2*this.G.length},t.prototype.o=function(t){return w(this.G,t.G)},t.prototype.isEqual=function(t){return this.G===t.G},t}();Q.Y=new Q("");var H,K,X=function(){function t(t,e,n,r,i,o,s){void 0===i&&(i=k.min()),void 0===o&&(o=k.min()),void 0===s&&(s=Q.Y),this.target=t,this.targetId=e,this.J=n,this.sequenceNumber=r,this.X=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}return t.prototype.Z=function(e){return new t(this.target,this.targetId,this.J,e,this.X,this.lastLimboFreeSnapshotVersion,this.resumeToken)},t.prototype.tt=function(e,n){return new t(this.target,this.targetId,this.J,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)},t.prototype.et=function(e){return new t(this.target,this.targetId,this.J,this.sequenceNumber,this.X,e,this.resumeToken)},t}(),$=function(t){this.count=t};function Y(t){switch(t){case x.OK:return y();case x.CANCELLED:case x.UNKNOWN:case x.DEADLINE_EXCEEDED:case x.RESOURCE_EXHAUSTED:case x.INTERNAL:case x.UNAVAILABLE:case x.UNAUTHENTICATED:return!1;case x.INVALID_ARGUMENT:case x.NOT_FOUND:case x.ALREADY_EXISTS:case x.PERMISSION_DENIED:case x.FAILED_PRECONDITION:case x.ABORTED:case x.OUT_OF_RANGE:case x.UNIMPLEMENTED:case x.DATA_LOSS:return!0;default:return y()}}function J(t){if(void 0===t)return p("GRPC error has no .code"),x.UNKNOWN;switch(t){case H.OK:return x.OK;case H.CANCELLED:return x.CANCELLED;case H.UNKNOWN:return x.UNKNOWN;case H.DEADLINE_EXCEEDED:return x.DEADLINE_EXCEEDED;case H.RESOURCE_EXHAUSTED:return x.RESOURCE_EXHAUSTED;case H.INTERNAL:return x.INTERNAL;case H.UNAVAILABLE:return x.UNAVAILABLE;case H.UNAUTHENTICATED:return x.UNAUTHENTICATED;case H.INVALID_ARGUMENT:return x.INVALID_ARGUMENT;case H.NOT_FOUND:return x.NOT_FOUND;case H.ALREADY_EXISTS:return x.ALREADY_EXISTS;case H.PERMISSION_DENIED:return x.PERMISSION_DENIED;case H.FAILED_PRECONDITION:return x.FAILED_PRECONDITION;case H.ABORTED:return x.ABORTED;case H.OUT_OF_RANGE:return x.OUT_OF_RANGE;case H.UNIMPLEMENTED:return x.UNIMPLEMENTED;case H.DATA_LOSS:return x.DATA_LOSS;default:return y()}}(K=H||(H={}))[K.OK=0]="OK",K[K.CANCELLED=1]="CANCELLED",K[K.UNKNOWN=2]="UNKNOWN",K[K.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",K[K.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",K[K.NOT_FOUND=5]="NOT_FOUND",K[K.ALREADY_EXISTS=6]="ALREADY_EXISTS",K[K.PERMISSION_DENIED=7]="PERMISSION_DENIED",K[K.UNAUTHENTICATED=16]="UNAUTHENTICATED",K[K.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",K[K.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",K[K.ABORTED=10]="ABORTED",K[K.OUT_OF_RANGE=11]="OUT_OF_RANGE",K[K.UNIMPLEMENTED=12]="UNIMPLEMENTED",K[K.INTERNAL=13]="INTERNAL",K[K.UNAVAILABLE=14]="UNAVAILABLE",K[K.DATA_LOSS=15]="DATA_LOSS";var Z=function(){function t(t,e){this.P=t,this.root=e||et.EMPTY}return t.prototype.nt=function(e,n){return new t(this.P,this.root.nt(e,n,this.P).copy(null,null,et.st,null,null))},t.prototype.remove=function(e){return new t(this.P,this.root.remove(e,this.P).copy(null,null,et.st,null,null))},t.prototype.get=function(t){for(var e=this.root;!e._();){var n=this.P(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null},t.prototype.indexOf=function(t){for(var e=0,n=this.root;!n._();){var r=this.P(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1},t.prototype._=function(){return this.root._()},Object.defineProperty(t.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),t.prototype.it=function(){return this.root.it()},t.prototype.rt=function(){return this.root.rt()},t.prototype.ot=function(t){return this.root.ot(t)},t.prototype.forEach=function(t){this.ot((function(e,n){return t(e,n),!1}))},t.prototype.toString=function(){var t=[];return this.ot((function(e,n){return t.push(e+":"+n),!1})),"{"+t.join(", ")+"}"},t.prototype.ht=function(t){return this.root.ht(t)},t.prototype.at=function(){return new tt(this.root,null,this.P,!1)},t.prototype.ut=function(t){return new tt(this.root,t,this.P,!1)},t.prototype.ct=function(){return new tt(this.root,null,this.P,!0)},t.prototype.lt=function(t){return new tt(this.root,t,this.P,!0)},t}(),tt=function(){function t(t,e,n,r){this._t=r,this.ft=[];for(var i=1;!t._();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this._t?t.left:t.right;else{if(0===i){this.ft.push(t);break}this.ft.push(t),t=this._t?t.right:t.left}}return t.prototype.dt=function(){var t=this.ft.pop(),e={key:t.key,value:t.value};if(this._t)for(t=t.left;!t._();)this.ft.push(t),t=t.right;else for(t=t.right;!t._();)this.ft.push(t),t=t.left;return e},t.prototype.wt=function(){return this.ft.length>0},t.prototype.Tt=function(){if(0===this.ft.length)return null;var t=this.ft[this.ft.length-1];return{key:t.key,value:t.value}},t}(),et=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:t.EMPTY,this.right=null!=o?o:t.EMPTY,this.size=this.left.size+1+this.right.size}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype._=function(){return!1},t.prototype.ot=function(t){return this.left.ot(t)||t(this.key,this.value)||this.right.ot(t)},t.prototype.ht=function(t){return this.right.ht(t)||t(this.key,this.value)||this.left.ht(t)},t.prototype.min=function(){return this.left._()?this:this.left.min()},t.prototype.it=function(){return this.min().key},t.prototype.rt=function(){return this.right._()?this.key:this.right.rt()},t.prototype.nt=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.nt(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.nt(t,e,n))).Et()},t.prototype.It=function(){if(this.left._())return t.EMPTY;var e=this;return e.left.At()||e.left.left.At()||(e=e.Rt()),(e=e.copy(null,null,null,e.left.It(),null)).Et()},t.prototype.remove=function(e,n){var r,i=this;if(n(e,i.key)<0)i.left._()||i.left.At()||i.left.left.At()||(i=i.Rt()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.At()&&(i=i.Pt()),i.right._()||i.right.At()||i.right.left.At()||(i=i.gt()),0===n(e,i.key)){if(i.right._())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.It())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.Et()},t.prototype.At=function(){return this.color},t.prototype.Et=function(){var t=this;return t.right.At()&&!t.left.At()&&(t=t.Vt()),t.left.At()&&t.left.left.At()&&(t=t.Pt()),t.left.At()&&t.right.At()&&(t=t.yt()),t},t.prototype.Rt=function(){var t=this.yt();return t.right.left.At()&&(t=(t=(t=t.copy(null,null,null,null,t.right.Pt())).Vt()).yt()),t},t.prototype.gt=function(){var t=this.yt();return t.left.left.At()&&(t=(t=t.Pt()).yt()),t},t.prototype.Vt=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.Pt=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.yt=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.pt=function(){var t=this.bt();return Math.pow(2,t)<=this.size+1},t.prototype.bt=function(){if(this.At()&&this.left.At())throw y();if(this.right.At())throw y();var t=this.left.bt();if(t!==this.right.bt())throw y();return t+(this.At()?0:1)},t}();et.EMPTY=null,et.RED=!0,et.st=!1,et.EMPTY=new(function(){function t(){this.size=0}return Object.defineProperty(t.prototype,"key",{get:function(){throw y()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){throw y()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){throw y()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){throw y()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){throw y()},enumerable:!1,configurable:!0}),t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.nt=function(t,e,n){return new et(t,e)},t.prototype.remove=function(t,e){return this},t.prototype._=function(){return!0},t.prototype.ot=function(t){return!1},t.prototype.ht=function(t){return!1},t.prototype.it=function(){return null},t.prototype.rt=function(){return null},t.prototype.At=function(){return!1},t.prototype.pt=function(){return!0},t.prototype.bt=function(){return 0},t}());var nt=function(){function t(t){this.P=t,this.data=new Z(this.P)}return t.prototype.has=function(t){return null!==this.data.get(t)},t.prototype.first=function(){return this.data.it()},t.prototype.last=function(){return this.data.rt()},Object.defineProperty(t.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),t.prototype.indexOf=function(t){return this.data.indexOf(t)},t.prototype.forEach=function(t){this.data.ot((function(e,n){return t(e),!1}))},t.prototype.vt=function(t,e){for(var n=this.data.ut(t[0]);n.wt();){var r=n.dt();if(this.P(r.key,t[1])>=0)return;e(r.key)}},t.prototype.St=function(t,e){var n;for(n=void 0!==e?this.data.ut(e):this.data.at();n.wt();)if(!t(n.dt().key))return},t.prototype.Dt=function(t){var e=this.data.ut(t);return e.wt()?e.dt().key:null},t.prototype.at=function(){return new rt(this.data.at())},t.prototype.ut=function(t){return new rt(this.data.ut(t))},t.prototype.add=function(t){return this.copy(this.data.remove(t).nt(t,!0))},t.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},t.prototype._=function(){return this.data._()},t.prototype.Ct=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach((function(t){e=e.add(t)})),e},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data.at(),r=e.data.at();n.wt();){var i=n.dt().key,o=r.dt().key;if(0!==this.P(i,o))return!1}return!0},t.prototype.F=function(){var t=[];return this.forEach((function(e){t.push(e)})),t},t.prototype.toString=function(){var t=[];return this.forEach((function(e){return t.push(e)})),"SortedSet("+t.toString()+")"},t.prototype.copy=function(e){var n=new t(this.P);return n.data=e,n},t}(),rt=function(){function t(t){this.Ft=t}return t.prototype.dt=function(){return this.Ft.dt().key},t.prototype.wt=function(){return this.Ft.wt()},t}(),it=new Z(U.P);function ot(){return it}function st(){return ot()}var ut=new Z(U.P);function at(){return ut}var ct=new Z(U.P),ht=new nt(U.P);function ft(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=ht,r=0,i=t;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var lt=new nt(w);function pt(){return lt}var dt=function(){function t(t){this.P=t?function(e,n){return t(e,n)||U.P(e.key,n.key)}:function(t,e){return U.P(t.key,e.key)},this.$t=at(),this.Nt=new Z(this.P)}return t.kt=function(e){return new t(e.P)},t.prototype.has=function(t){return null!=this.$t.get(t)},t.prototype.get=function(t){return this.$t.get(t)},t.prototype.first=function(){return this.Nt.it()},t.prototype.last=function(){return this.Nt.rt()},t.prototype._=function(){return this.Nt._()},t.prototype.indexOf=function(t){var e=this.$t.get(t);return e?this.Nt.indexOf(e):-1},Object.defineProperty(t.prototype,"size",{get:function(){return this.Nt.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t){this.Nt.ot((function(e,n){return t(e),!1}))},t.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.$t.nt(t.key,t),e.Nt.nt(t,null))},t.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.$t.remove(t),this.Nt.remove(e)):this},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.Nt.at(),r=e.Nt.at();n.wt();){var i=n.dt().key,o=r.dt().key;if(!i.isEqual(o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach((function(e){t.push(e.toString())})),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},t.prototype.copy=function(e,n){var r=new t;return r.P=this.P,r.$t=e,r.Nt=n,r},t}(),yt=function(){function t(){this.xt=new Z(U.P)}return t.prototype.track=function(t){var e=t.doc.key,n=this.xt.get(e);n?0!==t.type&&3===n.type?this.xt=this.xt.nt(e,t):3===t.type&&1!==n.type?this.xt=this.xt.nt(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.xt=this.xt.nt(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.xt=this.xt.nt(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.xt=this.xt.remove(e):1===t.type&&2===n.type?this.xt=this.xt.nt(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.xt=this.xt.nt(e,{type:2,doc:t.doc}):y():this.xt=this.xt.nt(e,t)},t.prototype.Mt=function(){var t=[];return this.xt.ot((function(e,n){t.push(n)})),t},t}(),vt=function(){function t(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.Ot=n,this.docChanges=r,this.Lt=i,this.fromCache=o,this.qt=s,this.Bt=u}return t.Ut=function(e,n,r,i){var o=[];return n.forEach((function(t){o.push({type:0,doc:t})})),new t(e,n,dt.kt(n),o,r,i,!0,!1)},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return!this.Lt._()},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.qt===t.qt&&this.Lt.isEqual(t.Lt)&&vn(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.Ot.isEqual(t.Ot)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},t}(),gt=function(){function t(t,e,n,r,i){this.X=t,this.Wt=e,this.Qt=n,this.jt=r,this.Kt=i}return t.Gt=function(e,n){var r=new Map;return r.set(e,bt.zt(e,n)),new t(k.min(),r,pt(),ot(),ft())},t}(),bt=function(){function t(t,e,n,r,i){this.resumeToken=t,this.Ht=e,this.Yt=n,this.Jt=r,this.Xt=i}return t.zt=function(e,n){return new t(Q.Y,n,ft(),ft(),ft())},t}(),mt=function(t,e,n,r){this.Zt=t,this.removedTargetIds=e,this.key=n,this.te=r},wt=function(t,e){this.targetId=t,this.ee=e},_t=function(t,e,n,r){void 0===n&&(n=Q.Y),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},It=function(){function t(){this.ne=0,this.se=At(),this.ie=Q.Y,this.re=!1,this.oe=!0}return Object.defineProperty(t.prototype,"Ht",{get:function(){return this.re},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resumeToken",{get:function(){return this.ie},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"he",{get:function(){return 0!==this.ne},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ae",{get:function(){return this.oe},enumerable:!1,configurable:!0}),t.prototype.ue=function(t){t.H()>0&&(this.oe=!0,this.ie=t)},t.prototype.ce=function(){var t=ft(),e=ft(),n=ft();return this.se.forEach((function(r,i){switch(i){case 0:t=t.add(r);break;case 2:e=e.add(r);break;case 1:n=n.add(r);break;default:y()}})),new bt(this.ie,this.re,t,e,n)},t.prototype.le=function(){this.oe=!1,this.se=At()},t.prototype._e=function(t,e){this.oe=!0,this.se=this.se.nt(t,e)},t.prototype.fe=function(t){this.oe=!0,this.se=this.se.remove(t)},t.prototype.de=function(){this.ne+=1},t.prototype.we=function(){this.ne-=1},t.prototype.Te=function(){this.oe=!0,this.re=!0},t}(),Et=function(){function t(t){this.Ee=t,this.Ie=new Map,this.me=ot(),this.Ae=Tt(),this.Re=new nt(w)}return t.prototype.Pe=function(t){for(var e=0,n=t.Zt;e<n.length;e++){var r=n[e];t.te instanceof nn?this.ge(r,t.te):t.te instanceof rn&&this.Ve(r,t.key,t.te)}for(var i=0,o=t.removedTargetIds;i<o.length;i++)this.Ve(o[i],t.key,t.te)},t.prototype.ye=function(t){var e=this;this.pe(t,(function(n){var r=e.be(n);switch(t.state){case 0:e.ve(n)&&r.ue(t.resumeToken);break;case 1:r.we(),r.he||r.le(),r.ue(t.resumeToken);break;case 2:r.we(),r.he||e.removeTarget(n);break;case 3:e.ve(n)&&(r.Te(),r.ue(t.resumeToken));break;case 4:e.ve(n)&&(e.Se(n),r.ue(t.resumeToken));break;default:y()}}))},t.prototype.pe=function(t,e){var n=this;t.targetIds.length>0?t.targetIds.forEach(e):this.Ie.forEach((function(t,r){n.ve(r)&&e(r)}))},t.prototype.De=function(t){var e=t.targetId,n=t.ee.count,r=this.Ce(e);if(r){var i=r.target;if(W(i))if(0===n){var o=new U(i.path);this.Ve(e,o,new rn(o,k.min()))}else v(1===n);else this.Fe(e)!==n&&(this.Se(e),this.Re=this.Re.add(e))}},t.prototype.$e=function(t){var e=this,n=new Map;this.Ie.forEach((function(r,i){var o=e.Ce(i);if(o){if(r.Ht&&W(o.target)){var s=new U(o.target.path);null!==e.me.get(s)||e.Ne(i,s)||e.Ve(i,s,new rn(s,t))}r.ae&&(n.set(i,r.ce()),r.le())}}));var r=ft();this.Ae.forEach((function(t,n){var i=!0;n.St((function(t){var n=e.Ce(t);return!n||2===n.J||(i=!1,!1)})),i&&(r=r.add(t))}));var i=new gt(t,n,this.Re,this.me,r);return this.me=ot(),this.Ae=Tt(),this.Re=new nt(w),i},t.prototype.ge=function(t,e){if(this.ve(t)){var n=this.Ne(t,e.key)?2:0;this.be(t)._e(e.key,n),this.me=this.me.nt(e.key,e),this.Ae=this.Ae.nt(e.key,this.ke(e.key).add(t))}},t.prototype.Ve=function(t,e,n){if(this.ve(t)){var r=this.be(t);this.Ne(t,e)?r._e(e,1):r.fe(e),this.Ae=this.Ae.nt(e,this.ke(e).delete(t)),n&&(this.me=this.me.nt(e,n))}},t.prototype.removeTarget=function(t){this.Ie.delete(t)},t.prototype.Fe=function(t){var e=this.be(t).ce();return this.Ee.xe(t).size+e.Yt.size-e.Xt.size},t.prototype.de=function(t){this.be(t).de()},t.prototype.be=function(t){var e=this.Ie.get(t);return e||(e=new It,this.Ie.set(t,e)),e},t.prototype.ke=function(t){var e=this.Ae.get(t);return e||(e=new nt(w),this.Ae=this.Ae.nt(t,e)),e},t.prototype.ve=function(t){var e=null!==this.Ce(t);return e||l("WatchChangeAggregator","Detected inactive target",t),e},t.prototype.Ce=function(t){var e=this.Ie.get(t);return e&&e.he?null:this.Ee.Me(t)},t.prototype.Se=function(t){var e=this;this.Ie.set(t,new It),this.Ee.xe(t).forEach((function(n){e.Ve(t,n,null)}))},t.prototype.Ne=function(t,e){return this.Ee.xe(t).has(e)},t}();function Tt(){return new Z(U.P)}function At(){return new Z(U.P)}function Ot(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Nt(t){var e=Ct(t.mapValue.fields.__local_write_time__.timestampValue);return new D(e.seconds,e.nanos)}var St=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function xt(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Ot(t)?4:10:y()}function Pt(t,e){var n=xt(t);if(n!==xt(e))return!1;switch(n){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Nt(t).isEqual(Nt(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;var n=Ct(t.timestampValue),r=Ct(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return Ut(t.bytesValue).isEqual(Ut(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return Rt(t.geoPointValue.latitude)===Rt(e.geoPointValue.latitude)&&Rt(t.geoPointValue.longitude)===Rt(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return Rt(t.integerValue)===Rt(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=Rt(t.doubleValue),r=Rt(e.doubleValue);return n===r?F(n)===F(r):isNaN(n)&&isNaN(r)}return!1}(t,e);case 9:return _(t.arrayValue.values||[],e.arrayValue.values||[],Pt);case 10:return function(t,e){var n=t.mapValue.fields||{},r=e.mapValue.fields||{};if(A(n)!==A(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!Pt(n[i],r[i])))return!1;return!0}(t,e);default:return y()}}function Dt(t,e){return void 0!==(t.values||[]).find((function(t){return Pt(t,e)}))}function kt(t,e){var n=xt(t),r=xt(e);if(n!==r)return w(n,r);switch(n){case 0:return 0;case 1:return w(t.booleanValue,e.booleanValue);case 2:return function(t,e){var n=Rt(t.integerValue||t.doubleValue),r=Rt(e.integerValue||e.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(t,e);case 3:return jt(t.timestampValue,e.timestampValue);case 4:return jt(Nt(t),Nt(e));case 5:return w(t.stringValue,e.stringValue);case 6:return function(t,e){var n=Ut(t),r=Ut(e);return n.o(r)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=w(n[i],r[i]);if(0!==o)return o}return w(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){var n=w(Rt(t.latitude),Rt(e.latitude));return 0!==n?n:w(Rt(t.longitude),Rt(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=kt(n[i],r[i]);if(o)return o}return w(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=w(r[s],o[s]);if(0!==u)return u;var a=kt(n[r[s]],i[o[s]]);if(0!==a)return a}return w(r.length,o.length)}(t.mapValue,e.mapValue);default:throw y()}}function jt(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return w(t,e);var n=Ct(t),r=Ct(e),i=w(n.seconds,r.seconds);return 0!==i?i:w(n.nanos,r.nanos)}function Lt(t){return function t(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(t){var e=Ct(t);return"time("+e.seconds+","+e.nanos+")"}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?Ut(e.bytesValue).toBase64():"referenceValue"in e?U.B(e.referenceValue).toString():"geoPointValue"in e?"geo("+(n=e.geoPointValue).latitude+","+n.longitude+")":"arrayValue"in e?function(e){for(var n="[",r=!0,i=0,o=e.values||[];i<o.length;i++)r?r=!1:n+=",",n+=t(o[i]);return n+"]"}(e.arrayValue):"mapValue"in e?function(e){for(var n="{",r=!0,i=0,o=Object.keys(e.fields||{}).sort();i<o.length;i++){var s=o[i];r?r=!1:n+=",",n+=s+":"+t(e.fields[s])}return n+"}"}(e.mapValue):y();var n}(t)}function Ct(t){if(v(!!t),"string"==typeof t){var e=0,n=St.exec(t);if(v(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:Rt(t.seconds),nanos:Rt(t.nanos)}}function Rt(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Ut(t){return"string"==typeof t?Q.fromBase64String(t):Q.fromUint8Array(t)}function Mt(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.$()}}function Ft(t){return!!t&&"integerValue"in t}function Vt(t){return!!t&&"arrayValue"in t}function qt(t){return!!t&&"nullValue"in t}function Bt(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function zt(t){return!!t&&"mapValue"in t}var Gt={asc:"ASCENDING",desc:"DESCENDING"},Wt={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Qt=function(t,e){this.s=t,this.Oe=e};function Ht(t){return{integerValue:""+t}}function Kt(t,e){if(t.Oe){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:F(e)?"-0":e}}function Xt(t,e){return V(e)?Ht(e):Kt(t,e)}function $t(t,e){return t.Oe?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Yt(t,e){return t.Oe?e.toBase64():e.toUint8Array()}function Jt(t,e){return $t(t,e.A())}function Zt(t){return v(!!t),k.I(function(t){var e=Ct(t);return new D(e.seconds,e.nanos)}(t))}function te(t,e){return function(t){return new L(["projects",t.projectId,"databases",t.database])}(t).child("documents").child(e).$()}function ee(t){var e=L.N(t);return v(we(e)),e}function ne(t,e){return te(t.s,e.path)}function re(t,e){var n=ee(e);return v(n.get(1)===t.s.projectId),v(!n.get(3)&&!t.s.database||n.get(3)===t.s.database),new U(ue(n))}function ie(t,e){return te(t.s,e)}function oe(t){var e=ee(t);return 4===e.length?L.k():ue(e)}function se(t){return new L(["projects",t.s.projectId,"databases",t.s.database]).$()}function ue(t){return v(t.length>4&&"documents"===t.get(4)),t.V(5)}function ae(t,e,n){return{name:ne(t,e),fields:n.proto.mapValue.fields}}function ce(t,e){var n;if(e instanceof Ge)n={update:ae(t,e.key,e.value)};else if(e instanceof $e)n={delete:ne(t,e.key)};else if(e instanceof We)n={update:ae(t,e.key,e.data),updateMask:me(e.Le)};else if(e instanceof He)n={transform:{document:ne(t,e.key),fieldTransforms:e.fieldTransforms.map((function(t){return function(t,e){var n=e.transform;if(n instanceof Ae)return{fieldPath:e.field.$(),setToServerValue:"REQUEST_TIME"};if(n instanceof Oe)return{fieldPath:e.field.$(),appendMissingElements:{values:n.elements}};if(n instanceof Se)return{fieldPath:e.field.$(),removeAllFromArray:{values:n.elements}};if(n instanceof Pe)return{fieldPath:e.field.$(),increment:n.qe};throw y()}(0,t)}))}};else{if(!(e instanceof Ye))return y();n={verify:ne(t,e.key)}}return e.Ue.Be||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:Jt(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:y()}(t,e.Ue)),n}function he(t,e){var n=e.currentDocument?function(t){return void 0!==t.updateTime?Re.updateTime(Zt(t.updateTime)):void 0!==t.exists?Re.exists(t.exists):Re.We()}(e.currentDocument):Re.We();if(e.update){var r=re(t,e.update.name),i=new Je({mapValue:{fields:e.update.fields}});if(e.updateMask){var o=function(t){return new je((t.fieldPaths||[]).map((function(t){return R.q(t)})))}(e.updateMask);return new We(r,i,o,n)}return new Ge(r,i,n)}if(e.delete){var s=re(t,e.delete);return new $e(s,n)}if(e.transform){var u=re(t,e.transform.document),a=e.transform.fieldTransforms.map((function(e){return function(t,e){var n=null;"setToServerValue"in e?(v("REQUEST_TIME"===e.setToServerValue),n=new Ae):"appendMissingElements"in e?n=new Oe(e.appendMissingElements.values||[]):"removeAllFromArray"in e?n=new Se(e.removeAllFromArray.values||[]):"increment"in e?n=new Pe(t,e.increment):y();var r=R.q(e.fieldPath);return new Le(r,n)}(t,e)}));return v(!0===n.exists),new He(u,a)}if(e.verify){var c=re(t,e.verify);return new Ye(c,n)}return y()}function fe(t,e){return{documents:[ie(t,e.path)]}}function le(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=ie(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=ie(t,r.p()),n.structuredQuery.from=[{collectionId:r.S()}]);var i=function(t){if(0!==t.length){var e=t.map((function(t){return t instanceof _n?function(t){if("=="===t.op){if(Bt(t.value))return{unaryFilter:{field:ye(t.field),op:"IS_NAN"}};if(qt(t.value))return{unaryFilter:{field:ye(t.field),op:"IS_NULL"}}}return{fieldFilter:{field:ye(t.field),op:(e=t.op,Wt[e]),value:t.value}};var e}(t):y()}));return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map((function(t){return{field:ye((e=t).field),direction:(n=e.dir,Gt[n])};var e,n}))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var s=function(t,e){return t.Oe||M(e)?e:{value:e}}(t,e.limit);return null!==s&&(n.structuredQuery.limit=s),e.startAt&&(n.structuredQuery.startAt=pe(e.startAt)),e.endAt&&(n.structuredQuery.endAt=pe(e.endAt)),n}function pe(t){return{before:t.before,values:t.position}}function de(t){return new Nn(t.values||[],!!t.before)}function ye(t){return{fieldPath:t.$()}}function ve(t){return R.q(t.fieldPath)}function ge(t){return _n.create(ve(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return y()}}(t.fieldFilter.op),t.fieldFilter.value)}function be(t){switch(t.unaryFilter.op){case"IS_NAN":var e=ve(t.unaryFilter.field);return _n.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=ve(t.unaryFilter.field);return _n.create(n,"==",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return y()}}function me(t){var e=[];return t.fields.forEach((function(t){return e.push(t.$())})),{fieldPaths:e}}function we(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}var _e=function(){this.Qe=void 0};function Ie(t,e,n){return t instanceof Ae?function(t,e){var n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof Oe?Ne(t,e):t instanceof Se?xe(t,e):function(t,e){var n=Te(t,e),r=De(n)+De(t.qe);return Ft(n)&&Ft(t.qe)?Ht(r):Kt(t.serializer,r)}(t,e)}function Ee(t,e,n){return t instanceof Oe?Ne(t,e):t instanceof Se?xe(t,e):n}function Te(t,e){return t instanceof Pe?Ft(n=e)||function(t){return!!t&&"doubleValue"in t}(n)?e:{integerValue:0}:null;var n}var Ae=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i.__extends(e,t),e}(_e),Oe=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return i.__extends(e,t),e}(_e);function Ne(t,e){for(var n=ke(e),r=function(t){n.some((function(e){return Pt(e,t)}))||n.push(t)},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var Se=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return i.__extends(e,t),e}(_e);function xe(t,e){for(var n=ke(e),r=function(t){n=n.filter((function(e){return!Pt(e,t)}))},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var Pe=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).serializer=e,r.qe=n,r}return i.__extends(e,t),e}(_e);function De(t){return Rt(t.integerValue||t.doubleValue)}function ke(t){return Vt(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var je=function(){function t(t){this.fields=t,t.sort(R.P)}return t.prototype.je=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].D(t))return!0;return!1},t.prototype.isEqual=function(t){return _(this.fields,t.fields,(function(t,e){return t.isEqual(e)}))},t}(),Le=function(t,e){this.field=t,this.transform=e},Ce=function(t,e){this.version=t,this.transformResults=e},Re=function(){function t(t,e){this.updateTime=t,this.exists=e}return t.We=function(){return new t},t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,"Be",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},t}();function Ue(t,e){return void 0!==t.updateTime?e instanceof nn&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof nn}var Me=function(){};function Fe(t,e,n){return t instanceof Ge?function(t,e,n){return new nn(t.key,n.version,t.value,{hasCommittedMutations:!0})}(t,0,n):t instanceof We?function(t,e,n){if(!Ue(t.Ue,e))return new on(t.key,n.version);var r=Qe(t,e);return new nn(t.key,n.version,r,{hasCommittedMutations:!0})}(t,e,n):t instanceof He?function(t,e,n){if(v(null!=n.transformResults),!Ue(t.Ue,e))return new on(t.key,n.version);var r=Ke(0,e),i=function(t,e,n){var r=[];v(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,u=null;e instanceof nn&&(u=e.field(o.field)),r.push(Ee(s,u,n[i]))}return r}(t.fieldTransforms,e,n.transformResults),o=n.version,s=Xe(t,r.data(),i);return new nn(t.key,o,s,{hasCommittedMutations:!0})}(t,e,n):function(t,e,n){return new rn(t.key,n.version,{hasCommittedMutations:!0})}(t,0,n)}function Ve(t,e,n,r){return t instanceof Ge?function(t,e){if(!Ue(t.Ue,e))return e;var n=ze(e);return new nn(t.key,n,t.value,{Ke:!0})}(t,e):t instanceof We?function(t,e){if(!Ue(t.Ue,e))return e;var n=ze(e),r=Qe(t,e);return new nn(t.key,n,r,{Ke:!0})}(t,e):t instanceof He?function(t,e,n,r){if(!Ue(t.Ue,e))return e;var i=Ke(0,e),o=function(t,e,n,r){for(var i=[],o=0,s=t;o<s.length;o++){var u=s[o],a=u.transform,c=null;n instanceof nn&&(c=n.field(u.field)),null===c&&r instanceof nn&&(c=r.field(u.field)),i.push(Ie(a,c,e))}return i}(t.fieldTransforms,n,e,r),s=Xe(t,i.data(),o);return new nn(t.key,i.version,s,{Ke:!0})}(t,e,r,n):function(t,e){return Ue(t.Ue,e)?new rn(t.key,k.min()):e}(t,e)}function qe(t,e){return t instanceof He?function(t,e){for(var n=null,r=0,i=t.fieldTransforms;r<i.length;r++){var o=i[r],s=e instanceof nn?e.field(o.field):void 0,u=Te(o.transform,s||null);null!=u&&(n=null==n?(new Ze).set(o.field,u):n.set(o.field,u))}return n?n.Ge():null}(t,e):null}function Be(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.Ue.isEqual(e.Ue)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.Le.isEqual(e.Le):2!==t.type||_(t.fieldTransforms,t.fieldTransforms,(function(t,e){return function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof Oe&&e instanceof Oe||t instanceof Se&&e instanceof Se?_(t.elements,e.elements,Pt):t instanceof Pe&&e instanceof Pe?Pt(t.qe,e.qe):t instanceof Ae&&e instanceof Ae}(t.transform,e.transform)}(t,e)})))}function ze(t){return t instanceof nn?t.version:k.min()}var Ge=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).key=e,i.value=n,i.Ue=r,i.type=0,i}return i.__extends(e,t),e}(Me),We=function(t){function e(e,n,r,i){var o=this;return(o=t.call(this)||this).key=e,o.data=n,o.Le=r,o.Ue=i,o.type=1,o}return i.__extends(e,t),e}(Me);function Qe(t,e){return function(t,e){var n=new Ze(e);return t.Le.fields.forEach((function(e){if(!e._()){var r=t.data.field(e);null!==r?n.set(e,r):n.delete(e)}})),n.Ge()}(t,e instanceof nn?e.data():Je.empty())}var He=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.fieldTransforms=n,r.type=2,r.Ue=Re.exists(!0),r}return i.__extends(e,t),e}(Me);function Ke(t,e){return e}function Xe(t,e,n){for(var r=new Ze(e),i=0;i<t.fieldTransforms.length;i++)r.set(t.fieldTransforms[i].field,n[i]);return r.Ge()}var $e=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.Ue=n,r.type=3,r}return i.__extends(e,t),e}(Me),Ye=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.Ue=n,r.type=4,r}return i.__extends(e,t),e}(Me),Je=function(){function t(t){this.proto=t}return t.empty=function(){return new t({mapValue:{}})},t.prototype.field=function(t){if(t._())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!zt(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.S()])||null},t.prototype.isEqual=function(t){return Pt(this.proto,t.proto)},t}(),Ze=function(){function t(t){void 0===t&&(t=Je.empty()),this.ze=t,this.He=new Map}return t.prototype.set=function(t,e){return this.Ye(t,e),this},t.prototype.delete=function(t){return this.Ye(t,null),this},t.prototype.Ye=function(t,e){for(var n=this.He,r=0;r<t.length-1;++r){var i=t.get(r),o=n.get(i);o instanceof Map?n=o:o&&10===xt(o)?(o=new Map(Object.entries(o.mapValue.fields||{})),n.set(i,o),n=o):(o=new Map,n.set(i,o),n=o)}n.set(t.S(),e)},t.prototype.Ge=function(){var t=this.Je(R.k(),this.He);return null!=t?new Je(t):this.ze},t.prototype.Je=function(t,e){var n=this,r=!1,i=this.ze.field(t),o=zt(i)?Object.assign({},i.mapValue.fields):{};return e.forEach((function(e,i){if(e instanceof Map){var s=n.Je(t.child(i),e);null!=s&&(o[i]=s,r=!0)}else null!==e?(o[i]=e,r=!0):o.hasOwnProperty(i)&&(delete o[i],r=!0)})),r?{mapValue:{fields:o}}:null},t}();function tn(t){var e=[];return O(t.fields||{},(function(t,n){var r=new R([t]);if(zt(n)){var i=tn(n.mapValue).fields;if(0===i.length)e.push(r);else for(var o=0,s=i;o<s.length;o++)e.push(r.child(s[o]))}else e.push(r)})),new je(e)}var en=function(t,e){this.key=t,this.version=e},nn=function(t){function e(e,n,r,i){var o=this;return(o=t.call(this,e,n)||this).Xe=r,o.Ke=!!i.Ke,o.hasCommittedMutations=!!i.hasCommittedMutations,o}return i.__extends(e,t),e.prototype.field=function(t){return this.Xe.field(t)},e.prototype.data=function(){return this.Xe},e.prototype.Ze=function(){return this.Xe.proto},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Ke===t.Ke&&this.hasCommittedMutations===t.hasCommittedMutations&&this.Xe.isEqual(t.Xe)},e.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.Xe.toString()+", {hasLocalMutations: "+this.Ke+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.Ke||this.hasCommittedMutations},enumerable:!1,configurable:!0}),e}(en),rn=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n)||this).hasCommittedMutations=!(!r||!r.hasCommittedMutations),i}return i.__extends(e,t),e.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(en),on=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i.__extends(e,t),e.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(en);function sn(t,e){if(!(t instanceof e))throw new P(x.INVALID_ARGUMENT,e.name===t.constructor.name?"Type does not match the expected instance. Did you pass '"+e.name+"' from a different Firestore SDK?":"Expected type '"+e.name+"', but was '"+t.constructor.name+"'");return t}var un=function(){function t(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.tn=n,this.filters=r,this.limit=i,this.en=o,this.startAt=s,this.endAt=u,this.nn=null,this.sn=null}return t.prototype.rn=function(e){return new t(e,null,this.tn.slice(),this.filters.slice(),this.limit,this.en,this.startAt,this.endAt)},t.prototype.on=function(){return 0===this.filters.length&&null===this.limit&&null==this.startAt&&null==this.endAt&&(0===this.tn.length||1===this.tn.length&&this.tn[0].field.O())},t.prototype.hn=function(){return!M(this.limit)&&"F"===this.en},t.prototype.an=function(){return!M(this.limit)&&"L"===this.en},t.prototype.un=function(){return this.tn.length>0?this.tn[0].field:null},t.prototype.cn=function(){for(var t=0,e=this.filters;t<e.length;t++){var n=e[t];if(n.ln())return n.field}return null},t.prototype._n=function(t){for(var e=0,n=this.filters;e<n.length;e++){var r=n[e];if(t.indexOf(r.op)>=0)return r.op}return null},t}();function an(t,e,n,r,i,o,s,u){return new un(t,e,n,r,i,o,s,u)}function cn(t){return new un(t)}function hn(t){return null!==t.collectionGroup}function fn(t){var e=sn(t,un);if(null===e.nn){e.nn=[];var n=e.cn(),r=e.un();if(null!==n&&null===r)n.O()||e.nn.push(new Dn(n)),e.nn.push(new Dn(R.L(),"asc"));else{for(var i=!1,o=0,s=e.tn;o<s.length;o++){var u=s[o];e.nn.push(u),u.field.O()&&(i=!0)}if(!i){var a=e.tn.length>0?e.tn[e.tn.length-1].dir:"asc";e.nn.push(new Dn(R.L(),a))}}}return e.nn}function ln(t){var e=sn(t,un);if(!e.sn)if("F"===e.en)e.sn=B(e.path,e.collectionGroup,fn(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=fn(e);r<i.length;r++){var o=i[r];n.push(new Dn(o.field,"desc"===o.dir?"asc":"desc"))}var s=e.endAt?new Nn(e.endAt.position,!e.endAt.before):null,u=e.startAt?new Nn(e.startAt.position,!e.startAt.before):null;e.sn=B(e.path,e.collectionGroup,n,e.filters,e.limit,s,u)}return e.sn}function pn(t,e,n){return new un(t.path,t.collectionGroup,t.tn.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function dn(t,e){return new un(t.path,t.collectionGroup,t.tn.slice(),t.filters.slice(),t.limit,t.en,e,t.endAt)}function yn(t,e){return new un(t.path,t.collectionGroup,t.tn.slice(),t.filters.slice(),t.limit,t.en,t.startAt,e)}function vn(t,e){return G(ln(t),ln(e))&&t.en===e.en}function gn(t){return z(ln(t))+"|lt:"+t.en}function bn(t){return"Query(target="+function(t){var e=t.path.$();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=", filters: ["+t.filters.map((function(t){return(e=t).field.$()+" "+e.op+" "+Lt(e.value);var e})).join(", ")+"]"),M(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=", orderBy: ["+t.orderBy.map((function(t){return(e=t).field.$()+" ("+e.dir+")";var e})).join(", ")+"]"),t.startAt&&(e+=", startAt: "+Sn(t.startAt)),t.endAt&&(e+=", endAt: "+Sn(t.endAt)),"Target("+e+")"}(ln(t))+"; limitType="+t.en+")"}function mn(t,e){return function(t,e){var n=e.key.path;return null!==t.collectionGroup?e.key.U(t.collectionGroup)&&t.path.D(n):U.W(t.path)?t.path.isEqual(n):t.path.C(n)}(t,e)&&function(t,e){for(var n=0,r=t.tn;n<r.length;n++){var i=r[n];if(!i.field.O()&&null===e.field(i.field))return!1}return!0}(t,e)&&function(t,e){for(var n=0,r=t.filters;n<r.length;n++)if(!r[n].matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!xn(t.startAt,fn(t),e)||t.endAt&&xn(t.endAt,fn(t),e))}(t,e)}function wn(t){return function(e,n){for(var r=!1,i=0,o=fn(t);i<o.length;i++){var s=o[i],u=kn(s,e,n);if(0!==u)return u;r=r||s.field.O()}return 0}}var _n=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).field=e,i.op=n,i.value=r,i}return i.__extends(e,t),e.create=function(t,n,r){if(t.O())return"in"===n?new En(t,r):new In(t,n,r);if(qt(r)){if("=="!==n)throw new P(x.INVALID_ARGUMENT,"Invalid query. Null supports only equality comparisons.");return new e(t,n,r)}if(Bt(r)){if("=="!==n)throw new P(x.INVALID_ARGUMENT,"Invalid query. NaN supports only equality comparisons.");return new e(t,n,r)}return"array-contains"===n?new Tn(t,r):"in"===n?new An(t,r):"array-contains-any"===n?new On(t,r):new e(t,n,r)},e.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&xt(this.value)===xt(e)&&this.fn(kt(e,this.value))},e.prototype.fn=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case">":return t>0;case">=":return t>=0;default:return y()}},e.prototype.ln=function(){return["<","<=",">",">="].indexOf(this.op)>=0},e}((function(){})),In=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,r)||this).key=U.B(r.referenceValue),i}return i.__extends(e,t),e.prototype.matches=function(t){var e=U.P(t.key,this.key);return this.fn(e)},e}(_n),En=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"in",n)||this).keys=(n.arrayValue.values||[]).map((function(t){return U.B(t.referenceValue)})),r}return i.__extends(e,t),e.prototype.matches=function(t){return this.keys.some((function(e){return e.isEqual(t.key)}))},e}(_n),Tn=function(t){function e(e,n){return t.call(this,e,"array-contains",n)||this}return i.__extends(e,t),e.prototype.matches=function(t){var e=t.field(this.field);return Vt(e)&&Dt(e.arrayValue,this.value)},e}(_n),An=function(t){function e(e,n){return t.call(this,e,"in",n)||this}return i.__extends(e,t),e.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&Dt(this.value.arrayValue,e)},e}(_n),On=function(t){function e(e,n){return t.call(this,e,"array-contains-any",n)||this}return i.__extends(e,t),e.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!Vt(n)||!n.arrayValue.values)&&n.arrayValue.values.some((function(t){return Dt(e.value.arrayValue,t)}))},e}(_n),Nn=function(t,e){this.position=t,this.before=e};function Sn(t){return(t.before?"b":"a")+":"+t.position.map((function(t){return Lt(t)})).join(",")}function xn(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i];if(r=o.field.O()?U.P(U.B(s.referenceValue),n.key):kt(s,n.field(o.field)),"desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function Pn(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!Pt(t.position[n],e.position[n]))return!1;return!0}var Dn=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function kn(t,e,n){var r=t.field.O()?U.P(e.key,n.key):function(t,e,n){var r=e.field(t),i=n.field(t);return null!==r&&null!==i?kt(r,i):y()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return y()}}function jn(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}var Ln=function(){function t(t,e,n,r){this.batchId=t,this.dn=e,this.baseMutations=n,this.mutations=r}return t.prototype.wn=function(t,e,n){for(var r=n.Tn,i=0;i<this.mutations.length;i++){var o=this.mutations[i];o.key.isEqual(t)&&(e=Fe(o,e,r[i]))}return e},t.prototype.En=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=Ve(i,e,e,this.dn))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=Ve(a,e,o,this.dn))}return e},t.prototype.In=function(t){var e=this,n=t;return this.mutations.forEach((function(r){var i=e.En(r.key,t.get(r.key));i&&(n=n.nt(r.key,i))})),n},t.prototype.keys=function(){return this.mutations.reduce((function(t,e){return t.add(e.key)}),ft())},t.prototype.isEqual=function(t){return this.batchId===t.batchId&&_(this.mutations,t.mutations,(function(t,e){return Be(t,e)}))&&_(this.baseMutations,t.baseMutations,(function(t,e){return Be(t,e)}))},t}(),Cn=function(){function t(t,e,n,r){this.batch=t,this.mn=e,this.Tn=n,this.An=r}return t.from=function(e,n,r){v(e.mutations.length===r.length);for(var i=ct,o=e.mutations,s=0;s<o.length;s++)i=i.nt(o[s].key,r[s].version);return new t(e,n,r,i)},t}(),Rn=function(){function t(t){var e=this;this.Rn=null,this.Pn=null,this.result=void 0,this.error=void 0,this.gn=!1,this.Vn=!1,t((function(t){e.gn=!0,e.result=t,e.Rn&&e.Rn(t)}),(function(t){e.gn=!0,e.error=t,e.Pn&&e.Pn(t)}))}return t.prototype.catch=function(t){return this.next(void 0,t)},t.prototype.next=function(e,n){var r=this;return this.Vn&&y(),this.Vn=!0,this.gn?this.error?this.yn(n,this.error):this.pn(e,this.result):new t((function(t,i){r.Rn=function(n){r.pn(e,n).next(t,i)},r.Pn=function(e){r.yn(n,e).next(t,i)}}))},t.prototype.bn=function(){var t=this;return new Promise((function(e,n){t.next(e,n)}))},t.prototype.vn=function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(e){return t.reject(e)}},t.prototype.pn=function(e,n){return e?this.vn((function(){return e(n)})):t.resolve(n)},t.prototype.yn=function(e,n){return e?this.vn((function(){return e(n)})):t.reject(n)},t.resolve=function(e){return new t((function(t,n){t(e)}))},t.reject=function(e){return new t((function(t,n){n(e)}))},t.Sn=function(e){return new t((function(t,n){var r=0,i=0,o=!1;e.forEach((function(e){++r,e.next((function(){++i,o&&i===r&&t()}),(function(t){return n(t)}))})),o=!0,i===r&&t()}))},t.Dn=function(e){for(var n=t.resolve(!1),r=function(e){n=n.next((function(n){return n?t.resolve(n):e()}))},i=0,o=e;i<o.length;i++)r(o[i]);return n},t.forEach=function(t,e){var n=this,r=[];return t.forEach((function(t,i){r.push(e.call(n,t,i))})),this.Sn(r)},t}(),Un=function(){function t(){this.Cn=new S((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),this.Fn=!1}return Object.defineProperty(t.prototype,"readTime",{get:function(){return this.$n},set:function(t){this.$n=t},enumerable:!1,configurable:!0}),t.prototype.Nn=function(t,e){this.kn(),this.readTime=e,this.Cn.set(t.key,t)},t.prototype.xn=function(t,e){this.kn(),e&&(this.readTime=e),this.Cn.set(t,null)},t.prototype.Mn=function(t,e){this.kn();var n=this.Cn.get(e);return void 0!==n?Rn.resolve(n):this.On(t,e)},t.prototype.getEntries=function(t,e){return this.Ln(t,e)},t.prototype.apply=function(t){return this.kn(),this.Fn=!0,this.qn(t)},t.prototype.kn=function(){},t}(),Mn="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Fn=function(){function t(){this.Bn=[]}return t.prototype.Un=function(t){this.Bn.push(t)},t.prototype.Wn=function(){this.Bn.forEach((function(t){return t()}))},t}(),Vn=function(){function t(t,e,n){this.Qn=t,this.jn=e,this.Kn=n}return t.prototype.Gn=function(t,e){var n=this;return this.jn.zn(t,e).next((function(r){return n.Hn(t,e,r)}))},t.prototype.Hn=function(t,e,n){return this.Qn.Mn(t,e).next((function(t){for(var r=0,i=n;r<i.length;r++)t=i[r].En(e,t);return t}))},t.prototype.Yn=function(t,e,n){var r=st();return e.forEach((function(t,e){for(var i=0,o=n;i<o.length;i++)e=o[i].En(t,e);r=r.nt(t,e)})),r},t.prototype.Jn=function(t,e){var n=this;return this.Qn.getEntries(t,e).next((function(e){return n.Xn(t,e)}))},t.prototype.Xn=function(t,e){var n=this;return this.jn.Zn(t,e).next((function(r){var i=n.Yn(t,e,r),o=ot();return i.forEach((function(t,e){e||(e=new rn(t,k.min())),o=o.nt(t,e)})),o}))},t.prototype.ts=function(t,e,n){return function(t){return U.W(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.es(t,e.path):hn(e)?this.ns(t,e,n):this.ss(t,e,n)},t.prototype.es=function(t,e){return this.Gn(t,new U(e)).next((function(t){var e=at();return t instanceof nn&&(e=e.nt(t.key,t)),e}))},t.prototype.ns=function(t,e,n){var r=this,i=e.collectionGroup,o=at();return this.Kn.rs(t,i).next((function(s){return Rn.forEach(s,(function(s){var u=e.rn(s.child(i));return r.ss(t,u,n).next((function(t){t.forEach((function(t,e){o=o.nt(t,e)}))}))})).next((function(){return o}))}))},t.prototype.ss=function(t,e,n){var r,i,o=this;return this.Qn.ts(t,e,n).next((function(n){return r=n,o.jn.os(t,e)})).next((function(e){return o.hs(t,i=e,r).next((function(t){r=t;for(var e=0,n=i;e<n.length;e++)for(var o=n[e],s=0,u=o.mutations;s<u.length;s++){var a=u[s],c=a.key,h=r.get(c),f=Ve(a,h,h,o.dn);r=f instanceof nn?r.nt(c,f):r.remove(c)}}))})).next((function(){return r.forEach((function(t,n){mn(e,n)||(r=r.remove(t))})),r}))},t.prototype.hs=function(t,e,n){for(var r=ft(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof We&&null===n.get(a.key)&&(r=r.add(a.key))}var c=n;return this.Qn.getEntries(t,r).next((function(t){return t.forEach((function(t,e){null!==e&&e instanceof nn&&(c=c.nt(t,e))})),c}))},t}(),qn=function(){function t(t,e,n,r){this.targetId=t,this.fromCache=e,this.as=n,this.us=r}return t.cs=function(e,n){for(var r=ft(),i=ft(),o=0,s=n.docChanges;o<s.length;o++){var u=s[o];switch(u.type){case 0:r=r.add(u.doc.key);break;case 1:i=i.add(u.doc.key)}}return new t(e,n.fromCache,r,i)},t}(),Bn=function(){function t(t,e){var n=this;this.previousValue=t,e&&(e.ls=function(t){return n._s(t)},this.fs=function(t){return e.ds(t)})}return t.prototype._s=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},t.prototype.next=function(){var t=++this.previousValue;return this.fs&&this.fs(t),t},t}();Bn.ws=-1;var zn=function(){var t=this;this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))},Gn=function(){function t(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Ts=t,this.Es=e,this.Is=n,this.ms=r,this.As=i,this.Rs=0,this.Ps=null,this.gs=Date.now(),this.reset()}return t.prototype.reset=function(){this.Rs=0},t.prototype.Vs=function(){this.Rs=this.As},t.prototype.ys=function(t){var e=this;this.cancel();var n=Math.floor(this.Rs+this.ps()),r=Math.max(0,Date.now()-this.gs),i=Math.max(0,n-r);i>0&&l("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.Rs+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Ps=this.Ts.bs(this.Es,i,(function(){return e.gs=Date.now(),t()})),this.Rs*=this.ms,this.Rs<this.Is&&(this.Rs=this.Is),this.Rs>this.As&&(this.Rs=this.As)},t.prototype.vs=function(){null!==this.Ps&&(this.Ps.Ss(),this.Ps=null)},t.prototype.cancel=function(){null!==this.Ps&&(this.Ps.cancel(),this.Ps=null)},t.prototype.ps=function(){return(Math.random()-.5)*this.Rs},t}();function Wn(t){for(var e="",n=0;n<t.length;n++)e.length>0&&(e=Hn(e)),e=Qn(t.get(n),e);return Hn(e)}function Qn(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="\x01\x10";break;case"\x01":n+="\x01\x11";break;default:n+=o}}return n}function Hn(t){return t+"\x01\x01"}function Kn(t){var e=t.length;if(v(e>=2),2===e)return v("\x01"===t.charAt(0)&&"\x01"===t.charAt(1)),L.k();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("\x01",o);switch((s<0||s>n)&&y(),t.charAt(s+1)){case"\x01":var u=t.substring(o,s),a=void 0;0===i.length?a=u:(a=i+=u,i=""),r.push(a);break;case"\x10":i+=t.substring(o,s),i+="\0";break;case"\x11":i+=t.substring(o,s+1);break;default:y()}o=s+2}return new L(r)}var Xn=function(){function t(){this.Ds=new $n}return t.prototype.Cs=function(t,e){return this.Ds.add(e),Rn.resolve()},t.prototype.rs=function(t,e){return Rn.resolve(this.Ds.getEntries(e))},t}(),$n=function(){function t(){this.index={}}return t.prototype.add=function(t){var e=t.S(),n=t.p(),r=this.index[e]||new nt(L.P),i=!r.has(n);return this.index[e]=r.add(n),i},t.prototype.has=function(t){var e=t.S(),n=t.p(),r=this.index[e];return r&&r.has(n)},t.prototype.getEntries=function(t){return(this.index[t]||new nt(L.P)).F()},t}(),Yn=function(){function t(){this.Fs=new $n}return t.prototype.Cs=function(t,e){var n=this;if(!this.Fs.has(e)){var r=e.S(),i=e.p();t.Un((function(){n.Fs.add(e)}));var o={collectionId:r,parent:Wn(i)};return Jn(t).put(o)}return Rn.resolve()},t.prototype.rs=function(t,e){var n=[],r=IDBKeyRange.bound([e,""],[I(e),""],!1,!0);return Jn(t).$s(r).next((function(t){for(var r=0,i=t;r<i.length;r++){var o=i[r];if(o.collectionId!==e)break;n.push(Kn(o.parent))}return n}))},t}();function Jn(t){return _r.Ns(t,Hr.store)}var Zn=function(t){this.ks=t};function tr(t,e){if(e.document)return function(t,e,n){var r=re(t,e.name),i=Zt(e.updateTime),o=new Je({mapValue:{fields:e.fields}});return new nn(r,i,o,{hasCommittedMutations:!!n})}(t.ks,e.document,!!e.hasCommittedMutations);if(e.noDocument){var n=U.j(e.noDocument.path),r=or(e.noDocument.readTime);return new rn(n,r,{hasCommittedMutations:!!e.hasCommittedMutations})}if(e.unknownDocument){var i=U.j(e.unknownDocument.path),o=or(e.unknownDocument.version);return new on(i,o)}return y()}function er(t,e,n){var r=nr(n),i=e.key.path.p().F();if(e instanceof nn){var o=function(t,e){return{name:ne(t,e.key),fields:e.Ze().mapValue.fields,updateTime:$t(t,e.version.A())}}(t.ks,e);return new Br(null,null,o,e.hasCommittedMutations,r,i)}if(e instanceof rn){var s=e.key.path.F(),u=ir(e.version),a=e.hasCommittedMutations;return new Br(null,new Vr(s,u),null,a,r,i)}if(e instanceof on){var c=e.key.path.F(),h=ir(e.version);return new Br(new qr(c,h),null,null,!0,r,i)}return y()}function nr(t){var e=t.A();return[e.seconds,e.nanoseconds]}function rr(t){var e=new D(t[0],t[1]);return k.I(e)}function ir(t){var e=t.A();return new Cr(e.seconds,e.nanoseconds)}function or(t){var e=new D(t.seconds,t.nanoseconds);return k.I(e)}function sr(t,e){var n=(e.baseMutations||[]).map((function(e){return he(t.ks,e)})),r=e.mutations.map((function(e){return he(t.ks,e)})),i=D.fromMillis(e.localWriteTimeMs);return new Ln(e.batchId,i,n,r)}function ur(t){var e,n,r=or(t.readTime),i=void 0!==t.lastLimboFreeSnapshotVersion?or(t.lastLimboFreeSnapshotVersion):k.min();return void 0!==t.query.documents?(v(1===(n=t.query).documents.length),e=ln(cn(oe(n.documents[0])))):e=function(t){var e=oe(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){v(1===r);var o=n.from[0];o.allDescendants?i=o.collectionId:e=e.child(o.collectionId)}var s=[];n.where&&(s=function t(e){return e?void 0!==e.unaryFilter?[be(e)]:void 0!==e.fieldFilter?[ge(e)]:void 0!==e.compositeFilter?e.compositeFilter.filters.map((function(e){return t(e)})).reduce((function(t,e){return t.concat(e)})):y():[]}(n.where));var u=[];n.orderBy&&(u=n.orderBy.map((function(t){return new Dn(ve((e=t).field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction));var e})));var a=null;n.limit&&(a=function(t){var e;return M(e="object"==typeof t?t.value:t)?null:e}(n.limit));var c=null;n.startAt&&(c=de(n.startAt));var h=null;return n.endAt&&(h=de(n.endAt)),ln(an(e,i,u,s,a,"F",c,h))}(t.query),new X(e,t.targetId,0,t.lastListenSequenceNumber,r,i,Q.fromBase64String(t.resumeToken))}function ar(t,e){var n,r=ir(e.X),i=ir(e.lastLimboFreeSnapshotVersion);n=W(e.target)?fe(t.ks,e.target):le(t.ks,e.target);var o=e.resumeToken.toBase64();return new Gr(e.targetId,z(e.target),r,o,e.sequenceNumber,i,n)}var cr=function(){function t(t,e){this.serializer=t,this.Kn=e}return t.prototype.Nn=function(t,e,n){return fr(t).put(lr(e),n)},t.prototype.xn=function(t,e){var n=fr(t),r=lr(e);return n.delete(r)},t.prototype.updateMetadata=function(t,e){var n=this;return this.getMetadata(t).next((function(r){return r.byteSize+=e,n.xs(t,r)}))},t.prototype.Mn=function(t,e){var n=this;return fr(t).get(lr(e)).next((function(t){return n.Ms(t)}))},t.prototype.Os=function(t,e){var n=this;return fr(t).get(lr(e)).next((function(t){var e=n.Ms(t);return e?{Ls:e,size:pr(t)}:null}))},t.prototype.getEntries=function(t,e){var n=this,r=st();return this.qs(t,e,(function(t,e){var i=n.Ms(e);r=r.nt(t,i)})).next((function(){return r}))},t.prototype.Bs=function(t,e){var n=this,r=st(),i=new Z(U.P);return this.qs(t,e,(function(t,e){var o=n.Ms(e);o?(r=r.nt(t,o),i=i.nt(t,pr(e))):(r=r.nt(t,null),i=i.nt(t,0))})).next((function(){return{Us:r,Ws:i}}))},t.prototype.qs=function(t,e,n){if(e._())return Rn.resolve();var r=IDBKeyRange.bound(e.first().path.F(),e.last().path.F()),i=e.at(),o=i.dt();return fr(t).Qs({range:r},(function(t,e,r){for(var s=U.j(t);o&&U.P(o,s)<0;)n(o,null),o=i.dt();o&&o.isEqual(s)&&(n(o,e),o=i.wt()?i.dt():null),o?r.js(o.path.F()):r.done()})).next((function(){for(;o;)n(o,null),o=i.wt()?i.dt():null}))},t.prototype.ts=function(t,e,n){var r=this,i=at(),o=e.path.length+1,s={};if(n.isEqual(k.min())){var u=e.path.F();s.range=IDBKeyRange.lowerBound(u)}else{var a=e.path.F(),c=nr(n);s.range=IDBKeyRange.lowerBound([a,c],!0),s.index=Br.collectionReadTimeIndex}return fr(t).Qs(s,(function(t,n,s){if(t.length===o){var u=tr(r.serializer,n);e.path.D(u.key.path)?u instanceof nn&&mn(e,u)&&(i=i.nt(u.key,u)):s.done()}})).next((function(){return i}))},t.prototype.Ks=function(t,e){var n=this,r=ot(),i=nr(e),o=fr(t),s=IDBKeyRange.lowerBound(i,!0);return o.Qs({index:Br.readTimeIndex,range:s},(function(t,e){var o=tr(n.serializer,e);r=r.nt(o.key,o),i=e.readTime})).next((function(){return{Gs:r,readTime:rr(i)}}))},t.prototype.zs=function(t){var e=fr(t),n=k.min();return e.Qs({index:Br.readTimeIndex,reverse:!0},(function(t,e,r){e.readTime&&(n=rr(e.readTime)),r.done()})).next((function(){return n}))},t.prototype.Hs=function(e){return new t.Ys(this,!!e&&e.Js)},t.prototype.Xs=function(t){return this.getMetadata(t).next((function(t){return t.byteSize}))},t.prototype.getMetadata=function(t){return hr(t).get(zr.key).next((function(t){return v(!!t),t}))},t.prototype.xs=function(t,e){return hr(t).put(zr.key,e)},t.prototype.Ms=function(t){if(t){var e=tr(this.serializer,t);return e instanceof rn&&e.version.isEqual(k.min())?null:e}return null},t}();function hr(t){return _r.Ns(t,zr.store)}function fr(t){return _r.Ns(t,Br.store)}function lr(t){return t.path.F()}function pr(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw y();e=t.noDocument}return JSON.stringify(e).length}cr.Ys=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Zs=e,r.Js=n,r.ti=new S((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),r}return i.__extends(e,t),e.prototype.qn=function(t){var e=this,n=[],r=0,i=new nt((function(t,e){return w(t.$(),e.$())}));return this.Cn.forEach((function(o,s){var u=e.ti.get(o);if(s){var a=er(e.Zs.serializer,s,e.readTime);i=i.add(o.path.p());var c=pr(a);r+=c-u,n.push(e.Zs.Nn(t,o,a))}else if(r-=u,e.Js){var h=er(e.Zs.serializer,new rn(o,k.min()),e.readTime);n.push(e.Zs.Nn(t,o,h))}else n.push(e.Zs.xn(t,o))})),i.forEach((function(r){n.push(e.Zs.Kn.Cs(t,r))})),n.push(this.Zs.updateMetadata(t,r)),Rn.Sn(n)},e.prototype.On=function(t,e){var n=this;return this.Zs.Os(t,e).next((function(t){return null===t?(n.ti.set(e,0),null):(n.ti.set(e,t.size),t.Ls)}))},e.prototype.Ln=function(t,e){var n=this;return this.Zs.Bs(t,e).next((function(t){var e=t.Us;return t.Ws.forEach((function(t,e){n.ti.set(t,e)})),e}))},e}(Un);var dr=function(){function t(t){this.ei=t}return t.prototype.next=function(){return this.ei+=2,this.ei},t.ni=function(){return new t(0)},t.si=function(){return new t(-1)},t}(),yr=function(){function t(t,e){this.ii=t,this.serializer=e}return t.prototype.ri=function(t){var e=this;return this.oi(t).next((function(n){var r=new dr(n.highestTargetId);return n.highestTargetId=r.next(),e.hi(t,n).next((function(){return n.highestTargetId}))}))},t.prototype.ai=function(t){return this.oi(t).next((function(t){return k.I(new D(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))}))},t.prototype.ui=function(t){return this.oi(t).next((function(t){return t.highestListenSequenceNumber}))},t.prototype.ci=function(t,e,n){var r=this;return this.oi(t).next((function(i){return i.highestListenSequenceNumber=e,n&&(i.lastRemoteSnapshotVersion=n.A()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),r.hi(t,i)}))},t.prototype.li=function(t,e){var n=this;return this._i(t,e).next((function(){return n.oi(t).next((function(r){return r.targetCount+=1,n.fi(e,r),n.hi(t,r)}))}))},t.prototype.di=function(t,e){return this._i(t,e)},t.prototype.wi=function(t,e){var n=this;return this.Ti(t,e.targetId).next((function(){return vr(t).delete(e.targetId)})).next((function(){return n.oi(t)})).next((function(e){return v(e.targetCount>0),e.targetCount-=1,n.hi(t,e)}))},t.prototype.Ei=function(t,e,n){var r=this,i=0,o=[];return vr(t).Qs((function(s,u){var a=ur(u);a.sequenceNumber<=e&&null===n.get(a.targetId)&&(i++,o.push(r.wi(t,a)))})).next((function(){return Rn.Sn(o)})).next((function(){return i}))},t.prototype.pe=function(t,e){return vr(t).Qs((function(t,n){var r=ur(n);e(r)}))},t.prototype.oi=function(t){return gr(t).get(Qr.key).next((function(t){return v(null!==t),t}))},t.prototype.hi=function(t,e){return gr(t).put(Qr.key,e)},t.prototype._i=function(t,e){return vr(t).put(ar(this.serializer,e))},t.prototype.fi=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},t.prototype.Ii=function(t){return this.oi(t).next((function(t){return t.targetCount}))},t.prototype.mi=function(t,e){var n=z(e),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),i=null;return vr(t).Qs({range:r,index:Gr.queryTargetsIndexName},(function(t,n,r){var o=ur(n);G(e,o.target)&&(i=o,r.done())})).next((function(){return i}))},t.prototype.Ai=function(t,e,n){var r=this,i=[],o=br(t);return e.forEach((function(e){var s=Wn(e.path);i.push(o.put(new Wr(n,s))),i.push(r.ii.Ri(t,n,e))})),Rn.Sn(i)},t.prototype.Pi=function(t,e,n){var r=this,i=br(t);return Rn.forEach(e,(function(e){var o=Wn(e.path);return Rn.Sn([i.delete([n,o]),r.ii.gi(t,n,e)])}))},t.prototype.Ti=function(t,e){var n=br(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},t.prototype.Vi=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=br(t),i=ft();return r.Qs({range:n,yi:!0},(function(t,e,n){var r=Kn(t[1]),o=new U(r);i=i.add(o)})).next((function(){return i}))},t.prototype.pi=function(t,e){var n=Wn(e.path),r=IDBKeyRange.bound([n],[I(n)],!1,!0),i=0;return br(t).Qs({index:Wr.documentTargetsIndex,yi:!0,range:r},(function(t,e,n){0!==t[0]&&(i++,n.done())})).next((function(){return i>0}))},t.prototype.Me=function(t,e){return vr(t).get(e).next((function(t){return t?ur(t):null}))},t}();function vr(t){return _r.Ns(t,Gr.store)}function gr(t){return _r.Ns(t,Qr.store)}function br(t){return _r.Ns(t,Wr.store)}var mr="Failed to obtain exclusive access to the persistence layer. To allow shared access, make sure to invoke `enablePersistence()` with `synchronizeTabs:true` in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",wr=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).bi=e,r.vi=n,r}return i.__extends(e,t),e}(Fn),_r=function(){function t(e,n,r,i,o,s,u,a,c,h){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.Ts=o,this.window=s,this.document=u,this.Si=c,this.Di=h,this.Ci=null,this.Fi=!1,this.isPrimary=!1,this.networkEnabled=!0,this.$i=null,this.inForeground=!1,this.Ni=null,this.ki=null,this.xi=Number.NEGATIVE_INFINITY,this.Mi=function(t){return Promise.resolve()},!t.Oi())throw new P(x.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.ii=new Tr(this,i),this.Li=n+"main",this.serializer=new Zn(a),this.qi=new yr(this.ii,this.serializer),this.Kn=new Yn,this.Qn=new cr(this.serializer,this.Kn),this.window&&this.window.localStorage?this.Bi=this.window.localStorage:(this.Bi=null,!1===h&&p("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}return t.Ns=function(t,e){if(t instanceof wr)return Yr.Ns(t.bi,e);throw y()},t.prototype.start=function(){var t=this;return Yr.Ui(this.Li,jr,new Lr(this.serializer)).then((function(e){return t.Wi=e,t.Qi()})).then((function(){if(!t.isPrimary&&!t.allowTabSynchronization)throw new P(x.FAILED_PRECONDITION,mr);return t.ji(),t.Ki(),t.Gi(),t.runTransaction("getHighestListenSequenceNumber","readonly",(function(e){return t.qi.ui(e)}))})).then((function(e){t.Ci=new Bn(e,t.Si)})).then((function(){t.Fi=!0})).catch((function(e){return t.Wi&&t.Wi.close(),Promise.reject(e)}))},t.prototype.zi=function(t){var e=this;return this.Mi=function(n){return i.__awaiter(e,void 0,void 0,(function(){return i.__generator(this,(function(e){return this.Hi?[2,t(n)]:[2]}))}))},t(this.isPrimary)},t.prototype.Yi=function(t){var e=this;this.Wi.Ji((function(n){return i.__awaiter(e,void 0,void 0,(function(){return i.__generator(this,(function(e){switch(e.label){case 0:return null===n.newVersion?[4,t()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))}))},t.prototype.Xi=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.Ts.Zi((function(){return i.__awaiter(e,void 0,void 0,(function(){return i.__generator(this,(function(t){switch(t.label){case 0:return this.Hi?[4,this.Qi()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))})))},t.prototype.Qi=function(){var t=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(function(e){return Er(e).put(new Xr(t.clientId,Date.now(),t.networkEnabled,t.inForeground)).next((function(){if(t.isPrimary)return t.tr(e).next((function(e){e||(t.isPrimary=!1,t.Ts.er((function(){return t.Mi(!1)})))}))})).next((function(){return t.nr(e)})).next((function(n){return t.isPrimary&&!n?t.sr(e).next((function(){return!1})):!!n&&t.ir(e).next((function(){return!0}))}))})).catch((function(e){if(ti(e))return l("IndexedDbPersistence","Failed to extend owner lease: ",e),t.isPrimary;if(!t.allowTabSynchronization)throw e;return l("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1})).then((function(e){t.isPrimary!==e&&t.Ts.er((function(){return t.Mi(e)})),t.isPrimary=e}))},t.prototype.tr=function(t){var e=this;return Ir(t).get(Rr.key).next((function(t){return Rn.resolve(e.rr(t))}))},t.prototype.or=function(t){return Er(t).delete(this.clientId)},t.prototype.hr=function(){return i.__awaiter(this,void 0,void 0,(function(){var e,n,r,o=this;return i.__generator(this,(function(i){switch(i.label){case 0:return!this.isPrimary||this.ar(this.xi,18e5)?[3,2]:(this.xi=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(function(e){var n=t.Ns(e,Xr.store);return n.$s().next((function(t){var e=o.ur(t,18e5),r=t.filter((function(t){return-1===e.indexOf(t)}));return Rn.forEach(r,(function(t){return n.delete(t.clientId)})).next((function(){return r}))}))})).catch((function(){return[]}))]);case 1:if(e=i.sent(),this.Bi)for(n=0,r=e;n<r.length;n++)this.Bi.removeItem(this.cr(r[n].clientId));i.label=2;case 2:return[2]}}))}))},t.prototype.Gi=function(){var t=this;this.ki=this.Ts.bs("client_metadata_refresh",4e3,(function(){return t.Qi().then((function(){return t.hr()})).then((function(){return t.Gi()}))}))},t.prototype.rr=function(t){return!!t&&t.ownerId===this.clientId},t.prototype.nr=function(t){var e=this;return this.Di?Rn.resolve(!0):Ir(t).get(Rr.key).next((function(n){if(null!==n&&e.ar(n.leaseTimestampMs,5e3)&&!e.lr(n.ownerId)){if(e.rr(n)&&e.networkEnabled)return!0;if(!e.rr(n)){if(!n.allowTabSynchronization)throw new P(x.FAILED_PRECONDITION,mr);return!1}}return!(!e.networkEnabled||!e.inForeground)||Er(t).$s().next((function(t){return void 0===e.ur(t,5e3).find((function(t){return!(e.clientId===t.clientId||!(!e.networkEnabled&&t.networkEnabled||!e.inForeground&&t.inForeground&&e.networkEnabled===t.networkEnabled))}))}))})).next((function(t){return e.isPrimary!==t&&l("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t}))},t.prototype._r=function(){return i.__awaiter(this,void 0,void 0,(function(){var t=this;return i.__generator(this,(function(e){switch(e.label){case 0:return this.Fi=!1,this.dr(),this.ki&&(this.ki.cancel(),this.ki=null),this.wr(),this.Tr(),[4,this.runTransaction("shutdown","readwrite",(function(e){return t.sr(e).next((function(){return t.or(e)}))})).catch((function(t){l("IndexedDbPersistence","Proceeding with shutdown despite failure: ",t)}))];case 1:return e.sent(),this.Wi.close(),this.Er(),[2]}}))}))},t.prototype.ur=function(t,e){var n=this;return t.filter((function(t){return n.ar(t.updateTimeMs,e)&&!n.lr(t.clientId)}))},t.prototype.Ir=function(){var t=this;return this.runTransaction("getActiveClients","readonly",(function(e){return Er(e).$s().next((function(e){return t.ur(e,18e5).map((function(t){return t.clientId}))}))}))},Object.defineProperty(t.prototype,"Hi",{get:function(){return this.Fi},enumerable:!1,configurable:!0}),t.prototype.mr=function(t){return Nr.Ar(t,this.serializer,this.Kn,this.ii)},t.prototype.Rr=function(){return this.qi},t.prototype.Pr=function(){return this.Qn},t.prototype.gr=function(){return this.Kn},t.prototype.runTransaction=function(t,e,n){var r,i=this;return l("IndexedDbPersistence","Starting transaction:",t),this.Wi.runTransaction("readonly"===e?"readonly":"readwrite",$r,(function(o){return r=new wr(o,i.Ci?i.Ci.next():Bn.ws),"readwrite-primary"===e?i.tr(r).next((function(t){return!!t||i.nr(r)})).next((function(e){if(!e)throw p("Failed to obtain primary lease for action '"+t+"'."),i.isPrimary=!1,i.Ts.er((function(){return i.Mi(!1)})),new P(x.FAILED_PRECONDITION,Mn);return n(r)})).next((function(t){return i.ir(r).next((function(){return t}))})):i.Vr(r).next((function(){return n(r)}))})).then((function(t){return r.Wn(),t}))},t.prototype.Vr=function(t){var e=this;return Ir(t).get(Rr.key).next((function(t){if(null!==t&&e.ar(t.leaseTimestampMs,5e3)&&!e.lr(t.ownerId)&&!e.rr(t)&&!(e.Di||e.allowTabSynchronization&&t.allowTabSynchronization))throw new P(x.FAILED_PRECONDITION,mr)}))},t.prototype.ir=function(t){var e=new Rr(this.clientId,this.allowTabSynchronization,Date.now());return Ir(t).put(Rr.key,e)},t.Oi=function(){return Yr.Oi()},t.prototype.sr=function(t){var e=this,n=Ir(t);return n.get(Rr.key).next((function(t){return e.rr(t)?(l("IndexedDbPersistence","Releasing primary lease."),n.delete(Rr.key)):Rn.resolve()}))},t.prototype.ar=function(t,e){var n=Date.now();return!(t<n-e||t>n&&(p("Detected an update time that is in the future: "+t+" > "+n),1))},t.prototype.ji=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Ni=function(){t.Ts.Zi((function(){return t.inForeground="visible"===t.document.visibilityState,t.Qi()}))},this.document.addEventListener("visibilitychange",this.Ni),this.inForeground="visible"===this.document.visibilityState)},t.prototype.wr=function(){this.Ni&&(this.document.removeEventListener("visibilitychange",this.Ni),this.Ni=null)},t.prototype.Ki=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.$i=function(){e.dr(),e.Ts.Zi((function(){return e._r()}))},this.window.addEventListener("unload",this.$i))},t.prototype.Tr=function(){this.$i&&(this.window.removeEventListener("unload",this.$i),this.$i=null)},t.prototype.lr=function(t){var e;try{var n=null!==(null===(e=this.Bi)||void 0===e?void 0:e.getItem(this.cr(t)));return l("IndexedDbPersistence","Client '"+t+"' "+(n?"is":"is not")+" zombied in LocalStorage"),n}catch(t){return p("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},t.prototype.dr=function(){if(this.Bi)try{this.Bi.setItem(this.cr(this.clientId),String(Date.now()))}catch(t){p("Failed to set zombie client id.",t)}},t.prototype.Er=function(){if(this.Bi)try{this.Bi.removeItem(this.cr(this.clientId))}catch(t){}},t.prototype.cr=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},t}();function Ir(t){return _r.Ns(t,Rr.store)}function Er(t){return _r.Ns(t,Xr.store)}var Tr=function(){function t(t,e){this.db=t,this.yr=new yi(this,e)}return t.prototype.pr=function(t){var e=this.br(t);return this.db.Rr().Ii(t).next((function(t){return e.next((function(e){return t+e}))}))},t.prototype.br=function(t){var e=0;return this.vr(t,(function(t){e++})).next((function(){return e}))},t.prototype.pe=function(t,e){return this.db.Rr().pe(t,e)},t.prototype.vr=function(t,e){return this.Sr(t,(function(t,n){return e(n)}))},t.prototype.Ri=function(t,e,n){return Ar(t,n)},t.prototype.gi=function(t,e,n){return Ar(t,n)},t.prototype.Ei=function(t,e,n){return this.db.Rr().Ei(t,e,n)},t.prototype.Dr=function(t,e){return Ar(t,e)},t.prototype.Cr=function(t,e){return function(t,e){var n=!1;return kr(t).Fr((function(r){return Sr(t,r,e).next((function(t){return t&&(n=!0),Rn.resolve(!t)}))})).next((function(){return n}))}(t,e)},t.prototype.$r=function(t,e){var n=this,r=this.db.Pr().Hs(),i=[],o=0;return this.Sr(t,(function(s,u){if(u<=e){var a=n.Cr(t,s).next((function(e){if(!e)return o++,r.Mn(t,s).next((function(){return r.xn(s),br(t).delete([0,Wn(s.path)])}))}));i.push(a)}})).next((function(){return Rn.Sn(i)})).next((function(){return r.apply(t)})).next((function(){return o}))},t.prototype.removeTarget=function(t,e){var n=e.Z(t.vi);return this.db.Rr().di(t,n)},t.prototype.Nr=function(t,e){return Ar(t,e)},t.prototype.Sr=function(t,e){var n,r=br(t),i=Bn.ws;return r.Qs({index:Wr.documentTargetsIndex},(function(t,r){var o=r.path,s=r.sequenceNumber;0===t[0]?(i!==Bn.ws&&e(new U(Kn(n)),i),i=s,n=o):i=Bn.ws})).next((function(){i!==Bn.ws&&e(new U(Kn(n)),i)}))},t.prototype.kr=function(t){return this.db.Pr().Xs(t)},t}();function Ar(t,e){return br(t).put(function(t,e){return new Wr(0,Wn(t.path),e)}(e,t.vi))}function Or(t,e){var n=t.projectId;return t.i||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var Nr=function(){function t(t,e,n,r){this.userId=t,this.serializer=e,this.Kn=n,this.ii=r,this.xr={}}return t.Ar=function(e,n,r,i){return v(""!==e.uid),new t(e.Mr()?e.uid:"",n,r,i)},t.prototype.Or=function(t){var e=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Pr(t).Qs({index:Mr.userMutationsIndex,range:n},(function(t,n,r){e=!1,r.done()})).next((function(){return e}))},t.prototype.Lr=function(t,e,n,r){var i=this,o=Dr(t),s=Pr(t);return s.add({}).next((function(u){v("number"==typeof u);for(var a=new Ln(u,e,n,r),c=function(t,e,n){var r=n.baseMutations.map((function(e){return ce(t.ks,e)})),i=n.mutations.map((function(e){return ce(t.ks,e)}));return new Mr(e,n.batchId,n.dn.toMillis(),r,i)}(i.serializer,i.userId,a),h=[],f=new nt((function(t,e){return w(t.$(),e.$())})),l=0,p=r;l<p.length;l++){var d=p[l],y=Fr.key(i.userId,d.key.path,u);f=f.add(d.key.path.p()),h.push(s.put(c)),h.push(o.put(y,Fr.PLACEHOLDER))}return f.forEach((function(e){h.push(i.Kn.Cs(t,e))})),t.Un((function(){i.xr[u]=a.keys()})),Rn.Sn(h).next((function(){return a}))}))},t.prototype.qr=function(t,e){var n=this;return Pr(t).get(e).next((function(t){return t?(v(t.userId===n.userId),sr(n.serializer,t)):null}))},t.prototype.Br=function(t,e){var n=this;return this.xr[e]?Rn.resolve(this.xr[e]):this.qr(t,e).next((function(t){if(t){var r=t.keys();return n.xr[e]=r,r}return null}))},t.prototype.Ur=function(t,e){var n=this,r=e+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return Pr(t).Qs({index:Mr.userMutationsIndex,range:i},(function(t,e,i){e.userId===n.userId&&(v(e.batchId>=r),o=sr(n.serializer,e)),i.done()})).next((function(){return o}))},t.prototype.Wr=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return Pr(t).Qs({index:Mr.userMutationsIndex,range:e,reverse:!0},(function(t,e,r){n=e.batchId,r.done()})).next((function(){return n}))},t.prototype.Qr=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Pr(t).$s(Mr.userMutationsIndex,n).next((function(t){return t.map((function(t){return sr(e.serializer,t)}))}))},t.prototype.zn=function(t,e){var n=this,r=Fr.prefixForPath(this.userId,e.path),i=IDBKeyRange.lowerBound(r),o=[];return Dr(t).Qs({range:i},(function(r,i,s){var u=r[0],a=r[2],c=Kn(r[1]);if(u===n.userId&&e.path.isEqual(c))return Pr(t).get(a).next((function(t){if(!t)throw y();v(t.userId===n.userId),o.push(sr(n.serializer,t))}));s.done()})).next((function(){return o}))},t.prototype.Zn=function(t,e){var n=this,r=new nt(w),i=[];return e.forEach((function(e){var o=Fr.prefixForPath(n.userId,e.path),s=IDBKeyRange.lowerBound(o),u=Dr(t).Qs({range:s},(function(t,i,o){var s=t[0],u=t[2],a=Kn(t[1]);s===n.userId&&e.path.isEqual(a)?r=r.add(u):o.done()}));i.push(u)})),Rn.Sn(i).next((function(){return n.jr(t,r)}))},t.prototype.os=function(t,e){var n=this,r=e.path,i=r.length+1,o=Fr.prefixForPath(this.userId,r),s=IDBKeyRange.lowerBound(o),u=new nt(w);return Dr(t).Qs({range:s},(function(t,e,o){var s=t[0],a=t[2],c=Kn(t[1]);s===n.userId&&r.D(c)?c.length===i&&(u=u.add(a)):o.done()})).next((function(){return n.jr(t,u)}))},t.prototype.jr=function(t,e){var n=this,r=[],i=[];return e.forEach((function(e){i.push(Pr(t).get(e).next((function(t){if(null===t)throw y();v(t.userId===n.userId),r.push(sr(n.serializer,t))})))})),Rn.Sn(i).next((function(){return r}))},t.prototype.Kr=function(t,e){var n=this;return xr(t.bi,this.userId,e).next((function(r){return t.Un((function(){n.Gr(e.batchId)})),Rn.forEach(r,(function(e){return n.ii.Dr(t,e)}))}))},t.prototype.Gr=function(t){delete this.xr[t]},t.prototype.zr=function(t){var e=this;return this.Or(t).next((function(n){if(!n)return Rn.resolve();var r=IDBKeyRange.lowerBound(Fr.prefixForUser(e.userId)),i=[];return Dr(t).Qs({range:r},(function(t,n,r){if(t[0]===e.userId){var o=Kn(t[1]);i.push(o)}else r.done()})).next((function(){v(0===i.length)}))}))},t.prototype.pi=function(t,e){return Sr(t,this.userId,e)},t.prototype.Hr=function(t){var e=this;return kr(t).get(this.userId).next((function(t){return t||new Ur(e.userId,-1,"")}))},t}();function Sr(t,e,n){var r=Fr.prefixForPath(e,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),s=!1;return Dr(t).Qs({range:o,yi:!0},(function(t,n,r){t[0]===e&&t[1]===i&&(s=!0),r.done()})).next((function(){return s}))}function xr(t,e,n){var r=t.store(Mr.store),i=t.store(Fr.store),o=[],s=IDBKeyRange.only(n.batchId),u=0,a=r.Qs({range:s},(function(t,e,n){return u++,n.delete()}));o.push(a.next((function(){v(1===u)})));for(var c=[],h=0,f=n.mutations;h<f.length;h++){var l=f[h],p=Fr.key(e,l.key.path,n.batchId);o.push(i.delete(p)),c.push(l.key)}return Rn.Sn(o).next((function(){return c}))}function Pr(t){return _r.Ns(t,Mr.store)}function Dr(t){return _r.Ns(t,Fr.store)}function kr(t){return _r.Ns(t,Ur.store)}var jr=10,Lr=function(){function t(t){this.serializer=t}return t.prototype.createOrUpgrade=function(t,e,n,r){var i=this;v(n<r&&n>=0&&r<=jr);var o=new ei(e);n<1&&r>=1&&(function(t){t.createObjectStore(Rr.store)}(t),function(t){t.createObjectStore(Ur.store,{keyPath:Ur.keyPath}),t.createObjectStore(Mr.store,{keyPath:Mr.keyPath,autoIncrement:!0}).createIndex(Mr.userMutationsIndex,Mr.userMutationsKeyPath,{unique:!0}),t.createObjectStore(Fr.store)}(t),Kr(t),function(t){t.createObjectStore(Br.store)}(t));var s=Rn.resolve();return n<3&&r>=3&&(0!==n&&(function(t){t.deleteObjectStore(Wr.store),t.deleteObjectStore(Gr.store),t.deleteObjectStore(Qr.store)}(t),Kr(t)),s=s.next((function(){return function(t){var e=t.store(Qr.store),n=new Qr(0,0,k.min().A(),0);return e.put(Qr.key,n)}(o)}))),n<4&&r>=4&&(0!==n&&(s=s.next((function(){return function(t,e){return e.store(Mr.store).$s().next((function(n){t.deleteObjectStore(Mr.store),t.createObjectStore(Mr.store,{keyPath:Mr.keyPath,autoIncrement:!0}).createIndex(Mr.userMutationsIndex,Mr.userMutationsKeyPath,{unique:!0});var r=e.store(Mr.store),i=n.map((function(t){return r.put(t)}));return Rn.Sn(i)}))}(t,o)}))),s=s.next((function(){!function(t){t.createObjectStore(Xr.store,{keyPath:Xr.keyPath})}(t)}))),n<5&&r>=5&&(s=s.next((function(){return i.removeAcknowledgedMutations(o)}))),n<6&&r>=6&&(s=s.next((function(){return function(t){t.createObjectStore(zr.store)}(t),i.addDocumentGlobal(o)}))),n<7&&r>=7&&(s=s.next((function(){return i.ensureSequenceNumbers(o)}))),n<8&&r>=8&&(s=s.next((function(){return i.createCollectionParentIndex(t,o)}))),n<9&&r>=9&&(s=s.next((function(){!function(t){t.objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges")}(t),function(t){var e=t.objectStore(Br.store);e.createIndex(Br.readTimeIndex,Br.readTimeIndexPath,{unique:!1}),e.createIndex(Br.collectionReadTimeIndex,Br.collectionReadTimeIndexPath,{unique:!1})}(e)}))),n<10&&r>=10&&(s=s.next((function(){return i.rewriteCanonicalIds(o)}))),s},t.prototype.addDocumentGlobal=function(t){var e=0;return t.store(Br.store).Qs((function(t,n){e+=pr(n)})).next((function(){var n=new zr(e);return t.store(zr.store).put(zr.key,n)}))},t.prototype.removeAcknowledgedMutations=function(t){var e=this,n=t.store(Ur.store),r=t.store(Mr.store);return n.$s().next((function(n){return Rn.forEach(n,(function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.$s(Mr.userMutationsIndex,i).next((function(r){return Rn.forEach(r,(function(r){v(r.userId===n.userId);var i=sr(e.serializer,r);return xr(t,n.userId,i).next((function(){}))}))}))}))}))},t.prototype.ensureSequenceNumbers=function(t){var e=t.store(Wr.store),n=t.store(Br.store);return t.store(Qr.store).get(Qr.key).next((function(t){var r=[];return n.Qs((function(n,i){var o=new L(n),s=function(t){return[0,Wn(t)]}(o);r.push(e.get(s).next((function(n){return n?Rn.resolve():function(n){return e.put(new Wr(0,Wn(n),t.highestListenSequenceNumber))}(o)})))})).next((function(){return Rn.Sn(r)}))}))},t.prototype.createCollectionParentIndex=function(t,e){t.createObjectStore(Hr.store,{keyPath:Hr.keyPath});var n=e.store(Hr.store),r=new $n,i=function(t){if(r.add(t)){var e=t.S(),i=t.p();return n.put({collectionId:e,parent:Wn(i)})}};return e.store(Br.store).Qs({yi:!0},(function(t,e){var n=new L(t);return i(n.p())})).next((function(){return e.store(Fr.store).Qs({yi:!0},(function(t,e){var n=Kn(t[1]);return i(n.p())}))}))},t.prototype.rewriteCanonicalIds=function(t){var e=this,n=t.store(Gr.store);return n.Qs((function(t,r){var i=ur(r),o=ar(e.serializer,i);return n.put(o)}))},t}(),Cr=function(t,e){this.seconds=t,this.nanoseconds=e},Rr=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};Rr.store="owner",Rr.key="owner";var Ur=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};Ur.store="mutationQueues",Ur.keyPath="userId";var Mr=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};Mr.store="mutations",Mr.keyPath="batchId",Mr.userMutationsIndex="userMutationsIndex",Mr.userMutationsKeyPath=["userId","batchId"];var Fr=function(){function t(){}return t.prefixForUser=function(t){return[t]},t.prefixForPath=function(t,e){return[t,Wn(e)]},t.key=function(t,e,n){return[t,Wn(e),n]},t}();Fr.store="documentMutations",Fr.PLACEHOLDER=new Fr;var Vr=function(t,e){this.path=t,this.readTime=e},qr=function(t,e){this.path=t,this.version=e},Br=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};Br.store="remoteDocuments",Br.readTimeIndex="readTimeIndex",Br.readTimeIndexPath="readTime",Br.collectionReadTimeIndex="collectionReadTimeIndex",Br.collectionReadTimeIndexPath=["parentPath","readTime"];var zr=function(t){this.byteSize=t};zr.store="remoteDocumentGlobal",zr.key="remoteDocumentGlobalKey";var Gr=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};Gr.store="targets",Gr.keyPath="targetId",Gr.queryTargetsIndexName="queryTargetsIndex",Gr.queryTargetsKeyPath=["canonicalId","targetId"];var Wr=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};Wr.store="targetDocuments",Wr.keyPath=["targetId","path"],Wr.documentTargetsIndex="documentTargetsIndex",Wr.documentTargetsKeyPath=["path","targetId"];var Qr=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};Qr.key="targetGlobalKey",Qr.store="targetGlobal";var Hr=function(t,e){this.collectionId=t,this.parent=e};function Kr(t){t.createObjectStore(Wr.store,{keyPath:Wr.keyPath}).createIndex(Wr.documentTargetsIndex,Wr.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(Gr.store,{keyPath:Gr.keyPath}).createIndex(Gr.queryTargetsIndexName,Gr.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(Qr.store)}Hr.store="collectionParents",Hr.keyPath=["collectionId","parent"];var Xr=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};Xr.store="clientMetadata",Xr.keyPath="clientId";var $r=i.__spreadArrays(i.__spreadArrays(i.__spreadArrays([Ur.store,Mr.store,Fr.store,Br.store,Gr.store,Rr.store,Qr.store,Wr.store],[Xr.store]),[zr.store]),[Hr.store]),Yr=function(){function t(e){this.db=e,12.2===t.Yr(u.getUA())&&p("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return t.Ui=function(e,n,r){return l("SimpleDb","Opening database:",e),new Rn((function(i,o){var s=indexedDB.open(e,n);s.onsuccess=function(e){i(new t(e.target.result))},s.onblocked=function(){o(new P(x.FAILED_PRECONDITION,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=function(t){var e=t.target.error;o("VersionError"===e.name?new P(x.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh."):e)},s.onupgradeneeded=function(t){l("SimpleDb",'Database "'+e+'" requires upgrade from version:',t.oldVersion),r.createOrUpgrade(t.target.result,s.transaction,t.oldVersion,jr).next((function(){l("SimpleDb","Database upgrade to version "+jr+" complete")}))}})).bn()},t.delete=function(t){return l("SimpleDb","Removing database:",t),ri(window.indexedDB.deleteDatabase(t)).bn()},t.Oi=function(){if("undefined"==typeof indexedDB)return!1;if(t.Jr())return!0;var e=u.getUA(),n=t.Yr(e),r=0<n&&n<10,i=t.Xr(e),o=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||o)},t.Jr=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.Zr)},t.Ns=function(t,e){return t.store(e)},t.Yr=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},t.Xr=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},t.prototype.Ji=function(t){this.db.onversionchange=function(e){return t(e)}},t.prototype.runTransaction=function(t,e,n){return i.__awaiter(this,void 0,void 0,(function(){var r,o,s,u,a;return i.__generator(this,(function(c){switch(c.label){case 0:r="readonly"===t,o=0,s=function(){var t,s,a,c,h;return i.__generator(this,(function(i){switch(i.label){case 0:++o,t=ei.open(u.db,r?"readonly":"readwrite",e),i.label=1;case 1:return i.trys.push([1,3,,4]),s=n(t).catch((function(e){return t.abort(e),Rn.reject(e)})).bn(),a={},s.catch((function(){})),[4,t.to];case 2:return[2,(a.value=(i.sent(),s),a)];case 3:return l("SimpleDb","Transaction failed with error: %s. Retrying: %s.",(c=i.sent()).message,h="FirebaseError"!==c.name&&o<3),h?[3,4]:[2,{value:Promise.reject(c)}];case 4:return[2]}}))},u=this,c.label=1;case 1:return[5,s()];case 2:if("object"==typeof(a=c.sent()))return[2,a.value];c.label=3;case 3:return[3,1];case 4:return[2]}}))}))},t.prototype.close=function(){this.db.close()},t}(),Jr=function(){function t(t){this.eo=t,this.no=!1,this.so=null}return Object.defineProperty(t.prototype,"gn",{get:function(){return this.no},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"io",{get:function(){return this.so},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cursor",{set:function(t){this.eo=t},enumerable:!1,configurable:!0}),t.prototype.done=function(){this.no=!0},t.prototype.js=function(t){this.so=t},t.prototype.delete=function(){return ri(this.eo.delete())},t}(),Zr=function(t){function e(e){var n=this;return(n=t.call(this,x.UNAVAILABLE,"IndexedDB transaction failed: "+e)||this).name="IndexedDbTransactionError",n}return i.__extends(e,t),e}(P);function ti(t){return"IndexedDbTransactionError"===t.name}var ei=function(){function t(t){var e=this;this.transaction=t,this.aborted=!1,this.ro=new zn,this.transaction.oncomplete=function(){e.ro.resolve()},this.transaction.onabort=function(){t.error?e.ro.reject(new Zr(t.error)):e.ro.resolve()},this.transaction.onerror=function(t){var n=oi(t.target.error);e.ro.reject(new Zr(n))}}return t.open=function(e,n,r){return new t(e.transaction(r,n))},Object.defineProperty(t.prototype,"to",{get:function(){return this.ro.promise},enumerable:!1,configurable:!0}),t.prototype.abort=function(t){t&&this.ro.reject(t),this.aborted||(l("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},t.prototype.store=function(t){var e=this.transaction.objectStore(t);return new ni(e)},t}(),ni=function(){function t(t){this.store=t}return t.prototype.put=function(t,e){var n;return void 0!==e?(l("SimpleDb","PUT",this.store.name,t,e),n=this.store.put(e,t)):(l("SimpleDb","PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),ri(n)},t.prototype.add=function(t){return l("SimpleDb","ADD",this.store.name,t,t),ri(this.store.add(t))},t.prototype.get=function(t){var e=this;return ri(this.store.get(t)).next((function(n){return void 0===n&&(n=null),l("SimpleDb","GET",e.store.name,t,n),n}))},t.prototype.delete=function(t){return l("SimpleDb","DELETE",this.store.name,t),ri(this.store.delete(t))},t.prototype.count=function(){return l("SimpleDb","COUNT",this.store.name),ri(this.store.count())},t.prototype.$s=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.oo(n,(function(t,e){r.push(e)})).next((function(){return r}))},t.prototype.ho=function(t,e){l("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.yi=!1;var r=this.cursor(n);return this.oo(r,(function(t,e,n){return n.delete()}))},t.prototype.Qs=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.oo(r,e)},t.prototype.Fr=function(t){var e=this.cursor({});return new Rn((function(n,r){e.onerror=function(t){var e=oi(t.target.error);r(e)},e.onsuccess=function(e){var r=e.target.result;r?t(r.primaryKey,r.value).next((function(t){t?r.continue():n()})):n()}}))},t.prototype.oo=function(t,e){var n=[];return new Rn((function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(i){var o=new Jr(i),s=e(i.primaryKey,i.value,o);if(s instanceof Rn){var u=s.catch((function(t){return o.done(),Rn.reject(t)}));n.push(u)}o.gn?r():null===o.io?i.continue():i.continue(o.io)}else r()}})).next((function(){return Rn.Sn(n)}))},t.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},t.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.yi?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},t}();function ri(t){return new Rn((function(e,n){t.onsuccess=function(t){e(t.target.result)},t.onerror=function(t){var e=oi(t.target.error);n(e)}}))}var ii=!1;function oi(t){var e=Yr.Yr(u.getUA());if(e>=12.2&&e<13){var n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){var r=new P("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return ii||(ii=!0,setTimeout((function(){throw r}),0)),r}}return t}function si(){return"undefined"!=typeof window?window:null}var ui=function(){function t(t,e,n,r,i){this.ao=t,this.Es=e,this.uo=n,this.op=r,this.co=i,this.lo=new zn,this.then=this.lo.promise.then.bind(this.lo.promise),this.lo.promise.catch((function(t){}))}return t._o=function(e,n,r,i,o){var s=new t(e,n,Date.now()+r,i,o);return s.start(r),s},t.prototype.start=function(t){var e=this;this.fo=setTimeout((function(){return e.do()}),t)},t.prototype.Ss=function(){return this.do()},t.prototype.cancel=function(t){null!==this.fo&&(this.clearTimeout(),this.lo.reject(new P(x.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},t.prototype.do=function(){var t=this;this.ao.Zi((function(){return null!==t.fo?(t.clearTimeout(),t.op().then((function(e){return t.lo.resolve(e)}))):Promise.resolve()}))},t.prototype.clearTimeout=function(){null!==this.fo&&(this.co(this),clearTimeout(this.fo),this.fo=null)},t}(),ai=function(){function t(){var t=this;this.wo=Promise.resolve(),this.To=[],this.Eo=!1,this.Io=[],this.mo=null,this.Ao=!1,this.Ro=[],this.Po=new Gn(this,"async_queue_retry"),this.Vo=function(){return t.Po.vs()};var e=si();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Vo)}return Object.defineProperty(t.prototype,"yo",{get:function(){return this.Eo},enumerable:!1,configurable:!0}),t.prototype.Zi=function(t){this.enqueue(t)},t.prototype.po=function(t){this.bo(),this.vo(t)},t.prototype.So=function(t){return this.bo(),this.vo(t)},t.prototype.Do=function(t){return i.__awaiter(this,void 0,void 0,(function(){var e;return i.__generator(this,(function(n){switch(n.label){case 0:return this.bo(),this.Eo?[3,2]:(this.Eo=!0,(e=si())&&e.removeEventListener("visibilitychange",this.Vo),[4,this.So(t)]);case 1:n.sent(),n.label=2;case 2:return[2]}}))}))},t.prototype.enqueue=function(t){return this.bo(),this.Eo?new Promise((function(t){})):this.vo(t)},t.prototype.er=function(t){var e=this;this.To.push(t),this.Zi((function(){return e.Co()}))},t.prototype.Co=function(){return i.__awaiter(this,void 0,void 0,(function(){var t,e=this;return i.__generator(this,(function(n){switch(n.label){case 0:if(0===this.To.length)return[3,5];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.To[0]()];case 2:return n.sent(),this.To.shift(),this.Po.reset(),[3,4];case 3:if(!ti(t=n.sent()))throw t;return l("AsyncQueue","Operation failed with retryable error: "+t),[3,4];case 4:this.To.length>0&&this.Po.ys((function(){return e.Co()})),n.label=5;case 5:return[2]}}))}))},t.prototype.vo=function(t){var e=this,n=this.wo.then((function(){return e.Ao=!0,t().catch((function(t){throw e.mo=t,e.Ao=!1,p("INTERNAL UNHANDLED ERROR: ",function(t){var e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t)),t})).then((function(t){return e.Ao=!1,t}))}));return this.wo=n,n},t.prototype.bs=function(t,e,n){var r=this;this.bo(),this.Ro.indexOf(t)>-1&&(e=0);var i=ui._o(this,t,e,n,(function(t){return r.Fo(t)}));return this.Io.push(i),i},t.prototype.bo=function(){this.mo&&y()},t.prototype.$o=function(){},t.prototype.No=function(){return i.__awaiter(this,void 0,void 0,(function(){var t;return i.__generator(this,(function(e){switch(e.label){case 0:return[4,t=this.wo];case 1:e.sent(),e.label=2;case 2:if(t!==this.wo)return[3,0];e.label=3;case 3:return[2]}}))}))},t.prototype.ko=function(t){for(var e=0,n=this.Io;e<n.length;e++)if(n[e].Es===t)return!0;return!1},t.prototype.xo=function(t){var e=this;return this.No().then((function(){e.Io.sort((function(t,e){return t.uo-e.uo}));for(var n=0,r=e.Io;n<r.length;n++){var i=r[n];if(i.Ss(),"all"!==t&&i.Es===t)break}return e.No()}))},t.prototype.Mo=function(t){this.Ro.push(t)},t.prototype.Fo=function(t){var e=this.Io.indexOf(t);this.Io.splice(e,1)},t}();function ci(t,e){if(p("AsyncQueue",e+": "+t),ti(t))return new P(x.UNAVAILABLE,e+": "+t);throw t}function hi(t,e){var n=t[1],r=e[1],i=w(t[0],e[0]);return 0===i?w(n,r):i}var fi=function(){function t(t){this.Oo=t,this.buffer=new nt(hi),this.Lo=0}return t.prototype.qo=function(){return++this.Lo},t.prototype.Bo=function(t){var e=[t,this.qo()];if(this.buffer.size<this.Oo)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();hi(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(t.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),t}(),li={Uo:!1,Wo:0,Qo:0,jo:0},pi=function(){function t(t,e,n){this.Ko=t,this.Go=e,this.zo=n}return t.Ho=function(e){return new t(e,t.Yo,t.Jo)},t}();pi.Xo=-1,pi.Zo=1048576,pi.th=41943040,pi.Yo=10,pi.Jo=1e3,pi.eh=new pi(pi.th,pi.Yo,pi.Jo),pi.nh=new pi(pi.Xo,0,0);var di=function(){function t(t,e){this.yr=t,this.ao=e,this.sh=!1,this.ih=null}return t.prototype.start=function(t){this.yr.params.Ko!==pi.Xo&&this.rh(t)},t.prototype.stop=function(){this.ih&&(this.ih.cancel(),this.ih=null)},Object.defineProperty(t.prototype,"Hi",{get:function(){return null!==this.ih},enumerable:!1,configurable:!0}),t.prototype.rh=function(t){var e=this,n=this.sh?3e5:6e4;l("LruGarbageCollector","Garbage collection scheduled in "+n+"ms"),this.ih=this.ao.bs("lru_garbage_collection",n,(function(){return i.__awaiter(e,void 0,void 0,(function(){var e;return i.__generator(this,(function(n){switch(n.label){case 0:this.ih=null,this.sh=!0,n.label=1;case 1:return n.trys.push([1,3,,7]),[4,t.oh(this.yr)];case 2:return n.sent(),[3,7];case 3:return ti(e=n.sent())?(l("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,mi(e)];case 5:n.sent(),n.label=6;case 6:return[3,7];case 7:return[4,this.rh(t)];case 8:return n.sent(),[2]}}))}))}))},t}(),yi=function(){function t(t,e){this.hh=t,this.params=e}return t.prototype.ah=function(t,e){return this.hh.pr(t).next((function(t){return Math.floor(e/100*t)}))},t.prototype.uh=function(t,e){var n=this;if(0===e)return Rn.resolve(Bn.ws);var r=new fi(e);return this.hh.pe(t,(function(t){return r.Bo(t.sequenceNumber)})).next((function(){return n.hh.vr(t,(function(t){return r.Bo(t)}))})).next((function(){return r.maxValue}))},t.prototype.Ei=function(t,e,n){return this.hh.Ei(t,e,n)},t.prototype.$r=function(t,e){return this.hh.$r(t,e)},t.prototype.lh=function(t,e){var n=this;return this.params.Ko===pi.Xo?(l("LruGarbageCollector","Garbage collection skipped; disabled"),Rn.resolve(li)):this.kr(t).next((function(r){return r<n.params.Ko?(l("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.params.Ko),li):n._h(t,e)}))},t.prototype.kr=function(t){return this.hh.kr(t)},t.prototype._h=function(t,e){var n,r,i,o,u,a,c,h=this,p=Date.now();return this.ah(t,this.params.Go).next((function(e){return e>h.params.zo?(l("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+h.params.zo+" from "+e),r=h.params.zo):r=e,o=Date.now(),h.uh(t,r)})).next((function(r){return n=r,u=Date.now(),h.Ei(t,n,e)})).next((function(e){return i=e,a=Date.now(),h.$r(t,n)})).next((function(t){return c=Date.now(),f()<=s.LogLevel.DEBUG&&l("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(o-p)+"ms\n\tDetermined least recently used "+r+" in "+(u-o)+"ms\n\tRemoved "+i+" targets in "+(a-u)+"ms\n\tRemoved "+t+" documents in "+(c-a)+"ms\nTotal Duration: "+(c-p)+"ms"),Rn.resolve({Uo:!0,Wo:r,Qo:i,jo:t})}))},t}(),vi=function(){function t(t,e,n){this.persistence=t,this.fh=e,this.dh=new Z(w),this.wh=new S((function(t){return z(t)}),G),this.Th=k.min(),this.jn=t.mr(n),this.Eh=t.Pr(),this.qi=t.Rr(),this.Ih=new Vn(this.Eh,this.jn,this.persistence.gr()),this.fh.mh(this.Ih)}return t.prototype.Ah=function(t){return i.__awaiter(this,void 0,void 0,(function(){var e,n,r,o=this;return i.__generator(this,(function(i){switch(i.label){case 0:return e=this.jn,n=this.Ih,[4,this.persistence.runTransaction("Handle user change","readonly",(function(r){var i;return o.jn.Qr(r).next((function(s){return i=s,e=o.persistence.mr(t),n=new Vn(o.Eh,e,o.persistence.gr()),e.Qr(r)})).next((function(t){for(var e=[],o=[],s=ft(),u=0,a=i;u<a.length;u++){var c=a[u];e.push(c.batchId);for(var h=0,f=c.mutations;h<f.length;h++)s=s.add(f[h].key)}for(var l=0,p=t;l<p.length;l++){var d=p[l];o.push(d.batchId);for(var y=0,v=d.mutations;y<v.length;y++)s=s.add(v[y].key)}return n.Jn(r,s).next((function(t){return{Rh:t,Ph:e,gh:o}}))}))}))];case 1:return r=i.sent(),[2,(this.jn=e,this.Ih=n,this.fh.mh(this.Ih),r)]}}))}))},t.prototype.Vh=function(t){var e,n=this,r=D.now(),i=t.reduce((function(t,e){return t.add(e.key)}),ft());return this.persistence.runTransaction("Locally write mutations","readwrite",(function(o){return n.Ih.Jn(o,i).next((function(i){e=i;for(var s=[],u=0,a=t;u<a.length;u++){var c=a[u],h=qe(c,e.get(c.key));null!=h&&s.push(new We(c.key,h,tn(h.proto.mapValue),Re.exists(!0)))}return n.jn.Lr(o,r,s,t)}))})).then((function(t){var n=t.In(e);return{batchId:t.batchId,Cn:n}}))},t.prototype.yh=function(t){var e=this;return this.persistence.runTransaction("Acknowledge batch","readwrite-primary",(function(n){var r=t.batch.keys(),i=e.Eh.Hs({Js:!0});return e.ph(n,t,i).next((function(){return i.apply(n)})).next((function(){return e.jn.zr(n)})).next((function(){return e.Ih.Jn(n,r)}))}))},t.prototype.bh=function(t){var e=this;return this.persistence.runTransaction("Reject batch","readwrite-primary",(function(n){var r;return e.jn.qr(n,t).next((function(t){return v(null!==t),r=t.keys(),e.jn.Kr(n,t)})).next((function(){return e.jn.zr(n)})).next((function(){return e.Ih.Jn(n,r)}))}))},t.prototype.Wr=function(){var t=this;return this.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(function(e){return t.jn.Wr(e)}))},t.prototype.ai=function(){var t=this;return this.persistence.runTransaction("Get last remote snapshot version","readonly",(function(e){return t.qi.ai(e)}))},t.prototype.vh=function(e){var n=this,r=e.X,i=this.dh;return this.persistence.runTransaction("Apply remote event","readwrite-primary",(function(o){var s=n.Eh.Hs({Js:!0});i=n.dh;var u=[];e.Wt.forEach((function(e,s){var a=i.get(s);if(a){u.push(n.qi.Pi(o,e.Xt,s).next((function(){return n.qi.Ai(o,e.Yt,s)})));var c=e.resumeToken;if(c.H()>0){var h=a.tt(c,r).Z(o.vi);i=i.nt(s,h),t.Sh(a,h,e)&&u.push(n.qi.di(o,h))}}}));var a=ot(),c=ft();if(e.jt.forEach((function(t,e){c=c.add(t)})),u.push(s.getEntries(o,c).next((function(t){e.jt.forEach((function(i,c){var h=t.get(i);c instanceof rn&&c.version.isEqual(k.min())?(s.xn(i,r),a=a.nt(i,c)):null==h||c.version.o(h.version)>0||0===c.version.o(h.version)&&h.hasPendingWrites?(s.Nn(c,r),a=a.nt(i,c)):l("LocalStore","Ignoring outdated watch update for ",i,". Current version:",h.version," Watch version:",c.version),e.Kt.has(i)&&u.push(n.persistence.ii.Nr(o,i))}))}))),!r.isEqual(k.min())){var h=n.qi.ai(o).next((function(t){return n.qi.ci(o,o.vi,r)}));u.push(h)}return Rn.Sn(u).next((function(){return s.apply(o)})).next((function(){return n.Ih.Xn(o,a)}))})).then((function(t){return n.dh=i,t}))},t.Sh=function(t,e,n){return v(e.resumeToken.H()>0),0===t.resumeToken.H()||e.X.m()-t.X.m()>=this.Dh||n.Yt.size+n.Jt.size+n.Xt.size>0},t.prototype.Ch=function(t){return i.__awaiter(this,void 0,void 0,(function(){var e,n,r,o,s,u,a,c=this;return i.__generator(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,this.persistence.runTransaction("notifyLocalViewChanges","readwrite",(function(e){return Rn.forEach(t,(function(t){return Rn.forEach(t.as,(function(n){return c.persistence.ii.Ri(e,t.targetId,n)})).next((function(){return Rn.forEach(t.us,(function(n){return c.persistence.ii.gi(e,t.targetId,n)}))}))}))}))];case 1:return i.sent(),[3,3];case 2:if(!ti(e=i.sent()))throw e;return l("LocalStore","Failed to update sequence numbers: "+e),[3,3];case 3:for(n=0,r=t;n<r.length;n++)s=(o=r[n]).targetId,o.fromCache||(u=this.dh.get(s),a=u.et(u.X),this.dh=this.dh.nt(s,a));return[2]}}))}))},t.prototype.Fh=function(t){var e=this;return this.persistence.runTransaction("Get next mutation batch","readonly",(function(n){return void 0===t&&(t=-1),e.jn.Ur(n,t)}))},t.prototype.$h=function(t){var e=this;return this.persistence.runTransaction("read document","readonly",(function(n){return e.Ih.Gn(n,t)}))},t.prototype.Nh=function(t){var e=this;return this.persistence.runTransaction("Allocate target","readwrite",(function(n){var r;return e.qi.mi(n,t).next((function(i){return i?Rn.resolve(r=i):e.qi.ri(n).next((function(i){return r=new X(t,i,0,n.vi),e.qi.li(n,r).next((function(){return r}))}))}))})).then((function(n){var r=e.dh.get(n.targetId);return(null===r||n.X.o(r.X)>0)&&(e.dh=e.dh.nt(n.targetId,n),e.wh.set(t,n.targetId)),n}))},t.prototype.mi=function(t,e){var n=this.wh.get(e);return void 0!==n?Rn.resolve(this.dh.get(n)):this.qi.mi(t,e)},t.prototype.kh=function(t,e){return i.__awaiter(this,void 0,void 0,(function(){var n,r,o,s=this;return i.__generator(this,(function(i){switch(i.label){case 0:n=this.dh.get(t),r=e?"readwrite":"readwrite-primary",i.label=1;case 1:return i.trys.push([1,4,,5]),e?[3,3]:[4,this.persistence.runTransaction("Release target",r,(function(t){return s.persistence.ii.removeTarget(t,n)}))];case 2:i.sent(),i.label=3;case 3:return[3,5];case 4:if(!ti(o=i.sent()))throw o;return l("LocalStore","Failed to update sequence numbers for target "+t+": "+o),[3,5];case 5:return this.dh=this.dh.remove(t),this.wh.delete(n.target),[2]}}))}))},t.prototype.xh=function(t,e){var n=this,r=k.min(),i=ft();return this.persistence.runTransaction("Execute query","readonly",(function(o){return n.mi(o,ln(t)).next((function(t){if(t)return r=t.lastLimboFreeSnapshotVersion,n.qi.Vi(o,t.targetId).next((function(t){i=t}))})).next((function(){return n.fh.ts(o,t,e?r:k.min(),e?i:ft())})).next((function(t){return{documents:t,Mh:i}}))}))},t.prototype.ph=function(t,e,n){var r=this,i=e.batch,o=i.keys(),s=Rn.resolve();return o.forEach((function(r){s=s.next((function(){return n.Mn(t,r)})).next((function(t){var o=t,s=e.An.get(r);v(null!==s),(!o||o.version.o(s)<0)&&(o=i.wn(r,o,e))&&n.Nn(o,e.mn)}))})),s.next((function(){return r.jn.Kr(t,i)}))},t.prototype.oh=function(t){var e=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",(function(n){return t.lh(n,e.dh)}))},t}();function gi(t,e,n){return new vi(t,e,n)}function bi(t,e){var n=g(t),r=g(n.qi),i=n.dh.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",(function(t){return r.Me(t,e).next((function(t){return t?t.target:null}))}))}function mi(t){return i.__awaiter(this,void 0,void 0,(function(){return i.__generator(this,(function(e){if(t.code!==x.FAILED_PRECONDITION||t.message!==Mn)throw t;return l("LocalStore","Unexpectedly lost primary lease"),[2]}))}))}vi.Dh=3e8;var wi=function(){function t(){this.Oh=new nt(_i.Lh),this.qh=new nt(_i.Bh)}return t.prototype._=function(){return this.Oh._()},t.prototype.Ri=function(t,e){var n=new _i(t,e);this.Oh=this.Oh.add(n),this.qh=this.qh.add(n)},t.prototype.Uh=function(t,e){var n=this;t.forEach((function(t){return n.Ri(t,e)}))},t.prototype.gi=function(t,e){this.Wh(new _i(t,e))},t.prototype.Qh=function(t,e){var n=this;t.forEach((function(t){return n.gi(t,e)}))},t.prototype.jh=function(t){var e=this,n=new U(new L([])),r=new _i(n,t),i=new _i(n,t+1),o=[];return this.qh.vt([r,i],(function(t){e.Wh(t),o.push(t.key)})),o},t.prototype.Kh=function(){var t=this;this.Oh.forEach((function(e){return t.Wh(e)}))},t.prototype.Wh=function(t){this.Oh=this.Oh.delete(t),this.qh=this.qh.delete(t)},t.prototype.Gh=function(t){var e=new U(new L([])),n=new _i(e,t),r=new _i(e,t+1),i=ft();return this.qh.vt([n,r],(function(t){i=i.add(t.key)})),i},t.prototype.pi=function(t){var e=new _i(t,0),n=this.Oh.Dt(e);return null!==n&&t.isEqual(n.key)},t}(),_i=function(){function t(t,e){this.key=t,this.zh=e}return t.Lh=function(t,e){return U.P(t.key,e.key)||w(t.zh,e.zh)},t.Bh=function(t,e){return w(t.zh,e.zh)||U.P(t.key,e.key)},t}();function Ii(t,e){if(0!==e.length)throw new P(x.INVALID_ARGUMENT,"Function "+t+"() does not support arguments, but was called with "+Vi(e.length,"argument")+".")}function Ei(t,e,n){if(e.length!==n)throw new P(x.INVALID_ARGUMENT,"Function "+t+"() requires "+Vi(n,"argument")+", but was called with "+Vi(e.length,"argument")+".")}function Ti(t,e,n){if(e.length<n)throw new P(x.INVALID_ARGUMENT,"Function "+t+"() requires at least "+Vi(n,"argument")+", but was called with "+Vi(e.length,"argument")+".")}function Ai(t,e,n,r){if(e.length<n||e.length>r)throw new P(x.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+r+" arguments, but was called with "+Vi(e.length,"argument")+".")}function Oi(t,e,n,r){ki(t,e,Fi(n)+" argument",r)}function Ni(t,e,n,r){void 0!==r&&Oi(t,e,n,r)}function Si(t,e,n,r){ki(t,e,n+" option",r)}function xi(t,e,n,r){void 0!==r&&Si(t,e,n,r)}function Pi(t,e,n,r,i){void 0!==r&&function(t,e,n,r,i){for(var o=[],s=0,u=i;s<u.length;s++){var a=u[s];if(a===r)return;o.push(Li(a))}var c=Li(r);throw new P(x.INVALID_ARGUMENT,"Invalid value "+c+" provided to function "+t+'() for option "'+n+'". Acceptable values: '+o.join(", "))}(t,0,n,r,i)}function Di(t,e,n,r){if(!e.some((function(t){return t===r})))throw new P(x.INVALID_ARGUMENT,"Invalid value "+Li(r)+" provided to function "+t+"() for its "+Fi(n)+" argument. Acceptable values: "+e.join(", "));return r}function ki(t,e,n,r){if(!("object"===e?ji(r):"non-empty string"===e?"string"==typeof r&&""!==r:typeof r===e)){var i=Li(r);throw new P(x.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+i)}}function ji(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function Li(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";var e=function(t){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&e.length>1)return e[1]}return null}(t);return e?"a custom "+e+" object":"an object"}return"function"==typeof t?"a function":y()}function Ci(t,e,n){if(void 0===n)throw new P(x.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+Fi(e)+" argument, but it was undefined.")}function Ri(t,e,n){O(e,(function(e,r){if(n.indexOf(e)<0)throw new P(x.INVALID_ARGUMENT,"Unknown option '"+e+"' passed to function "+t+"(). Available options: "+n.join(", "))}))}function Ui(t,e,n,r){var i=Li(r);return new P(x.INVALID_ARGUMENT,"Function "+t+"() requires its "+Fi(n)+" argument to be a "+e+", but it was: "+i)}function Mi(t,e,n){if(n<=0)throw new P(x.INVALID_ARGUMENT,"Function "+t+"() requires its "+Fi(e)+" argument to be a positive number, but it was: "+n+".")}function Fi(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function Vi(t,e){return t+" "+e+(1===t?"":"s")}function qi(){if("undefined"==typeof Uint8Array)throw new P(x.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Bi(){if("undefined"==typeof atob)throw new P(x.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var zi=function(){function t(t){Bi(),this.Hh=t}return t.fromBase64String=function(e){Ei("Blob.fromBase64String",arguments,1),Oi("Blob.fromBase64String","string",1,e),Bi();try{return new t(Q.fromBase64String(e))}catch(e){throw new P(x.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+e)}},t.fromUint8Array=function(e){if(Ei("Blob.fromUint8Array",arguments,1),qi(),!(e instanceof Uint8Array))throw Ui("Blob.fromUint8Array","Uint8Array",1,e);return new t(Q.fromUint8Array(e))},t.prototype.toBase64=function(){return Ei("Blob.toBase64",arguments,0),Bi(),this.Hh.toBase64()},t.prototype.toUint8Array=function(){return Ei("Blob.toUint8Array",arguments,0),qi(),this.Hh.toUint8Array()},t.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},t.prototype.isEqual=function(t){return this.Hh.isEqual(t.Hh)},t}(),Gi=function(t){!function(t,e,n,r){if(!(e instanceof Array)||e.length<1)throw new P(x.INVALID_ARGUMENT,"Function FieldPath() requires its fieldNames argument to be an array with at least "+Vi(1,"element")+".")}(0,t);for(var e=0;e<t.length;++e)if(Oi("FieldPath","string",e,t[e]),0===t[e].length)throw new P(x.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.Yh=new R(t)},Wi=function(t){function e(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return t.call(this,e)||this}return i.__extends(e,t),e.documentId=function(){return new e(R.L().$())},e.prototype.isEqual=function(t){if(!(t instanceof e))throw Ui("isEqual","FieldPath",1,t);return this.Yh.isEqual(t.Yh)},e}(Gi),Qi=new RegExp("[~\\*/\\[\\]]"),Hi=function(){this.Jh=this},Ki=function(t){function e(e){var n=this;return(n=t.call(this)||this).Xh=e,n}return i.__extends(e,t),e.prototype.Zh=function(t){if(2!==t.ta)throw t.ea(1===t.ta?this.Xh+"() can only appear at the top level of your update data":this.Xh+"() cannot be used with set() unless you pass {merge:true}");return t.Le.push(t.path),null},e.prototype.isEqual=function(t){return t instanceof e},e}(Hi);function Xi(t,e,n){return new co({ta:3,na:e.settings.na,methodName:t.Xh,sa:n},e.s,e.serializer,e.ignoreUndefinedProperties)}var $i=function(t){function e(e){var n=this;return(n=t.call(this)||this).Xh=e,n}return i.__extends(e,t),e.prototype.Zh=function(t){return new Le(t.path,new Ae)},e.prototype.isEqual=function(t){return t instanceof e},e}(Hi),Yi=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Xh=e,r.ia=n,r}return i.__extends(e,t),e.prototype.Zh=function(t){var e=Xi(this,t,!0),n=this.ia.map((function(t){return vo(t,e)})),r=new Oe(n);return new Le(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(Hi),Ji=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Xh=e,r.ia=n,r}return i.__extends(e,t),e.prototype.Zh=function(t){var e=Xi(this,t,!0),n=this.ia.map((function(t){return vo(t,e)})),r=new Se(n);return new Le(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(Hi),Zi=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Xh=e,r.ra=n,r}return i.__extends(e,t),e.prototype.Zh=function(t){var e=new Pe(t.serializer,Xt(t.serializer,this.ra));return new Le(t.path,e)},e.prototype.isEqual=function(t){return this===t},e}(Hi),to=function(t){function e(){return t.call(this)||this}return i.__extends(e,t),e.delete=function(){return Ii("FieldValue.delete",arguments),new eo(new Ki("FieldValue.delete"))},e.serverTimestamp=function(){return Ii("FieldValue.serverTimestamp",arguments),new eo(new $i("FieldValue.serverTimestamp"))},e.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Ti("FieldValue.arrayUnion",arguments,1),new eo(new Yi("FieldValue.arrayUnion",t))},e.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Ti("FieldValue.arrayRemove",arguments,1),new eo(new Ji("FieldValue.arrayRemove",t))},e.increment=function(t){return Oi("FieldValue.increment","number",1,t),Ei("FieldValue.increment",arguments,1),new eo(new Zi("FieldValue.increment",t))},e}(Hi),eo=function(t){function e(e){var n=this;return(n=t.call(this)||this).Jh=e,n.Xh=e.Xh,n}return i.__extends(e,t),e.prototype.Zh=function(t){return this.Jh.Zh(t)},e.prototype.isEqual=function(t){return t instanceof e&&this.Jh.isEqual(t.Jh)},e}(to),no=function(){function t(t,e){if(Ei("GeoPoint",arguments,2),Oi("GeoPoint","number",1,t),Oi("GeoPoint","number",2,e),!isFinite(t)||t<-90||t>90)throw new P(x.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new P(x.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.oa=t,this.ha=e}return Object.defineProperty(t.prototype,"latitude",{get:function(){return this.oa},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"longitude",{get:function(){return this.ha},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.oa===t.oa&&this.ha===t.ha},t.prototype.T=function(t){return w(this.oa,t.oa)||w(this.ha,t.ha)},t}();function ro(t){return new Qt(t,!0)}var io=/^__.*__$/,oo=function(t,e,n){this.aa=t,this.ua=e,this.ca=n},so=function(){function t(t,e,n){this.data=t,this.Le=e,this.fieldTransforms=n}return t.prototype.la=function(t,e){var n=[];return n.push(null!==this.Le?new We(t,this.data,this.Le,e):new Ge(t,this.data,e)),this.fieldTransforms.length>0&&n.push(new He(t,this.fieldTransforms)),n},t}(),uo=function(){function t(t,e,n){this.data=t,this.Le=e,this.fieldTransforms=n}return t.prototype.la=function(t,e){var n=[new We(t,this.data,this.Le,e)];return this.fieldTransforms.length>0&&n.push(new He(t,this.fieldTransforms)),n},t}();function ao(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw y()}}var co=function(){function t(t,e,n,r,i,o){this.settings=t,this.s=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this._a(),this.fieldTransforms=i||[],this.Le=o||[]}return Object.defineProperty(t.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ta",{get:function(){return this.settings.ta},enumerable:!1,configurable:!0}),t.prototype.fa=function(e){return new t(Object.assign(Object.assign({},this.settings),e),this.s,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.Le)},t.prototype.da=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.fa({path:n,sa:!1});return r.wa(t),r},t.prototype.Ta=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.fa({path:n,sa:!1});return r._a(),r},t.prototype.Ea=function(t){return this.fa({path:void 0,sa:!0})},t.prototype.ea=function(t){return Io(t,this.settings.methodName,this.settings.Ia||!1,this.path,this.settings.na)},t.prototype.contains=function(t){return void 0!==this.Le.find((function(e){return t.D(e)}))||void 0!==this.fieldTransforms.find((function(e){return t.D(e.field)}))},t.prototype._a=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.wa(this.path.get(t))},t.prototype.wa=function(t){if(0===t.length)throw this.ea("Document fields must not be empty");if(ao(this.ta)&&io.test(t))throw this.ea('Document fields cannot begin and end with "__"')},t}(),ho=function(){function t(t,e,n){this.s=t,this.ignoreUndefinedProperties=e,this.serializer=n||ro(t)}return t.prototype.ma=function(t,e,n,r){return void 0===r&&(r=!1),new co({ta:t,methodName:e,na:n,path:R.k(),sa:!1,Ia:r},this.s,this.serializer,this.ignoreUndefinedProperties)},t}();function fo(t,e,n,r,i,o){void 0===o&&(o={});var s=t.ma(o.merge||o.mergeFields?2:0,e,n,i);mo("Data must be an object, but it was:",s,r);var u,a,c=go(r,s);if(o.merge)u=new je(s.Le),a=s.fieldTransforms;else if(o.mergeFields){for(var h=[],f=0,l=o.mergeFields;f<l.length;f++){var p=l[f],d=void 0;if(p instanceof Gi)d=p.Yh;else{if("string"!=typeof p)throw y();d=_o(e,p,n)}if(!s.contains(d))throw new P(x.INVALID_ARGUMENT,"Field '"+d+"' is specified in your field mask but missing from your input data.");Eo(h,d)||h.push(d)}u=new je(h),a=s.fieldTransforms.filter((function(t){return u.je(t.field)}))}else u=null,a=s.fieldTransforms;return new so(new Je(c),u,a)}function lo(t,e,n,r){var i=t.ma(1,e,n);mo("Data must be an object, but it was:",i,r);var o=[],s=new Ze;O(r,(function(t,r){var u=_o(e,t,n),a=i.Ta(u);if(r instanceof Hi&&r.Jh instanceof Ki)o.push(u);else{var c=vo(r,a);null!=c&&(o.push(u),s.set(u,c))}}));var u=new je(o);return new uo(s.Ge(),u,i.fieldTransforms)}function po(t,e,n,r,i,o){var s=t.ma(1,e,n),u=[wo(e,r,n)],a=[i];if(o.length%2!=0)throw new P(x.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)u.push(wo(e,o[c])),a.push(o[c+1]);for(var h=[],f=new Ze,l=u.length-1;l>=0;--l)if(!Eo(h,u[l])){var p=u[l],d=a[l],y=s.Ta(p);if(d instanceof Hi&&d.Jh instanceof Ki)h.push(p);else{var v=vo(d,y);null!=v&&(h.push(p),f.set(p,v))}}var g=new je(h);return new uo(f.Ge(),g,s.fieldTransforms)}function yo(t,e,n,r){return void 0===r&&(r=!1),vo(n,t.ma(r?4:3,e))}function vo(t,e){if(bo(t))return mo("Unsupported field value:",e,t),go(t,e);if(t instanceof Hi)return function(t,e){if(!ao(e.ta))throw e.ea(t.Xh+"() can only be used with update() and set()");if(!e.path)throw e.ea(t.Xh+"() is not currently supported inside arrays");var n=t.Zh(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(e.path&&e.Le.push(e.path),t instanceof Array){if(e.settings.sa&&4!==e.ta)throw e.ea("Nested arrays are not supported");return function(t,e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var s=vo(o[i],e.Ea(r));null==s&&(s={nullValue:"NULL_VALUE"}),n.push(s),r++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Xt(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=D.fromDate(t);return{timestampValue:$t(e.serializer,n)}}if(t instanceof D){var r=new D(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:$t(e.serializer,r)}}if(t instanceof no)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof zi)return{bytesValue:Yt(e.serializer,t)};if(t instanceof oo){var i=e.s,o=t.aa;if(!o.isEqual(i))throw e.ea("Document reference is for database "+o.projectId+"/"+o.database+" but should be for database "+i.projectId+"/"+i.database);return{referenceValue:te(t.aa||e.s,t.ua.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.ea("Unsupported field value: "+Li(t))}(t,e)}function go(t,e){var n={};return N(t)?e.path&&e.path.length>0&&e.Le.push(e.path):O(t,(function(t,r){var i=vo(r,e.da(t));null!=i&&(n[t]=i)})),{mapValue:{fields:n}}}function bo(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof D||t instanceof no||t instanceof zi||t instanceof oo||t instanceof Hi)}function mo(t,e,n){if(!bo(n)||!ji(n)){var r=Li(n);throw e.ea("an object"===r?t+" a custom object":t+" "+r)}}function wo(t,e,n){if(e instanceof Gi)return e.Yh;if("string"==typeof e)return _o(t,e);throw Io("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}function _o(t,e,n){try{return function(t){if(t.search(Qi)>=0)throw new P(x.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(Wi.bind.apply(Wi,i.__spreadArrays([void 0],t.split("."))))}catch(i){throw new P(x.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e).Yh}catch(e){throw Io((r=e)instanceof Error?r.message:r.toString(),t,!1,void 0,n)}var r}function Io(t,e,n,r,i){var o=r&&!r._(),s=void 0!==i,u="Function "+e+"() called with invalid data";n&&(u+=" (via `toFirestore()`)");var a="";return(o||s)&&(a+=" (found",o&&(a+=" in field "+r),s&&(a+=" in document "+i),a+=")"),new P(x.INVALID_ARGUMENT,(u+=". ")+t+a)}function Eo(t,e){return t.some((function(t){return t.isEqual(e)}))}var To=function(){function t(t){this.uid=t}return t.prototype.Mr=function(){return null!=this.uid},t.prototype.Aa=function(){return this.Mr()?"uid:"+this.uid:"anonymous-user"},t.prototype.isEqual=function(t){return t.uid===this.uid},t}();To.UNAUTHENTICATED=new To(null),To.Ra=new To("google-credentials-uid"),To.Pa=new To("first-party-uid");var Ao=function(t,e){this.user=e,this.type="OAuth",this.ga={},this.ga.Authorization="Bearer "+t},Oo=function(){function t(){this.Va=null}return t.prototype.getToken=function(){return Promise.resolve(null)},t.prototype.ya=function(){},t.prototype.pa=function(t){this.Va=t,t(To.UNAUTHENTICATED)},t.prototype.ba=function(){this.Va=null},t}(),No=function(){function t(t){var e=this;this.va=null,this.currentUser=To.UNAUTHENTICATED,this.Sa=!1,this.Da=0,this.Va=null,this.forceRefresh=!1,this.va=function(){e.Da++,e.currentUser=e.Ca(),e.Sa=!0,e.Va&&e.Va(e.currentUser)},this.Da=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.va):(this.va(null),t.get().then((function(t){e.auth=t,e.va&&e.auth.addAuthTokenListener(e.va)}),(function(){})))}return t.prototype.getToken=function(){var t=this,e=this.Da,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((function(n){return t.Da!==e?(l("FirebaseCredentialsProvider","getToken aborted due to token change."),t.getToken()):n?(v("string"==typeof n.accessToken),new Ao(n.accessToken,t.currentUser)):null})):Promise.resolve(null)},t.prototype.ya=function(){this.forceRefresh=!0},t.prototype.pa=function(t){this.Va=t,this.Sa&&t(this.currentUser)},t.prototype.ba=function(){this.auth&&this.auth.removeAuthTokenListener(this.va),this.va=null,this.Va=null},t.prototype.Ca=function(){var t=this.auth&&this.auth.getUid();return v(null===t||"string"==typeof t),new To(t)},t}(),So=function(){function t(t,e){this.Fa=t,this.$a=e,this.type="FirstParty",this.user=To.Pa}return Object.defineProperty(t.prototype,"ga",{get:function(){var t={"X-Goog-AuthUser":this.$a},e=this.Fa.auth.Na([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),t}(),xo=function(){function t(t,e){this.Fa=t,this.$a=e}return t.prototype.getToken=function(){return Promise.resolve(new So(this.Fa,this.$a))},t.prototype.pa=function(t){t(To.Pa)},t.prototype.ba=function(){},t.prototype.ya=function(){},t}(),Po=function(){function t(t,e,n,r,i,o){this.Ts=t,this.ka=n,this.xa=r,this.Ma=i,this.listener=o,this.state=0,this.Oa=0,this.La=null,this.stream=null,this.Po=new Gn(t,e)}return t.prototype.qa=function(){return 1===this.state||2===this.state||4===this.state},t.prototype.Ba=function(){return 2===this.state},t.prototype.start=function(){3!==this.state?this.auth():this.Ua()},t.prototype.stop=function(){return i.__awaiter(this,void 0,void 0,(function(){return i.__generator(this,(function(t){switch(t.label){case 0:return this.qa()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},t.prototype.Wa=function(){this.state=0,this.Po.reset()},t.prototype.Qa=function(){var t=this;this.Ba()&&null===this.La&&(this.La=this.Ts.bs(this.ka,6e4,(function(){return t.ja()})))},t.prototype.Ka=function(t){this.Ga(),this.stream.send(t)},t.prototype.ja=function(){return i.__awaiter(this,void 0,void 0,(function(){return i.__generator(this,(function(t){return this.Ba()?[2,this.close(0)]:[2]}))}))},t.prototype.Ga=function(){this.La&&(this.La.cancel(),this.La=null)},t.prototype.close=function(t,e){return i.__awaiter(this,void 0,void 0,(function(){return i.__generator(this,(function(n){switch(n.label){case 0:return this.Ga(),this.Po.cancel(),this.Oa++,3!==t?this.Po.reset():e&&e.code===x.RESOURCE_EXHAUSTED?(p(e.toString()),p("Using maximum backoff delay to prevent overloading the backend."),this.Po.Vs()):e&&e.code===x.UNAUTHENTICATED&&this.Ma.ya(),null!==this.stream&&(this.za(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.Ha(e)];case 1:return n.sent(),[2]}}))}))},t.prototype.za=function(){},t.prototype.auth=function(){var t=this;this.state=1;var e=this.Ya(this.Oa),n=this.Oa;this.Ma.getToken().then((function(e){t.Oa===n&&t.Ja(e)}),(function(n){e((function(){var e=new P(x.UNKNOWN,"Fetching auth token failed: "+n.message);return t.Xa(e)}))}))},t.prototype.Ja=function(t){var e=this,n=this.Ya(this.Oa);this.stream=this.Za(t),this.stream.tu((function(){n((function(){return e.state=2,e.listener.tu()}))})),this.stream.Ha((function(t){n((function(){return e.Xa(t)}))})),this.stream.onMessage((function(t){n((function(){return e.onMessage(t)}))}))},t.prototype.Ua=function(){var t=this;this.state=4,this.Po.ys((function(){return i.__awaiter(t,void 0,void 0,(function(){return i.__generator(this,(function(t){return this.state=0,this.start(),[2]}))}))}))},t.prototype.Xa=function(t){return l("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},t.prototype.Ya=function(t){var e=this;return function(n){e.Ts.Zi((function(){return e.Oa===t?n():(l("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())}))}},t}(),Do=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle",n,r,o)||this).serializer=i,s}return i.__extends(e,t),e.prototype.Za=function(t){return this.xa.eu("Listen",t)},e.prototype.onMessage=function(t){this.Po.reset();var e=function(t,e){var n;if("targetChange"in e){var r=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:y()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(t,e){return t.Oe?(v(void 0===e||"string"==typeof e),Q.fromBase64String(e||"")):(v(void 0===e||e instanceof Uint8Array),Q.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),s=e.targetChange.cause,u=s&&function(t){var e=void 0===t.code?x.UNKNOWN:J(t.code);return new P(e,t.message||"")}(s);n=new _t(r,i,o,u||null)}else if("documentChange"in e){var a=e.documentChange,c=re(t,a.document.name),h=Zt(a.document.updateTime),f=new Je({mapValue:{fields:a.document.fields}}),l=new nn(c,h,f,{});n=new mt(a.targetIds||[],a.removedTargetIds||[],l.key,l)}else if("documentDelete"in e){var p=e.documentDelete,d=re(t,p.document),g=p.readTime?Zt(p.readTime):k.min(),b=new rn(d,g);n=new mt([],p.removedTargetIds||[],b.key,b)}else if("documentRemove"in e){var m=e.documentRemove,w=re(t,m.document);n=new mt([],m.removedTargetIds||[],w,null)}else{if(!("filter"in e))return y();var _=e.filter,I=new $(_.count||0);n=new wt(_.targetId,I)}return n}(this.serializer,t),n=function(t){if(!("targetChange"in t))return k.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length?k.min():e.readTime?Zt(e.readTime):k.min()}(t);return this.listener.nu(e,n)},e.prototype.su=function(t){var e={};e.database=se(this.serializer),e.addTarget=function(t,e){var n,r=e.target;return(n=W(r)?{documents:fe(t,r)}:{query:le(t,r)}).targetId=e.targetId,e.resumeToken.H()>0&&(n.resumeToken=Yt(t,e.resumeToken)),n}(this.serializer,t);var n=function(t,e){var n=function(t,e){switch(e){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return y()}}(0,e.J);return null==n?null:{"goog-listen-tags":n}}(0,t);n&&(e.labels=n),this.Ka(e)},e.prototype.iu=function(t){var e={};e.database=se(this.serializer),e.removeTarget=t,this.Ka(e)},e}(Po),ko=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"write_stream_connection_backoff","write_stream_idle",n,r,o)||this).serializer=i,s.ru=!1,s}return i.__extends(e,t),Object.defineProperty(e.prototype,"ou",{get:function(){return this.ru},enumerable:!1,configurable:!0}),e.prototype.start=function(){this.ru=!1,this.lastStreamToken=void 0,t.prototype.start.call(this)},e.prototype.za=function(){this.ru&&this.hu([])},e.prototype.Za=function(t){return this.xa.eu("Write",t)},e.prototype.onMessage=function(t){if(v(!!t.streamToken),this.lastStreamToken=t.streamToken,this.ru){this.Po.reset();var e=function(t,e){return t&&t.length>0?(v(void 0!==e),t.map((function(t){return function(t,e){var n=Zt(t.updateTime?t.updateTime:e);n.isEqual(k.min())&&(n=Zt(e));var r=null;return t.transformResults&&t.transformResults.length>0&&(r=t.transformResults),new Ce(n,r)}(t,e)}))):[]}(t.writeResults,t.commitTime),n=Zt(t.commitTime);return this.listener.au(n,e)}return v(!t.writeResults||0===t.writeResults.length),this.ru=!0,this.listener.uu()},e.prototype.cu=function(){var t={};t.database=se(this.serializer),this.Ka(t)},e.prototype.hu=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map((function(t){return ce(e.serializer,t)}))};this.Ka(n)},e}(Po),jo=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).credentials=e,r.serializer=n,r.lu=!1,r}return i.__extends(e,t),e.prototype._u=function(){if(this.lu)throw new P(x.FAILED_PRECONDITION,"The client has already been terminated.")},e.prototype.start=function(t){this.xa=t},e.prototype.fu=function(t,e){var n=this;return this._u(),this.credentials.getToken().then((function(r){return n.xa.fu(t,e,r)})).catch((function(t){throw t.code===x.UNAUTHENTICATED&&n.credentials.ya(),t}))},e.prototype.du=function(t,e){var n=this;return this._u(),this.credentials.getToken().then((function(r){return n.xa.du(t,e,r)})).catch((function(t){throw t.code===x.UNAUTHENTICATED&&n.credentials.ya(),t}))},e}((function(){})),Lo=function(){function t(t){this.wu=t,this.Tu=new Map,this.mutations=[],this.Eu=!1,this.Iu=null,this.mu=new Set}return t.prototype.Au=function(t){return i.__awaiter(this,void 0,void 0,(function(){var e,n=this;return i.__generator(this,(function(r){switch(r.label){case 0:if(this.Ru(),this.mutations.length>0)throw new P(x.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(t,e){return i.__awaiter(this,void 0,void 0,(function(){var n,r,o,s,u;return i.__generator(this,(function(i){switch(i.label){case 0:return n=g(t),r={database:se(n.serializer),documents:e.map((function(t){return ne(n.serializer,t)}))},[4,n.du("BatchGetDocuments",r)];case 1:return o=i.sent(),s=new Map,o.forEach((function(t){var e=function(t,e){return"found"in e?function(t,e){v(!!e.found);var n=re(t,e.found.name),r=Zt(e.found.updateTime),i=new Je({mapValue:{fields:e.found.fields}});return new nn(n,r,i,{})}(t,e):"missing"in e?function(t,e){v(!!e.missing),v(!!e.readTime);var n=re(t,e.missing),r=Zt(e.readTime);return new rn(n,r)}(t,e):y()}(n.serializer,t);s.set(e.key.toString(),e)})),u=[],[2,(e.forEach((function(t){var e=s.get(t.toString());v(!!e),u.push(e)})),u)]}}))}))}(this.wu,t)];case 1:return[2,((e=r.sent()).forEach((function(t){t instanceof rn||t instanceof nn?n.Pu(t):y()})),e)]}}))}))},t.prototype.set=function(t,e){this.write(e.la(t,this.Ue(t))),this.mu.add(t)},t.prototype.update=function(t,e){try{this.write(e.la(t,this.gu(t)))}catch(t){this.Iu=t}this.mu.add(t)},t.prototype.delete=function(t){this.write([new $e(t,this.Ue(t))]),this.mu.add(t)},t.prototype.commit=function(){return i.__awaiter(this,void 0,void 0,(function(){var t,e=this;return i.__generator(this,(function(n){switch(n.label){case 0:if(this.Ru(),this.Iu)throw this.Iu;return t=this.Tu,this.mutations.forEach((function(e){t.delete(e.key.toString())})),t.forEach((function(t,n){var r=new U(L.N(n));e.mutations.push(new Ye(r,e.Ue(r)))})),[4,function(t,e){return i.__awaiter(this,void 0,void 0,(function(){var n,r;return i.__generator(this,(function(i){switch(i.label){case 0:return n=g(t),r={database:se(n.serializer),writes:e.map((function(t){return ce(n.serializer,t)}))},[4,n.fu("Commit",r)];case 1:return i.sent(),[2]}}))}))}(this.wu,this.mutations)];case 1:return n.sent(),this.Eu=!0,[2]}}))}))},t.prototype.Pu=function(t){var e;if(t instanceof nn)e=t.version;else{if(!(t instanceof rn))throw y();e=k.min()}var n=this.Tu.get(t.key.toString());if(n){if(!e.isEqual(n))throw new P(x.ABORTED,"Document version changed between two reads.")}else this.Tu.set(t.key.toString(),e)},t.prototype.Ue=function(t){var e=this.Tu.get(t.toString());return!this.mu.has(t)&&e?Re.updateTime(e):Re.We()},t.prototype.gu=function(t){var e=this.Tu.get(t.toString());if(!this.mu.has(t)&&e){if(e.isEqual(k.min()))throw new P(x.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Re.updateTime(e)}return Re.exists(!0)},t.prototype.write=function(t){this.Ru(),this.mutations=this.mutations.concat(t)},t.prototype.Ru=function(){},t}(),Co=function(){function t(t,e){this.ao=t,this.Vu=e,this.state="Unknown",this.yu=0,this.pu=null,this.bu=!0}return t.prototype.vu=function(){var t=this;0===this.yu&&(this.Su("Unknown"),this.pu=this.ao.bs("online_state_timeout",1e4,(function(){return t.pu=null,t.Du("Backend didn't respond within 10 seconds."),t.Su("Offline"),Promise.resolve()})))},t.prototype.Cu=function(t){"Online"===this.state?this.Su("Unknown"):(this.yu++,this.yu>=1&&(this.Fu(),this.Du("Connection failed 1 times. Most recent error: "+t.toString()),this.Su("Offline")))},t.prototype.set=function(t){this.Fu(),this.yu=0,"Online"===t&&(this.bu=!1),this.Su(t)},t.prototype.Su=function(t){t!==this.state&&(this.state=t,this.Vu(t))},t.prototype.Du=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.bu?(p(e),this.bu=!1):l("OnlineStateTracker",e)},t.prototype.Fu=function(){null!==this.pu&&(this.pu.cancel(),this.pu=null)},t}(),Ro=function(){function t(t,e,n,r,o){var s=this;this.$u=t,this.wu=e,this.ao=n,this.Nu=[],this.ku=new Map,this.xu=null,this.Mu=new Set,this.Ou=o,this.Ou.Lu((function(t){n.Zi((function(){return i.__awaiter(s,void 0,void 0,(function(){return i.__generator(this,(function(t){switch(t.label){case 0:return this.qu()?(l("RemoteStore","Restarting streams for network reachability change."),[4,this.Bu()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))}))})),this.Uu=new Co(n,r),this.Wu=function(t,e,n){var r=g(t);return r._u(),new Do(e,r.xa,r.credentials,r.serializer,n)}(this.wu,n,{tu:this.Qu.bind(this),Ha:this.ju.bind(this),nu:this.Ku.bind(this)}),this.Gu=function(t,e,n){var r=g(t);return r._u(),new ko(e,r.xa,r.credentials,r.serializer,n)}(this.wu,n,{tu:this.zu.bind(this),Ha:this.Hu.bind(this),uu:this.Yu.bind(this),au:this.au.bind(this)})}return t.prototype.start=function(){return this.enableNetwork()},t.prototype.enableNetwork=function(){return this.Mu.delete(0),this.Ju()},t.prototype.Ju=function(){return i.__awaiter(this,void 0,void 0,(function(){return i.__generator(this,(function(t){switch(t.label){case 0:return this.qu()?(this.Xu()?this.Zu():this.Uu.set("Unknown"),[4,this.tc()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},t.prototype.disableNetwork=function(){return i.__awaiter(this,void 0,void 0,(function(){return i.__generator(this,(function(t){switch(t.label){case 0:return this.Mu.add(0),[4,this.ec()];case 1:return t.sent(),this.Uu.set("Offline"),[2]}}))}))},t.prototype.ec=function(){return i.__awaiter(this,void 0,void 0,(function(){return i.__generator(this,(function(t){switch(t.label){case 0:return[4,this.Gu.stop()];case 1:return t.sent(),[4,this.Wu.stop()];case 2:return t.sent(),this.Nu.length>0&&(l("RemoteStore","Stopping write stream with "+this.Nu.length+" pending writes"),this.Nu=[]),this.nc(),[2]}}))}))},t.prototype._r=function(){return i.__awaiter(this,void 0,void 0,(function(){return i.__generator(this,(function(t){switch(t.label){case 0:return l("RemoteStore","RemoteStore shutting down."),this.Mu.add(5),[4,this.ec()];case 1:return t.sent(),this.Ou._r(),this.Uu.set("Unknown"),[2]}}))}))},t.prototype.listen=function(t){this.ku.has(t.targetId)||(this.ku.set(t.targetId,t),this.Xu()?this.Zu():this.Wu.Ba()&&this.sc(t))},t.prototype.ic=function(t){this.ku.delete(t),this.Wu.Ba()&&this.rc(t),0===this.ku.size&&(this.Wu.Ba()?this.Wu.Qa():this.qu()&&this.Uu.set("Unknown"))},t.prototype.Me=function(t){return this.ku.get(t)||null},t.prototype.xe=function(t){return this.oc.xe(t)},t.prototype.sc=function(t){this.xu.de(t.targetId),this.Wu.su(t)},t.prototype.rc=function(t){this.xu.de(t),this.Wu.iu(t)},t.prototype.Zu=function(){this.xu=new Et(this),this.Wu.start(),this.Uu.vu()},t.prototype.Xu=function(){return this.qu()&&!this.Wu.qa()&&this.ku.size>0},t.prototype.qu=function(){return 0===this.Mu.size},t.prototype.nc=function(){this.xu=null},t.prototype.Qu=function(){return i.__awaiter(this,void 0,void 0,(function(){var t=this;return i.__generator(this,(function(e){return this.ku.forEach((function(e,n){t.sc(e)})),[2]}))}))},t.prototype.ju=function(t){return i.__awaiter(this,void 0,void 0,(function(){return i.__generator(this,(function(e){return this.nc(),this.Xu()?(this.Uu.Cu(t),this.Zu()):this.Uu.set("Unknown"),[2]}))}))},t.prototype.Ku=function(t,e){return i.__awaiter(this,void 0,void 0,(function(){var n,r,o;return i.__generator(this,(function(i){switch(i.label){case 0:if(this.Uu.set("Online"),!(t instanceof _t&&2===t.state&&t.cause))return[3,6];i.label=1;case 1:return i.trys.push([1,3,,5]),[4,this.hc(t)];case 2:return i.sent(),[3,5];case 3:return n=i.sent(),l("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),n),[4,this.ac(n)];case 4:return i.sent(),[3,5];case 5:return[3,13];case 6:if(t instanceof mt?this.xu.Pe(t):t instanceof wt?this.xu.De(t):this.xu.ye(t),e.isEqual(k.min()))return[3,13];i.label=7;case 7:return i.trys.push([7,11,,13]),[4,this.$u.ai()];case 8:return r=i.sent(),e.o(r)>=0?[4,this.uc(e)]:[3,10];case 9:i.sent(),i.label=10;case 10:return[3,13];case 11:return l("RemoteStore","Failed to raise snapshot:",o=i.sent()),[4,this.ac(o)];case 12:return i.sent(),[3,13];case 13:return[2]}}))}))},t.prototype.ac=function(t,e){return i.__awaiter(this,void 0,void 0,(function(){var n=this;return i.__generator(this,(function(r){switch(r.label){case 0:if(!ti(t))throw t;return this.Mu.add(1),[4,this.ec()];case 1:return r.sent(),this.Uu.set("Offline"),e||(e=function(){return n.$u.ai()}),this.ao.er((function(){return i.__awaiter(n,void 0,void 0,(function(){return i.__generator(this,(function(t){switch(t.label){case 0:return l("RemoteStore","Retrying IndexedDB access"),[4,e()];case 1:return t.sent(),this.Mu.delete(1),[4,this.Ju()];case 2:return t.sent(),[2]}}))}))})),[2]}}))}))},t.prototype.cc=function(t){var e=this;return t().catch((function(n){return e.ac(n,t)}))},t.prototype.uc=function(t){var e=this,n=this.xu.$e(t);return n.Wt.forEach((function(n,r){if(n.resumeToken.H()>0){var i=e.ku.get(r);i&&e.ku.set(r,i.tt(n.resumeToken,t))}})),n.Qt.forEach((function(t){var n=e.ku.get(t);if(n){e.ku.set(t,n.tt(Q.Y,n.X)),e.rc(t);var r=new X(n.target,t,1,n.sequenceNumber);e.sc(r)}})),this.oc.vh(n)},t.prototype.hc=function(t){return i.__awaiter(this,void 0,void 0,(function(){var e,n,r,o;return i.__generator(this,(function(i){switch(i.label){case 0:e=t.cause,n=0,r=t.targetIds,i.label=1;case 1:return n<r.length?this.ku.has(o=r[n])?[4,this.oc.lc(o,e)]:[3,3]:[3,5];case 2:i.sent(),this.ku.delete(o),this.xu.removeTarget(o),i.label=3;case 3:i.label=4;case 4:return n++,[3,1];case 5:return[2]}}))}))},t.prototype.tc=function(){return i.__awaiter(this,void 0,void 0,(function(){var t,e,n;return i.__generator(this,(function(r){switch(r.label){case 0:t=this.Nu.length>0?this.Nu[this.Nu.length-1].batchId:-1,r.label=1;case 1:if(!this._c())return[3,7];r.label=2;case 2:return r.trys.push([2,4,,6]),[4,this.$u.Fh(t)];case 3:return null===(e=r.sent())?(0===this.Nu.length&&this.Gu.Qa(),[3,7]):(t=e.batchId,this.fc(e),[3,6]);case 4:return n=r.sent(),[4,this.ac(n)];case 5:return r.sent(),[3,6];case 6:return[3,1];case 7:return this.dc()&&this.wc(),[2]}}))}))},t.prototype._c=function(){return this.qu()&&this.Nu.length<10},t.prototype.Tc=function(){return this.Nu.length},t.prototype.fc=function(t){this.Nu.push(t),this.Gu.Ba()&&this.Gu.ou&&this.Gu.hu(t.mutations)},t.prototype.dc=function(){return this.qu()&&!this.Gu.qa()&&this.Nu.length>0},t.prototype.wc=function(){this.Gu.start()},t.prototype.zu=function(){return i.__awaiter(this,void 0,void 0,(function(){return i.__generator(this,(function(t){return this.Gu.cu(),[2]}))}))},t.prototype.Yu=function(){return i.__awaiter(this,void 0,void 0,(function(){var t,e;return i.__generator(this,(function(n){for(t=0,e=this.Nu;t<e.length;t++)this.Gu.hu(e[t].mutations);return[2]}))}))},t.prototype.au=function(t,e){return i.__awaiter(this,void 0,void 0,(function(){var n,r,o=this;return i.__generator(this,(function(i){switch(i.label){case 0:return n=this.Nu.shift(),r=Cn.from(n,t,e),[4,this.cc((function(){return o.oc.Ec(r)}))];case 1:return i.sent(),[4,this.tc()];case 2:return i.sent(),[2]}}))}))},t.prototype.Hu=function(t){return i.__awaiter(this,void 0,void 0,(function(){return i.__generator(this,(function(e){switch(e.label){case 0:return t&&this.Gu.ou?[4,this.Ic(t)]:[3,2];case 1:e.sent(),e.label=2;case 2:return this.dc()&&this.wc(),[2]}}))}))},t.prototype.Ic=function(t){return i.__awaiter(this,void 0,void 0,(function(){var e,n,r=this;return i.__generator(this,(function(i){switch(i.label){case 0:return Y(n=t.code)&&n!==x.ABORTED?(e=this.Nu.shift(),this.Gu.Wa(),[4,this.cc((function(){return r.oc.mc(e.batchId,t)}))]):[3,3];case 1:return i.sent(),[4,this.tc()];case 2:i.sent(),i.label=3;case 3:return[2]}}))}))},t.prototype.Ac=function(){return new Lo(this.wu)},t.prototype.Bu=function(){return i.__awaiter(this,void 0,void 0,(function(){return i.__generator(this,(function(t){switch(t.label){case 0:return this.Mu.add(4),[4,this.ec()];case 1:return t.sent(),this.Uu.set("Unknown"),this.Gu.Wa(),this.Wu.Wa(),this.Mu.delete(4),[4,this.Ju()];case 2:return t.sent(),[2]}}))}))},t.prototype.Rc=function(t){return i.__awaiter(this,void 0,void 0,(function(){return i.__generator(this,(function(e){switch(e.label){case 0:return this.ao.$o(),l("RemoteStore","RemoteStore received new credentials"),this.Mu.add(3),[4,this.ec()];case 1:return e.sent(),this.Uu.set("Unknown"),[4,this.oc.Rc(t)];case 2:return e.sent(),this.Mu.delete(3),[4,this.Ju()];case 3:return e.sent(),[2]}}))}))},t.prototype.Pc=function(t){return i.__awaiter(this,void 0,void 0,(function(){return i.__generator(this,(function(e){switch(e.label){case 0:return t?(this.Mu.delete(2),[4,this.Ju()]):[3,2];case 1:return e.sent(),[3,5];case 2:return t?[3,4]:(this.Mu.add(2),[4,this.ec()]);case 3:e.sent(),this.Uu.set("Unknown"),e.label=4;case 4:e.label=5;case 5:return[2]}}))}))},t}();function Uo(t,e){return"firestore_clients_"+t+"_"+e}function Mo(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.Mr()&&(r+="_"+e.uid),r}function Fo(t,e){return"firestore_targets_"+t+"_"+e}var Vo=function(){function t(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}return t.gc=function(e,n,r){var i=JSON.parse(r),o="object"==typeof i&&-1!==["pending","acknowledged","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error),s=void 0;return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(s=new P(i.error.code,i.error.message)),o?new t(e,n,i.state,s):(p("SharedClientState","Failed to parse mutation state for ID '"+n+"': "+r),null)},t.prototype.Vc=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),qo=function(){function t(t,e,n){this.targetId=t,this.state=e,this.error=n}return t.gc=function(e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["not-current","current","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new P(r.error.code,r.error.message)),i?new t(e,r.state,o):(p("SharedClientState","Failed to parse target state for ID '"+e+"': "+n),null)},t.prototype.Vc=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),Bo=function(){function t(t,e){this.clientId=t,this.activeTargetIds=e}return t.gc=function(e,n){for(var r=JSON.parse(n),i="object"==typeof r&&r.activeTargetIds instanceof Array,o=pt(),s=0;i&&s<r.activeTargetIds.length;++s)i=V(r.activeTargetIds[s]),o=o.add(r.activeTargetIds[s]);return i?new t(e,o):(p("SharedClientState","Failed to parse client data for instance '"+e+"': "+n),null)},t}(),zo=function(){function t(t,e){this.clientId=t,this.onlineState=e}return t.gc=function(e){var n=JSON.parse(e);return"object"==typeof n&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new t(n.clientId,n.onlineState):(p("SharedClientState","Failed to parse online state: "+e),null)},t}(),Go=function(){function t(){this.activeTargetIds=pt()}return t.prototype.yc=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},t.prototype.pc=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},t.prototype.Vc=function(){var t={activeTargetIds:this.activeTargetIds.F(),updateTimeMs:Date.now()};return JSON.stringify(t)},t}(),Wo=function(){function t(t,e,n,r,i){this.window=t,this.Ts=e,this.persistenceKey=n,this.bc=r,this.oc=null,this.Vu=null,this.ls=null,this.vc=this.Sc.bind(this),this.Dc=new Z(w),this.Hi=!1,this.Cc=[];var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Fc=Uo(this.persistenceKey,this.bc),this.$c=function(t){return"firestore_sequence_number_"+t}(this.persistenceKey),this.Dc=this.Dc.nt(this.bc,new Go),this.Nc=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.kc=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.xc=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.Mc=function(t){return"firestore_online_state_"+t}(this.persistenceKey),this.window.addEventListener("storage",this.vc)}return t.Oi=function(t){return!(!t||!t.localStorage)},t.prototype.start=function(){return i.__awaiter(this,void 0,void 0,(function(){var t,e,n,r,o,s,u,a,c,h,f=this;return i.__generator(this,(function(i){switch(i.label){case 0:return[4,this.oc.Ir()];case 1:for(t=i.sent(),e=0,n=t;e<n.length;e++)(r=n[e])!==this.bc&&(o=this.getItem(Uo(this.persistenceKey,r)))&&(s=Bo.gc(r,o))&&(this.Dc=this.Dc.nt(s.clientId,s));for(this.Oc(),(u=this.storage.getItem(this.Mc))&&(a=this.Lc(u))&&this.qc(a),c=0,h=this.Cc;c<h.length;c++)this.Sc(h[c]);return this.Cc=[],this.window.addEventListener("unload",(function(){return f._r()})),this.Hi=!0,[2]}}))}))},t.prototype.ds=function(t){this.setItem(this.$c,JSON.stringify(t))},t.prototype.Bc=function(){return this.Uc(this.Dc)},t.prototype.Wc=function(t){var e=!1;return this.Dc.forEach((function(n,r){r.activeTargetIds.has(t)&&(e=!0)})),e},t.prototype.Qc=function(t){this.jc(t,"pending")},t.prototype.Kc=function(t,e,n){this.jc(t,e,n),this.Gc(t)},t.prototype.zc=function(t){var e="not-current";if(this.Wc(t)){var n=this.storage.getItem(Fo(this.persistenceKey,t));if(n){var r=qo.gc(t,n);r&&(e=r.state)}}return this.Hc.yc(t),this.Oc(),e},t.prototype.Yc=function(t){this.Hc.pc(t),this.Oc()},t.prototype.Jc=function(t){return this.Hc.activeTargetIds.has(t)},t.prototype.Xc=function(t){this.removeItem(Fo(this.persistenceKey,t))},t.prototype.Zc=function(t,e,n){this.tl(t,e,n)},t.prototype.Ah=function(t,e,n){var r=this;e.forEach((function(t){r.Gc(t)})),this.currentUser=t,n.forEach((function(t){r.Qc(t)}))},t.prototype.el=function(t){this.nl(t)},t.prototype._r=function(){this.Hi&&(this.window.removeEventListener("storage",this.vc),this.removeItem(this.Fc),this.Hi=!1)},t.prototype.getItem=function(t){var e=this.storage.getItem(t);return l("SharedClientState","READ",t,e),e},t.prototype.setItem=function(t,e){l("SharedClientState","SET",t,e),this.storage.setItem(t,e)},t.prototype.removeItem=function(t){l("SharedClientState","REMOVE",t),this.storage.removeItem(t)},t.prototype.Sc=function(t){var e=this,n=t;if(n.storageArea===this.storage){if(l("SharedClientState","EVENT",n.key,n.newValue),n.key===this.Fc)return void p("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Ts.er((function(){return i.__awaiter(e,void 0,void 0,(function(){var t,e,r,o,s,u;return i.__generator(this,(function(i){if(this.Hi){if(null!==n.key)if(this.Nc.test(n.key)){if(null==n.newValue)return t=this.sl(n.key),[2,this.il(t,null)];if(e=this.rl(n.key,n.newValue))return[2,this.il(e.clientId,e)]}else if(this.kc.test(n.key)){if(null!==n.newValue&&(r=this.ol(n.key,n.newValue)))return[2,this.hl(r)]}else if(this.xc.test(n.key)){if(null!==n.newValue&&(o=this.al(n.key,n.newValue)))return[2,this.ul(o)]}else if(n.key===this.Mc){if(null!==n.newValue&&(s=this.Lc(n.newValue)))return[2,this.qc(s)]}else n.key===this.$c&&(u=function(t){var e=Bn.ws;if(null!=t)try{var n=JSON.parse(t);v("number"==typeof n),e=n}catch(t){p("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(n.newValue))!==Bn.ws&&this.ls(u)}else this.Cc.push(n);return[2]}))}))}))}},Object.defineProperty(t.prototype,"Hc",{get:function(){return this.Dc.get(this.bc)},enumerable:!1,configurable:!0}),t.prototype.Oc=function(){this.setItem(this.Fc,this.Hc.Vc())},t.prototype.jc=function(t,e,n){var r=new Vo(this.currentUser,t,e,n),i=Mo(this.persistenceKey,this.currentUser,t);this.setItem(i,r.Vc())},t.prototype.Gc=function(t){var e=Mo(this.persistenceKey,this.currentUser,t);this.removeItem(e)},t.prototype.nl=function(t){this.storage.setItem(this.Mc,JSON.stringify({clientId:this.bc,onlineState:t}))},t.prototype.tl=function(t,e,n){var r=Fo(this.persistenceKey,t),i=new qo(t,e,n);this.setItem(r,i.Vc())},t.prototype.sl=function(t){var e=this.Nc.exec(t);return e?e[1]:null},t.prototype.rl=function(t,e){var n=this.sl(t);return Bo.gc(n,e)},t.prototype.ol=function(t,e){var n=this.kc.exec(t),r=Number(n[1]);return Vo.gc(new To(void 0!==n[2]?n[2]:null),r,e)},t.prototype.al=function(t,e){var n=this.xc.exec(t),r=Number(n[1]);return qo.gc(r,e)},t.prototype.Lc=function(t){return zo.gc(t)},t.prototype.hl=function(t){return i.__awaiter(this,void 0,void 0,(function(){return i.__generator(this,(function(e){return t.user.uid===this.currentUser.uid?[2,this.oc.cl(t.batchId,t.state,t.error)]:(l("SharedClientState","Ignoring mutation for non-active user "+t.user.uid),[2])}))}))},t.prototype.ul=function(t){return this.oc.ll(t.targetId,t.state,t.error)},t.prototype.il=function(t,e){var n=this,r=e?this.Dc.nt(t,e):this.Dc.remove(t),i=this.Uc(this.Dc),o=this.Uc(r),s=[],u=[];return o.forEach((function(t){i.has(t)||s.push(t)})),i.forEach((function(t){o.has(t)||u.push(t)})),this.oc._l(s,u).then((function(){n.Dc=r}))},t.prototype.qc=function(t){this.Dc.get(t.clientId)&&this.Vu(t.onlineState)},t.prototype.Uc=function(t){var e=pt();return t.forEach((function(t,n){e=e.Ct(n.activeTargetIds)})),e},t}(),Qo=function(){function t(){this.fl=new Go,this.dl={},this.Vu=null,this.ls=null}return t.prototype.Qc=function(t){},t.prototype.Kc=function(t,e,n){},t.prototype.zc=function(t){return this.fl.yc(t),this.dl[t]||"not-current"},t.prototype.Zc=function(t,e,n){this.dl[t]=e},t.prototype.Yc=function(t){this.fl.pc(t)},t.prototype.Jc=function(t){return this.fl.activeTargetIds.has(t)},t.prototype.Xc=function(t){delete this.dl[t]},t.prototype.Bc=function(){return this.fl.activeTargetIds},t.prototype.Wc=function(t){return this.fl.activeTargetIds.has(t)},t.prototype.start=function(){return this.fl=new Go,Promise.resolve()},t.prototype.Ah=function(t,e,n){},t.prototype.el=function(t){},t.prototype._r=function(){},t.prototype.ds=function(t){},t}(),Ho=function(t){this.key=t},Ko=function(t){this.key=t},Xo=function(){function t(t,e){this.query=t,this.wl=e,this.Tl=null,this.Ht=!1,this.El=ft(),this.Lt=ft(),this.Il=wn(t),this.ml=new dt(this.Il)}return Object.defineProperty(t.prototype,"Al",{get:function(){return this.wl},enumerable:!1,configurable:!0}),t.prototype.Rl=function(t,e){var n=this,r=e?e.Pl:new yt,i=e?e.ml:this.ml,o=e?e.Lt:this.Lt,s=i,u=!1,a=this.query.hn()&&i.size===this.query.limit?i.last():null,c=this.query.an()&&i.size===this.query.limit?i.first():null;if(t.ot((function(t,e){var h=i.get(t),f=e instanceof nn?e:null;f&&(f=mn(n.query,f)?f:null);var l=!!h&&n.Lt.has(h.key),p=!!f&&(f.Ke||n.Lt.has(f.key)&&f.hasCommittedMutations),d=!1;h&&f?h.data().isEqual(f.data())?l!==p&&(r.track({type:3,doc:f}),d=!0):n.gl(h,f)||(r.track({type:2,doc:f}),d=!0,(a&&n.Il(f,a)>0||c&&n.Il(f,c)<0)&&(u=!0)):!h&&f?(r.track({type:0,doc:f}),d=!0):h&&!f&&(r.track({type:1,doc:h}),d=!0,(a||c)&&(u=!0)),d&&(f?(s=s.add(f),o=p?o.add(t):o.delete(t)):(s=s.delete(t),o=o.delete(t)))})),this.query.hn()||this.query.an())for(;s.size>this.query.limit;){var h=this.query.hn()?s.last():s.first();s=s.delete(h.key),o=o.delete(h.key),r.track({type:1,doc:h})}return{ml:s,Pl:r,Vl:u,Lt:o}},t.prototype.gl=function(t,e){return t.Ke&&e.hasCommittedMutations&&!e.Ke},t.prototype.qn=function(t,e,n){var r=this,i=this.ml;this.ml=t.ml,this.Lt=t.Lt;var o=t.Pl.Mt();o.sort((function(t,e){return function(t,e){var n=function(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return y()}};return n(t)-n(e)}(t.type,e.type)||r.Il(t.doc,e.doc)})),this.yl(n);var s=e?this.pl():[],u=0===this.El.size&&this.Ht?1:0,a=u!==this.Tl;return this.Tl=u,0!==o.length||a?{snapshot:new vt(this.query,t.ml,i,o,t.Lt,0===u,a,!1),bl:s}:{bl:s}},t.prototype.vl=function(t){return this.Ht&&"Offline"===t?(this.Ht=!1,this.qn({ml:this.ml,Pl:new yt,Lt:this.Lt,Vl:!1},!1)):{bl:[]}},t.prototype.Sl=function(t){return!this.wl.has(t)&&!!this.ml.has(t)&&!this.ml.get(t).Ke},t.prototype.yl=function(t){var e=this;t&&(t.Yt.forEach((function(t){return e.wl=e.wl.add(t)})),t.Jt.forEach((function(t){})),t.Xt.forEach((function(t){return e.wl=e.wl.delete(t)})),this.Ht=t.Ht)},t.prototype.pl=function(){var t=this;if(!this.Ht)return[];var e=this.El;this.El=ft(),this.ml.forEach((function(e){t.Sl(e.key)&&(t.El=t.El.add(e.key))}));var n=[];return e.forEach((function(e){t.El.has(e)||n.push(new Ko(e))})),this.El.forEach((function(t){e.has(t)||n.push(new Ho(t))})),n},t.prototype.Dl=function(t){this.wl=t.Mh,this.El=ft();var e=this.Rl(t.documents);return this.qn(e,!0)},t.prototype.Cl=function(){return vt.Ut(this.query,this.ml,this.Lt,0===this.Tl)},t}(),$o=function(){function t(t,e,n,r){this.ao=t,this.wu=e,this.updateFunction=n,this.lo=r,this.Fl=5,this.Po=new Gn(this.ao,"transaction_retry")}return t.prototype.run=function(){this.$l()},t.prototype.$l=function(){var t=this;this.Po.ys((function(){return i.__awaiter(t,void 0,void 0,(function(){var t,e,n=this;return i.__generator(this,(function(r){return t=new Lo(this.wu),(e=this.Nl(t))&&e.then((function(e){n.ao.Zi((function(){return t.commit().then((function(){n.lo.resolve(e)})).catch((function(t){n.kl(t)}))}))})).catch((function(t){n.kl(t)})),[2]}))}))}))},t.prototype.Nl=function(t){try{var e=this.updateFunction(t);return!M(e)&&e.catch&&e.then?e:(this.lo.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.lo.reject(t),null}},t.prototype.kl=function(t){var e=this;this.Fl>0&&this.xl(t)?(this.Fl-=1,this.ao.Zi((function(){return e.$l(),Promise.resolve()}))):this.lo.reject(t)},t.prototype.xl=function(t){if("FirebaseError"===t.name){var e=t.code;return"aborted"===e||"failed-precondition"===e||!Y(e)}return!1},t}(),Yo=function(t,e,n){this.query=t,this.targetId=e,this.view=n},Jo=function(t){this.key=t,this.Ml=!1},Zo=function(){function t(t,e,n,r,i,o){this.$u=t,this.Ol=e,this.wu=n,this.Ll=r,this.currentUser=i,this.ql=o,this.Bl=null,this.Ul=new S((function(t){return gn(t)}),vn),this.Wl=new Map,this.Ql=[],this.jl=new Z(U.P),this.Kl=new Map,this.Gl=new wi,this.zl={},this.Hl=new Map,this.Yl=dr.si(),this.onlineState="Unknown",this.Jl=void 0}return Object.defineProperty(t.prototype,"Xl",{get:function(){return!0===this.Jl},enumerable:!1,configurable:!0}),t.prototype.subscribe=function(t){this.Bl=t},t.prototype.listen=function(t){return i.__awaiter(this,void 0,void 0,(function(){var e,n,r,o;return i.__generator(this,(function(i){switch(i.label){case 0:return this.Zl("listen()"),(n=this.Ul.get(t))?(this.Ll.zc(n.targetId),e=n.view.Cl(),[3,4]):[3,1];case 1:return[4,this.$u.Nh(ln(t))];case 2:return r=i.sent(),o=this.Ll.zc(r.targetId),[4,this.t_(t,r.targetId,"current"===o)];case 3:e=i.sent(),this.Xl&&this.Ol.listen(r),i.label=4;case 4:return[2,e]}}))}))},t.prototype.t_=function(t,e,n){return i.__awaiter(this,void 0,void 0,(function(){var r,o,s,u,a,c;return i.__generator(this,(function(i){switch(i.label){case 0:return[4,this.$u.xh(t,!0)];case 1:return r=i.sent(),o=new Xo(t,r.Mh),s=o.Rl(r.documents),u=bt.zt(e,n&&"Offline"!==this.onlineState),a=o.qn(s,this.Xl,u),this.e_(e,a.bl),c=new Yo(t,e,o),[2,(this.Ul.set(t,c),this.Wl.has(e)?this.Wl.get(e).push(t):this.Wl.set(e,[t]),a.snapshot)]}}))}))},t.prototype.ic=function(t){return i.__awaiter(this,void 0,void 0,(function(){var e,n,r=this;return i.__generator(this,(function(i){switch(i.label){case 0:return this.Zl("unlisten()"),e=this.Ul.get(t),(n=this.Wl.get(e.targetId)).length>1?[2,(this.Wl.set(e.targetId,n.filter((function(e){return!vn(e,t)}))),void this.Ul.delete(t))]:this.Xl?(this.Ll.Yc(e.targetId),this.Ll.Wc(e.targetId)?[3,2]:[4,this.$u.kh(e.targetId,!1).then((function(){r.Ll.Xc(e.targetId),r.Ol.ic(e.targetId),r.n_(e.targetId)})).catch(mi)]):[3,3];case 1:i.sent(),i.label=2;case 2:return[3,5];case 3:return this.n_(e.targetId),[4,this.$u.kh(e.targetId,!0)];case 4:i.sent(),i.label=5;case 5:return[2]}}))}))},t.prototype.write=function(t,e){return i.__awaiter(this,void 0,void 0,(function(){var n,r,o;return i.__generator(this,(function(i){switch(i.label){case 0:this.Zl("write()"),i.label=1;case 1:return i.trys.push([1,5,,6]),[4,this.$u.Vh(t)];case 2:return n=i.sent(),this.Ll.Qc(n.batchId),this.s_(n.batchId,e),[4,this.i_(n.Cn)];case 3:return i.sent(),[4,this.Ol.tc()];case 4:return i.sent(),[3,6];case 5:return r=i.sent(),o=ci(r,"Failed to persist write"),e.reject(o),[3,6];case 6:return[2]}}))}))},t.prototype.runTransaction=function(t,e,n){new $o(t,this.wu,e,n).run()},t.prototype.vh=function(t){return i.__awaiter(this,void 0,void 0,(function(){var e,n=this;return i.__generator(this,(function(r){switch(r.label){case 0:this.Zl("applyRemoteEvent()"),r.label=1;case 1:return r.trys.push([1,4,,6]),[4,this.$u.vh(t)];case 2:return e=r.sent(),t.Wt.forEach((function(t,e){var r=n.Kl.get(e);r&&(v(t.Yt.size+t.Jt.size+t.Xt.size<=1),t.Yt.size>0?r.Ml=!0:t.Jt.size>0?v(r.Ml):t.Xt.size>0&&(v(r.Ml),r.Ml=!1))})),[4,this.i_(e,t)];case 3:return r.sent(),[3,6];case 4:return[4,mi(r.sent())];case 5:return r.sent(),[3,6];case 6:return[2]}}))}))},t.prototype.vl=function(t,e){if(this.Xl&&0===e||!this.Xl&&1===e){this.Zl("applyOnlineStateChange()");var n=[];this.Ul.forEach((function(e,r){var i=r.view.vl(t);i.snapshot&&n.push(i.snapshot)})),this.Bl.r_(t),this.Bl.nu(n),this.onlineState=t,this.Xl&&this.Ll.el(t)}},t.prototype.lc=function(t,e){return i.__awaiter(this,void 0,void 0,(function(){var n,r,o,s,u,a=this;return i.__generator(this,(function(i){switch(i.label){case 0:return this.Zl("rejectListens()"),this.Ll.Zc(t,"rejected",e),n=this.Kl.get(t),(r=n&&n.key)?(o=(o=new Z(U.P)).nt(r,new rn(r,k.min())),s=ft().add(r),u=new gt(k.min(),new Map,new nt(w),o,s),[4,this.vh(u)]):[3,2];case 1:return i.sent(),this.jl=this.jl.remove(r),this.Kl.delete(t),this.o_(),[3,4];case 2:return[4,this.$u.kh(t,!1).then((function(){return a.n_(t,e)})).catch(mi)];case 3:i.sent(),i.label=4;case 4:return[2]}}))}))},t.prototype.Ec=function(t){return i.__awaiter(this,void 0,void 0,(function(){var e,n;return i.__generator(this,(function(r){switch(r.label){case 0:this.Zl("applySuccessfulWrite()"),e=t.batch.batchId,r.label=1;case 1:return r.trys.push([1,4,,6]),[4,this.$u.yh(t)];case 2:return n=r.sent(),this.h_(e,null),this.a_(e),this.Ll.Kc(e,"acknowledged"),[4,this.i_(n)];case 3:return r.sent(),[3,6];case 4:return[4,mi(r.sent())];case 5:return r.sent(),[3,6];case 6:return[2]}}))}))},t.prototype.mc=function(t,e){return i.__awaiter(this,void 0,void 0,(function(){var n;return i.__generator(this,(function(r){switch(r.label){case 0:this.Zl("rejectFailedWrite()"),r.label=1;case 1:return r.trys.push([1,4,,6]),[4,this.$u.bh(t)];case 2:return n=r.sent(),this.h_(t,e),this.a_(t),this.Ll.Kc(t,"rejected",e),[4,this.i_(n)];case 3:return r.sent(),[3,6];case 4:return[4,mi(r.sent())];case 5:return r.sent(),[3,6];case 6:return[2]}}))}))},t.prototype.u_=function(t){return i.__awaiter(this,void 0,void 0,(function(){var e,n,r,o;return i.__generator(this,(function(i){switch(i.label){case 0:this.Ol.qu()||l("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.$u.Wr()];case 2:return-1===(e=i.sent())?[2,void t.resolve()]:((n=this.Hl.get(e)||[]).push(t),this.Hl.set(e,n),[3,4]);case 3:return r=i.sent(),o=ci(r,"Initialization of waitForPendingWrites() operation failed"),t.reject(o),[3,4];case 4:return[2]}}))}))},t.prototype.a_=function(t){(this.Hl.get(t)||[]).forEach((function(t){t.resolve()})),this.Hl.delete(t)},t.prototype.c_=function(t){this.Hl.forEach((function(e){e.forEach((function(e){e.reject(new P(x.CANCELLED,t))}))})),this.Hl.clear()},t.prototype.s_=function(t,e){var n=this.zl[this.currentUser.Aa()];n||(n=new Z(w)),n=n.nt(t,e),this.zl[this.currentUser.Aa()]=n},t.prototype.h_=function(t,e){var n=this.zl[this.currentUser.Aa()];if(n){var r=n.get(t);r&&(e?r.reject(e):r.resolve(),n=n.remove(t)),this.zl[this.currentUser.Aa()]=n}},t.prototype.n_=function(t,e){var n=this;void 0===e&&(e=null),this.Ll.Yc(t);for(var r=0,i=this.Wl.get(t);r<i.length;r++){var o=i[r];this.Ul.delete(o),e&&this.Bl.l_(o,e)}this.Wl.delete(t),this.Xl&&this.Gl.jh(t).forEach((function(t){n.Gl.pi(t)||n.__(t)}))},t.prototype.__=function(t){var e=this.jl.get(t);null!==e&&(this.Ol.ic(e),this.jl=this.jl.remove(t),this.Kl.delete(e),this.o_())},t.prototype.e_=function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n];i instanceof Ho?(this.Gl.Ri(i.key,t),this.f_(i)):i instanceof Ko?(l("SyncEngine","Document no longer in limbo: "+i.key),this.Gl.gi(i.key,t),this.Gl.pi(i.key)||this.__(i.key)):y()}},t.prototype.f_=function(t){var e=t.key;this.jl.get(e)||(l("SyncEngine","New document in limbo: "+e),this.Ql.push(e),this.o_())},t.prototype.o_=function(){for(;this.Ql.length>0&&this.jl.size<this.ql;){var t=this.Ql.shift(),e=this.Yl.next();this.Kl.set(e,new Jo(t)),this.jl=this.jl.nt(t,e),this.Ol.listen(new X(ln(cn(t.path)),e,2,Bn.ws))}},t.prototype.d_=function(){return this.jl},t.prototype.w_=function(){return this.Ql},t.prototype.i_=function(t,e){return i.__awaiter(this,void 0,void 0,(function(){var n,r,o,s=this;return i.__generator(this,(function(i){switch(i.label){case 0:return n=[],r=[],o=[],this.Ul.forEach((function(i,u){o.push(Promise.resolve().then((function(){var e=u.view.Rl(t);return e.Vl?s.$u.xh(u.query,!1).then((function(t){return u.view.Rl(t.documents,e)})):e})).then((function(t){var i=e&&e.Wt.get(u.targetId),o=u.view.qn(t,s.Xl,i);if(s.e_(u.targetId,o.bl),o.snapshot){s.Xl&&s.Ll.Zc(u.targetId,o.snapshot.fromCache?"not-current":"current"),n.push(o.snapshot);var a=qn.cs(u.targetId,o.snapshot);r.push(a)}})))})),[4,Promise.all(o)];case 1:return i.sent(),this.Bl.nu(n),[4,this.$u.Ch(r)];case 2:return i.sent(),[2]}}))}))},t.prototype.Zl=function(t){},t.prototype.Rc=function(t){return i.__awaiter(this,void 0,void 0,(function(){var e;return i.__generator(this,(function(n){switch(n.label){case 0:return this.currentUser.isEqual(t)?[3,3]:(l("SyncEngine","User change. New user:",t.Aa()),[4,this.$u.Ah(t)]);case 1:return e=n.sent(),this.currentUser=t,this.c_("'waitForPendingWrites' promise is rejected due to a user change."),this.Ll.Ah(t,e.Ph,e.gh),[4,this.i_(e.Rh)];case 2:n.sent(),n.label=3;case 3:return[2]}}))}))},t.prototype.xe=function(t){var e=this.Kl.get(t);if(e&&e.Ml)return ft().add(e.key);var n=ft(),r=this.Wl.get(t);if(!r)return n;for(var i=0,o=r;i<o.length;i++){var s=this.Ul.get(o[i]);n=n.Ct(s.view.Al)}return n},t}();function ts(t,e,n,r,i,o,s){var u=new Zo(t,e,n,r,i,o);return s&&(u.Jl=!0),u}function es(t,e){return i.__awaiter(this,void 0,void 0,(function(){var n,r,o;return i.__generator(this,(function(i){switch(i.label){case 0:return[4,(n=g(t)).$u.xh(e.query,!0)];case 1:return r=i.sent(),o=e.view.Dl(r),[2,(n.Xl&&n.e_(e.targetId,o.bl),o)]}}))}))}function ns(t,e,n,r){return i.__awaiter(this,void 0,void 0,(function(){var o,s;return i.__generator(this,(function(i){switch(i.label){case 0:return(o=g(t)).Zl("applyBatchState()"),[4,function(t,e){var n=g(t),r=g(n.jn);return n.persistence.runTransaction("Lookup mutation documents","readonly",(function(t){return r.Br(t,e).next((function(e){return e?n.Ih.Jn(t,e):Rn.resolve(null)}))}))}(o.$u,e)];case 1:return null===(s=i.sent())?[3,6]:"pending"!==n?[3,3]:[4,o.Ol.tc()];case 2:return i.sent(),[3,4];case 3:"acknowledged"===n||"rejected"===n?(o.h_(e,r||null),function(t,e){g(g(t).jn).Gr(e)}(o.$u,e)):y(),i.label=4;case 4:return[4,o.i_(s)];case 5:return i.sent(),[3,7];case 6:l("SyncEngine","Cannot apply mutation batch with id: "+e),i.label=7;case 7:return[2]}}))}))}function rs(t,e){return i.__awaiter(this,void 0,void 0,(function(){var n,r,o,s,u,a,c;return i.__generator(this,(function(i){switch(i.label){case 0:return n=g(t),!0!==e||!0===n.Jl?[3,3]:(r=n.Ll.Bc(),[4,is(n,r.F())]);case 1:return o=i.sent(),n.Jl=!0,[4,n.Ol.Pc(!0)];case 2:for(i.sent(),s=0,u=o;s<u.length;s++)n.Ol.listen(u[s]);return[3,7];case 3:return!1!==e||!1===n.Jl?[3,7]:(a=[],c=Promise.resolve(),n.Wl.forEach((function(t,e){n.Ll.Jc(e)?a.push(e):c=c.then((function(){return n.n_(e),n.$u.kh(e,!0)})),n.Ol.ic(e)})),[4,c]);case 4:return i.sent(),[4,is(n,a)];case 5:return i.sent(),function(t){var e=g(t);e.Kl.forEach((function(t,n){e.Ol.ic(n)})),e.Gl.Kh(),e.Kl=new Map,e.jl=new Z(U.P)}(n),n.Jl=!1,[4,n.Ol.Pc(!1)];case 6:i.sent(),i.label=7;case 7:return[2]}}))}))}function is(t,e,n){return i.__awaiter(this,void 0,void 0,(function(){var n,r,o,s,u,a,c,h,f,l,p,d,y;return i.__generator(this,(function(i){switch(i.label){case 0:n=g(t),r=[],o=[],s=0,u=e,i.label=1;case 1:return s<u.length?(c=void 0,(h=n.Wl.get(a=u[s]))&&0!==h.length?[4,n.$u.Nh(ln(h[0]))]:[3,7]):[3,13];case 2:c=i.sent(),f=0,l=h,i.label=3;case 3:return f<l.length?(p=n.Ul.get(l[f]),[4,es(n,p)]):[3,6];case 4:(d=i.sent()).snapshot&&o.push(d.snapshot),i.label=5;case 5:return f++,[3,3];case 6:return[3,11];case 7:return[4,bi(n.$u,a)];case 8:return y=i.sent(),[4,n.$u.Nh(y)];case 9:return c=i.sent(),[4,n.t_(os(y),a,!1)];case 10:i.sent(),i.label=11;case 11:r.push(c),i.label=12;case 12:return s++,[3,1];case 13:return[2,(n.Bl.nu(o),r)]}}))}))}function os(t){return an(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function ss(t){var e=g(t);return g(g(e.$u).persistence).Ir()}function us(t,e,n,r){return i.__awaiter(this,void 0,void 0,(function(){var o,s,u;return i.__generator(this,(function(i){switch(i.label){case 0:return(o=g(t)).Jl?(l("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!o.Wl.has(e))return[3,8];switch(n){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,function(t){var e=g(t),n=g(e.Eh);return e.persistence.runTransaction("Get new document changes","readonly",(function(t){return n.Ks(t,e.Th)})).then((function(t){var n=t.Gs;return e.Th=t.readTime,n}))}(o.$u)];case 3:return s=i.sent(),u=gt.Gt(e,"current"===n),[4,o.i_(s,u)];case 4:return i.sent(),[3,8];case 5:return[4,o.$u.kh(e,!0)];case 6:return i.sent(),o.n_(e,r),[3,8];case 7:y(),i.label=8;case 8:return[2]}}))}))}function as(t,e,n){return i.__awaiter(this,void 0,void 0,(function(){var r,o,s,u,a,c,h,f,p;return i.__generator(this,(function(d){switch(d.label){case 0:if(!(r=g(t)).Jl)return[3,10];o=0,s=e,d.label=1;case 1:return o<s.length?r.Wl.has(u=s[o])?(l("SyncEngine","Adding an already active target "+u),[3,5]):[4,bi(r.$u,u)]:[3,6];case 2:return a=d.sent(),[4,r.$u.Nh(a)];case 3:return c=d.sent(),[4,r.t_(os(a),c.targetId,!1)];case 4:d.sent(),r.Ol.listen(c),d.label=5;case 5:return o++,[3,1];case 6:h=function(t){return i.__generator(this,(function(e){switch(e.label){case 0:return r.Wl.has(t)?[4,r.$u.kh(t,!1).then((function(){r.Ol.ic(t),r.n_(t)})).catch(mi)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))},f=0,p=n,d.label=7;case 7:return f<p.length?[5,h(p[f])]:[3,10];case 8:d.sent(),d.label=9;case 9:return f++,[3,7];case 10:return[2]}}))}))}var cs=function(){this.T_=void 0,this.listeners=[]},hs=function(){function t(t){this.oc=t,this.E_=new S((function(t){return gn(t)}),vn),this.onlineState="Unknown",this.I_=new Set,this.oc.subscribe(this)}return t.prototype.listen=function(t){return i.__awaiter(this,void 0,void 0,(function(){var e,n,r,o,s,u;return i.__generator(this,(function(i){switch(i.label){case 0:if(n=!1,(r=this.E_.get(e=t.query))||(n=!0,r=new cs),!n)return[3,4];i.label=1;case 1:return i.trys.push([1,3,,4]),o=r,[4,this.oc.listen(e)];case 2:return o.T_=i.sent(),[3,4];case 3:return s=i.sent(),u=ci(s,"Initialization of query '"+bn(t.query)+"' failed"),[2,void t.onError(u)];case 4:return this.E_.set(e,r),r.listeners.push(t),t.vl(this.onlineState),r.T_&&t.m_(r.T_)&&this.A_(),[2]}}))}))},t.prototype.ic=function(t){return i.__awaiter(this,void 0,void 0,(function(){var e,n,r,o;return i.__generator(this,(function(i){return n=!1,(r=this.E_.get(e=t.query))&&(o=r.listeners.indexOf(t))>=0&&(r.listeners.splice(o,1),n=0===r.listeners.length),n?[2,(this.E_.delete(e),this.oc.ic(e))]:[2]}))}))},t.prototype.nu=function(t){for(var e=!1,n=0,r=t;n<r.length;n++){var i=r[n],o=this.E_.get(i.query);if(o){for(var s=0,u=o.listeners;s<u.length;s++)u[s].m_(i)&&(e=!0);o.T_=i}}e&&this.A_()},t.prototype.l_=function(t,e){var n=this.E_.get(t);if(n)for(var r=0,i=n.listeners;r<i.length;r++)i[r].onError(e);this.E_.delete(t)},t.prototype.r_=function(t){this.onlineState=t;var e=!1;this.E_.forEach((function(n,r){for(var i=0,o=r.listeners;i<o.length;i++)o[i].vl(t)&&(e=!0)})),e&&this.A_()},t.prototype.R_=function(t){this.I_.add(t),t.next()},t.prototype.P_=function(t){this.I_.delete(t)},t.prototype.A_=function(){this.I_.forEach((function(t){t.next()}))},t}(),fs=function(){function t(t,e,n){this.query=t,this.g_=e,this.V_=!1,this.y_=null,this.onlineState="Unknown",this.options=n||{}}return t.prototype.m_=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new vt(t.query,t.docs,t.Ot,e,t.Lt,t.fromCache,t.qt,!0)}var o=!1;return this.V_?this.p_(t)&&(this.g_.next(t),o=!0):this.b_(t,this.onlineState)&&(this.v_(t),o=!0),this.y_=t,o},t.prototype.onError=function(t){this.g_.error(t)},t.prototype.vl=function(t){this.onlineState=t;var e=!1;return this.y_&&!this.V_&&this.b_(this.y_,t)&&(this.v_(this.y_),e=!0),e},t.prototype.b_=function(t,e){return!t.fromCache||!(this.options.S_&&"Offline"!==e||t.docs._()&&"Offline"!==e)},t.prototype.p_=function(t){return t.docChanges.length>0||!!(t.qt||this.y_&&this.y_.hasPendingWrites!==t.hasPendingWrites)&&!0===this.options.includeMetadataChanges},t.prototype.v_=function(t){t=vt.Ut(t.query,t.docs,t.Lt,t.fromCache),this.V_=!0,this.g_.next(t)},t}(),ls=function(){function t(){}return t.prototype.mh=function(t){this.D_=t},t.prototype.ts=function(t,e,n,r){var i=this;return e.on()||n.isEqual(k.min())?this.C_(t,e):this.D_.Jn(t,r).next((function(o){var u=i.F_(e,o);return(e.hn()||e.an())&&i.Vl(e.en,u,r,n)?i.C_(t,e):(f()<=s.LogLevel.DEBUG&&l("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),bn(e)),i.D_.ts(t,e,n).next((function(t){return u.forEach((function(e){t=t.nt(e.key,e)})),t})))}))},t.prototype.F_=function(t,e){var n=new nt(wn(t));return e.forEach((function(e,r){r instanceof nn&&mn(t,r)&&(n=n.add(r))})),n},t.prototype.Vl=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.o(r)>0)},t.prototype.C_=function(t,e){return f()<=s.LogLevel.DEBUG&&l("IndexFreeQueryEngine","Using full collection scan to execute query:",bn(e)),this.D_.ts(t,e,k.min())},t}(),ps=function(){function t(t,e){this.Kn=t,this.ii=e,this.jn=[],this.N_=1,this.k_=new nt(_i.Lh)}return t.prototype.Or=function(t){return Rn.resolve(0===this.jn.length)},t.prototype.Lr=function(t,e,n,r){var i=this.N_;this.N_++;var o=new Ln(i,e,n,r);this.jn.push(o);for(var s=0,u=r;s<u.length;s++){var a=u[s];this.k_=this.k_.add(new _i(a.key,i)),this.Kn.Cs(t,a.key.path.p())}return Rn.resolve(o)},t.prototype.qr=function(t,e){return Rn.resolve(this.x_(e))},t.prototype.Ur=function(t,e){var n=this.M_(e+1),r=n<0?0:n;return Rn.resolve(this.jn.length>r?this.jn[r]:null)},t.prototype.Wr=function(){return Rn.resolve(0===this.jn.length?-1:this.N_-1)},t.prototype.Qr=function(t){return Rn.resolve(this.jn.slice())},t.prototype.zn=function(t,e){var n=this,r=new _i(e,0),i=new _i(e,Number.POSITIVE_INFINITY),o=[];return this.k_.vt([r,i],(function(t){var e=n.x_(t.zh);o.push(e)})),Rn.resolve(o)},t.prototype.Zn=function(t,e){var n=this,r=new nt(w);return e.forEach((function(t){var e=new _i(t,0),i=new _i(t,Number.POSITIVE_INFINITY);n.k_.vt([e,i],(function(t){r=r.add(t.zh)}))})),Rn.resolve(this.O_(r))},t.prototype.os=function(t,e){var n=e.path,r=n.length+1,i=n;U.W(i)||(i=i.child(""));var o=new _i(new U(i),0),s=new nt(w);return this.k_.St((function(t){var e=t.key.path;return!!n.D(e)&&(e.length===r&&(s=s.add(t.zh)),!0)}),o),Rn.resolve(this.O_(s))},t.prototype.O_=function(t){var e=this,n=[];return t.forEach((function(t){var r=e.x_(t);null!==r&&n.push(r)})),n},t.prototype.Kr=function(t,e){var n=this;v(0===this.L_(e.batchId,"removed")),this.jn.shift();var r=this.k_;return Rn.forEach(e.mutations,(function(i){var o=new _i(i.key,e.batchId);return r=r.delete(o),n.ii.Dr(t,i.key)})).next((function(){n.k_=r}))},t.prototype.Gr=function(t){},t.prototype.pi=function(t,e){var n=new _i(e,0),r=this.k_.Dt(n);return Rn.resolve(e.isEqual(r&&r.key))},t.prototype.zr=function(t){return Rn.resolve()},t.prototype.L_=function(t,e){return this.M_(t)},t.prototype.M_=function(t){return 0===this.jn.length?0:t-this.jn[0].batchId},t.prototype.x_=function(t){var e=this.M_(t);return e<0||e>=this.jn.length?null:this.jn[e]},t}(),ds=function(){function t(t,e){this.Kn=t,this.q_=e,this.docs=new Z(U.P),this.size=0}return t.prototype.Nn=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.q_(e);return this.docs=this.docs.nt(r,{Ls:e,size:s,readTime:n}),this.size+=s-o,this.Kn.Cs(t,r.path.p())},t.prototype.xn=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},t.prototype.Mn=function(t,e){var n=this.docs.get(e);return Rn.resolve(n?n.Ls:null)},t.prototype.getEntries=function(t,e){var n=this,r=st();return e.forEach((function(t){var e=n.docs.get(t);r=r.nt(t,e?e.Ls:null)})),Rn.resolve(r)},t.prototype.ts=function(t,e,n){for(var r=at(),i=new U(e.path.child("")),o=this.docs.ut(i);o.wt();){var s=o.dt(),u=s.value,a=u.Ls,c=u.readTime;if(!e.path.D(s.key.path))break;c.o(n)<=0||a instanceof nn&&mn(e,a)&&(r=r.nt(a.key,a))}return Rn.resolve(r)},t.prototype.B_=function(t,e){return Rn.forEach(this.docs,(function(t){return e(t)}))},t.prototype.Hs=function(e){return new t.Ys(this)},t.prototype.Xs=function(t){return Rn.resolve(this.size)},t}();ds.Ys=function(t){function e(e){var n=this;return(n=t.call(this)||this).Zs=e,n}return i.__extends(e,t),e.prototype.qn=function(t){var e=this,n=[];return this.Cn.forEach((function(r,i){i?n.push(e.Zs.Nn(t,i,e.readTime)):e.Zs.xn(r)})),Rn.Sn(n)},e.prototype.On=function(t,e){return this.Zs.Mn(t,e)},e.prototype.Ln=function(t,e){return this.Zs.getEntries(t,e)},e}(Un);var ys=function(){function t(t){this.persistence=t,this.U_=new S((function(t){return z(t)}),G),this.lastRemoteSnapshotVersion=k.min(),this.highestTargetId=0,this.W_=0,this.Q_=new wi,this.targetCount=0,this.j_=dr.ni()}return t.prototype.pe=function(t,e){return this.U_.forEach((function(t,n){return e(n)})),Rn.resolve()},t.prototype.ai=function(t){return Rn.resolve(this.lastRemoteSnapshotVersion)},t.prototype.ui=function(t){return Rn.resolve(this.W_)},t.prototype.ri=function(t){return this.highestTargetId=this.j_.next(),Rn.resolve(this.highestTargetId)},t.prototype.ci=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.W_&&(this.W_=e),Rn.resolve()},t.prototype._i=function(t){this.U_.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.j_=new dr(e),this.highestTargetId=e),t.sequenceNumber>this.W_&&(this.W_=t.sequenceNumber)},t.prototype.li=function(t,e){return this._i(e),this.targetCount+=1,Rn.resolve()},t.prototype.di=function(t,e){return this._i(e),Rn.resolve()},t.prototype.wi=function(t,e){return this.U_.delete(e.target),this.Q_.jh(e.targetId),this.targetCount-=1,Rn.resolve()},t.prototype.Ei=function(t,e,n){var r=this,i=0,o=[];return this.U_.forEach((function(s,u){u.sequenceNumber<=e&&null===n.get(u.targetId)&&(r.U_.delete(s),o.push(r.Ti(t,u.targetId)),i++)})),Rn.Sn(o).next((function(){return i}))},t.prototype.Ii=function(t){return Rn.resolve(this.targetCount)},t.prototype.mi=function(t,e){var n=this.U_.get(e)||null;return Rn.resolve(n)},t.prototype.Ai=function(t,e,n){return this.Q_.Uh(e,n),Rn.resolve()},t.prototype.Pi=function(t,e,n){this.Q_.Qh(e,n);var r=this.persistence.ii,i=[];return r&&e.forEach((function(e){i.push(r.Dr(t,e))})),Rn.Sn(i)},t.prototype.Ti=function(t,e){return this.Q_.jh(e),Rn.resolve()},t.prototype.Vi=function(t,e){var n=this.Q_.Gh(e);return Rn.resolve(n)},t.prototype.pi=function(t,e){return Rn.resolve(this.Q_.pi(e))},t}(),vs=function(){function t(t){var e=this;this.K_={},this.Ci=new Bn(0),this.Fi=!1,this.Fi=!0,this.ii=t(this),this.qi=new ys(this),this.Kn=new Xn,this.Qn=new ds(this.Kn,(function(t){return e.ii.G_(t)}))}return t.prototype.start=function(){return Promise.resolve()},t.prototype._r=function(){return this.Fi=!1,Promise.resolve()},Object.defineProperty(t.prototype,"Hi",{get:function(){return this.Fi},enumerable:!1,configurable:!0}),t.prototype.Yi=function(){},t.prototype.Xi=function(){},t.prototype.gr=function(){return this.Kn},t.prototype.mr=function(t){var e=this.K_[t.Aa()];return e||(e=new ps(this.Kn,this.ii),this.K_[t.Aa()]=e),e},t.prototype.Rr=function(){return this.qi},t.prototype.Pr=function(){return this.Qn},t.prototype.runTransaction=function(t,e,n){var r=this;l("MemoryPersistence","Starting transaction:",t);var i=new gs(this.Ci.next());return this.ii.z_(),n(i).next((function(t){return r.ii.H_(i).next((function(){return t}))})).bn().then((function(t){return i.Wn(),t}))},t.prototype.Y_=function(t,e){return Rn.Dn(Object.values(this.K_).map((function(n){return function(){return n.pi(t,e)}})))},t}(),gs=function(t){function e(e){var n=this;return(n=t.call(this)||this).vi=e,n}return i.__extends(e,t),e}(Fn),bs=function(){function t(t){this.persistence=t,this.J_=new wi,this.X_=null}return t.Z_=function(e){return new t(e)},Object.defineProperty(t.prototype,"tf",{get:function(){if(this.X_)return this.X_;throw y()},enumerable:!1,configurable:!0}),t.prototype.Ri=function(t,e,n){return this.J_.Ri(n,e),this.tf.delete(n),Rn.resolve()},t.prototype.gi=function(t,e,n){return this.J_.gi(n,e),this.tf.add(n),Rn.resolve()},t.prototype.Dr=function(t,e){return this.tf.add(e),Rn.resolve()},t.prototype.removeTarget=function(t,e){var n=this;this.J_.jh(e.targetId).forEach((function(t){return n.tf.add(t)}));var r=this.persistence.Rr();return r.Vi(t,e.targetId).next((function(t){t.forEach((function(t){return n.tf.add(t)}))})).next((function(){return r.wi(t,e)}))},t.prototype.z_=function(){this.X_=new Set},t.prototype.H_=function(t){var e=this,n=this.persistence.Pr().Hs();return Rn.forEach(this.tf,(function(r){return e.ef(t,r).next((function(t){t||n.xn(r)}))})).next((function(){return e.X_=null,n.apply(t)}))},t.prototype.Nr=function(t,e){var n=this;return this.ef(t,e).next((function(t){t?n.tf.delete(e):n.tf.add(e)}))},t.prototype.G_=function(t){return 0},t.prototype.ef=function(t,e){var n=this;return Rn.Dn([function(){return Rn.resolve(n.J_.pi(e))},function(){return n.persistence.Rr().pi(t,e)},function(){return n.persistence.Y_(t,e)}])},t}(),ms=function(){function t(t){this.nf=t.nf,this.sf=t.sf}return t.prototype.tu=function(t){this.if=t},t.prototype.Ha=function(t){this.rf=t},t.prototype.onMessage=function(t){this.hf=t},t.prototype.close=function(){this.sf()},t.prototype.send=function(t){this.nf(t)},t.prototype.af=function(){this.if()},t.prototype.uf=function(t){this.rf(t)},t.prototype.cf=function(t){this.hf(t)},t}(),ws={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},_s=function(){function t(t){this.s=t.s,this.lf=(t.ssl?"https":"http")+"://"+t.host,this.forceLongPolling=t.forceLongPolling}return t.prototype._f=function(t,e){if(e)for(var n in e.ga)e.ga.hasOwnProperty(n)&&(t[n]=e.ga[n]);t["X-Goog-Api-Client"]="gl-js/ fire/7.17.1"},t.prototype.fu=function(t,e,n){var r=this,i=this.ff(t);return new Promise((function(o,s){var u=new a.XhrIo;u.listenOnce(a.EventType.COMPLETE,(function(){try{switch(u.getLastErrorCode()){case a.ErrorCode.NO_ERROR:var e=u.getResponseJson();l("Connection","XHR received:",JSON.stringify(e)),o(e);break;case a.ErrorCode.TIMEOUT:l("Connection",'RPC "'+t+'" timed out'),s(new P(x.DEADLINE_EXCEEDED,"Request time out"));break;case a.ErrorCode.HTTP_ERROR:var n=u.getStatus();if(l("Connection",'RPC "'+t+'" failed with status:',n,"response text:",u.getResponseText()),n>0){var r=u.getResponseJson().error;if(r&&r.status&&r.message){var i=function(t){var e=t.toLowerCase().replace("_","-");return Object.values(x).indexOf(e)>=0?e:x.UNKNOWN}(r.status);s(new P(i,r.message))}else s(new P(x.UNKNOWN,"Server responded with status "+u.getStatus()))}else l("Connection",'RPC "'+t+'" failed'),s(new P(x.UNAVAILABLE,"Connection failed."));break;default:y()}}finally{l("Connection",'RPC "'+t+'" completed.')}}));var c=Object.assign({},e);delete c.database;var h=JSON.stringify(c);l("Connection","XHR sending: ",i+" "+h);var f={"Content-Type":"text/plain"};r._f(f,n),u.send(i,"POST",h,f,15)}))},t.prototype.du=function(t,e,n){return this.fu(t,e,n)},t.prototype.eu=function(t,e){var n=[this.lf,"/","google.firestore.v1.Firestore","/",t,"/channel"],r=a.createWebChannelTransport(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.s.projectId+"/databases/"+this.s.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling};this._f(o.initMessageHeaders,e),u.isMobileCordova()||u.isReactNative()||u.isElectron()||u.isIE()||u.isUWP()||u.isBrowserExtension()||(o.httpHeadersOverwriteParam="$httpHeaders");var c=n.join("");l("Connection","Creating WebChannel: "+c+" "+o);var f=r.createWebChannel(c,o),p=!1,y=!1,g=new ms({nf:function(t){y?l("Connection","Not sending because WebChannel is closed:",t):(p||(l("Connection","Opening WebChannel transport."),f.open(),p=!0),l("Connection","WebChannel sending:",t),f.send(t))},sf:function(){return f.close()}}),b=function(t,e){f.listen(t,(function(t){try{e(t)}catch(t){setTimeout((function(){throw t}),0)}}))};return b(a.WebChannel.EventType.OPEN,(function(){y||l("Connection","WebChannel transport opened.")})),b(a.WebChannel.EventType.CLOSE,(function(){y||(y=!0,l("Connection","WebChannel transport closed"),g.uf())})),b(a.WebChannel.EventType.ERROR,(function(t){y||(y=!0,function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(h.logLevel<=s.LogLevel.WARN){var r=e.map(d);h.warn.apply(h,i.__spreadArrays(["Firestore (7.17.1): "+t],r))}}("Connection","WebChannel transport errored:",t),g.uf(new P(x.UNAVAILABLE,"The operation could not be completed")))})),b(a.WebChannel.EventType.MESSAGE,(function(t){var e;if(!y){var n=t.data[0];v(!!n);var r=n.error||(null===(e=n[0])||void 0===e?void 0:e.error);if(r){l("Connection","WebChannel received error:",r);var i=r.status,o=function(t){var e=H[t];if(void 0!==e)return J(e)}(i),s=r.message;void 0===o&&(o=x.INTERNAL,s="Unknown error status: "+i+" with message "+r.message),y=!0,g.uf(new P(o,s)),f.close()}else l("Connection","WebChannel received:",n),g.cf(n)}})),setTimeout((function(){g.af()}),0),g},t.prototype.ff=function(t){return this.lf+"/v1/projects/"+this.s.projectId+"/databases/"+this.s.database+"/documents:"+ws[t]},t}(),Is=function(){function t(){var t=this;this.df=function(){return t.wf()},this.Tf=function(){return t.Ef()},this.If=[],this.mf()}return t.prototype.Lu=function(t){this.If.push(t)},t.prototype._r=function(){window.removeEventListener("online",this.df),window.removeEventListener("offline",this.Tf)},t.prototype.mf=function(){window.addEventListener("online",this.df),window.addEventListener("offline",this.Tf)},t.prototype.wf=function(){l("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.If;t<e.length;t++)(0,e[t])(0)},t.prototype.Ef=function(){l("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.If;t<e.length;t++)(0,e[t])(1)},t.Oi=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},t}(),Es=function(){function t(){}return t.prototype.Lu=function(t){},t.prototype._r=function(){},t}(),Ts="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",As=function(){function t(){}return t.prototype.initialize=function(t){return i.__awaiter(this,void 0,void 0,(function(){var e,n=this;return i.__generator(this,(function(r){switch(r.label){case 0:return this.Ll=this.Af(t),this.persistence=this.Rf(t),[4,this.persistence.start()];case 1:return r.sent(),this.Pf=this.gf(t),this.$u=this.Vf(t),this.wu=this.yf(t),[4,this.pf(t)];case 2:return e=r.sent(),this.wu.start(e),this.Ol=this.bf(t),this.oc=this.vf(t),this.Sf=this.Df(t),this.Ll.Vu=function(t){return n.oc.vl(t,1)},this.Ol.oc=this.oc,[4,this.Ll.start()];case 3:return r.sent(),[4,this.Ol.start()];case 4:return r.sent(),[4,this.Ol.Pc(this.oc.Xl)];case 5:return r.sent(),[2]}}))}))},t.prototype.pf=function(t){return Promise.resolve(new _s(t.Cf))},t.prototype.Df=function(t){return new hs(this.oc)},t.prototype.gf=function(t){return null},t.prototype.Vf=function(t){return gi(this.persistence,new ls,t.Ff)},t.prototype.Rf=function(t){if(t.Nf.$f)throw new P(x.FAILED_PRECONDITION,Ts);return new vs(bs.Z_)},t.prototype.yf=function(t){var e=ro(t.Cf.s);return function(t,e){return new jo(t,e)}(t.credentials,e)},t.prototype.bf=function(t){var e=this;return new Ro(this.$u,this.wu,t.ao,(function(t){return e.oc.vl(t,0)}),Is.Oi()?new Is:new Es)},t.prototype.Af=function(t){return new Qo},t.prototype.vf=function(t){return ts(this.$u,this.Ol,this.wu,this.Ll,t.Ff,t.ql,!0)},t.prototype.clearPersistence=function(t,e){throw new P(x.FAILED_PRECONDITION,Ts)},t}(),Os=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i.__extends(e,t),e.prototype.initialize=function(e){return i.__awaiter(this,void 0,void 0,(function(){var n=this;return i.__generator(this,(function(r){switch(r.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return r.sent(),[4,this.persistence.zi((function(t){return i.__awaiter(n,void 0,void 0,(function(){return i.__generator(this,(function(e){switch(e.label){case 0:return[4,rs(this.oc,t)];case 1:return e.sent(),this.Pf&&(t&&!this.Pf.Hi?this.Pf.start(this.$u):t||this.Pf.stop()),[2]}}))}))}))];case 2:return r.sent(),[4,function(t){return i.__awaiter(this,void 0,void 0,(function(){var e,n;return i.__generator(this,(function(r){return e=g(t),n=g(e.Eh),[2,e.persistence.runTransaction("Synchronize last document change read time","readonly",(function(t){return n.zs(t)})).then((function(t){e.Th=t}))]}))}))}(this.$u)];case 3:return r.sent(),[2]}}))}))},e.prototype.vf=function(t){var e=ts(this.$u,this.Ol,this.wu,this.Ll,t.Ff,t.ql,!t.Nf.$f||!t.Nf.synchronizeTabs);return this.Ll instanceof Wo&&(this.Ll.oc={cl:ns.bind(null,e),ll:us.bind(null,e),_l:as.bind(null,e),Ir:ss.bind(null,e)}),e},e.prototype.Af=function(t){if(t.Nf.$f&&t.Nf.synchronizeTabs){var e=si();if(!Wo.Oi(e))throw new P(x.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=Or(t.Cf.s,t.Cf.persistenceKey);return new Wo(e,t.ao,n,t.clientId,t.Ff)}return new Qo},e}(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i.__extends(e,t),e.prototype.Vf=function(t){return gi(this.persistence,new ls,t.Ff)},e.prototype.gf=function(t){return new di(this.persistence.ii.yr,t.ao)},e.prototype.Rf=function(t){var e=Or(t.Cf.s,t.Cf.persistenceKey),n=ro(t.Cf.s);return new _r(t.Nf.synchronizeTabs,e,t.clientId,pi.Ho(t.Nf.cacheSizeBytes),t.ao,si(),"undefined"!=typeof document?document:null,n,this.Ll,t.Nf.Di)},e.prototype.Af=function(t){return new Qo},e.prototype.clearPersistence=function(t,e){return function(t){return i.__awaiter(this,void 0,void 0,(function(){return i.__generator(this,(function(e){switch(e.label){case 0:return Yr.Oi()?[4,Yr.delete(t+"main")]:[2,Promise.resolve()];case 1:return e.sent(),[2]}}))}))}(Or(t,e))},e}(As)),Ns=function(){function t(t,e){this.credentials=t,this.ao=e,this.clientId=m.t()}return t.prototype.start=function(t,e,n){var r=this;this.kf(),this.Cf=t;var i=new zn,o=new zn,s=!1;return this.credentials.pa((function(t){if(!s)return s=!0,l("FirestoreClient","Initializing. user=",t.uid),r.xf(e,n,t,o).then(i.resolve,i.reject);r.ao.er((function(){return r.Ol.Rc(t)}))})),this.ao.Zi((function(){return i.promise})),o.promise},t.prototype.enableNetwork=function(){var t=this;return this.kf(),this.ao.enqueue((function(){return t.persistence.Xi(!0),t.Ol.enableNetwork()}))},t.prototype.xf=function(t,e,n,r){return i.__awaiter(this,void 0,void 0,(function(){var o,s=this;return i.__generator(this,(function(u){switch(u.label){case 0:return u.trys.push([0,2,,3]),[4,t.initialize({ao:this.ao,Cf:this.Cf,clientId:this.clientId,credentials:this.credentials,Ff:n,ql:100,Nf:e})];case 1:return u.sent(),this.persistence=t.persistence,this.Ll=t.Ll,this.$u=t.$u,this.Ol=t.Ol,this.oc=t.oc,this.Pf=t.Pf,this.Mf=t.Sf,this.persistence.Yi((function(){return i.__awaiter(s,void 0,void 0,(function(){return i.__generator(this,(function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}}))}))})),r.resolve(),[3,3];case 2:if(o=u.sent(),r.reject(o),!this.Of(o))throw o;return[2,(console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+o),this.xf(new As,{$f:!1},n,r))];case 3:return[2]}}))}))},t.prototype.Of=function(t){return"FirebaseError"===t.name?t.code===x.FAILED_PRECONDITION||t.code===x.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code},t.prototype.kf=function(){if(this.ao.yo)throw new P(x.FAILED_PRECONDITION,"The client has already been terminated.")},t.prototype.disableNetwork=function(){var t=this;return this.kf(),this.ao.enqueue((function(){return t.persistence.Xi(!1),t.Ol.disableNetwork()}))},t.prototype.terminate=function(){var t=this;return this.ao.Do((function(){return i.__awaiter(t,void 0,void 0,(function(){return i.__generator(this,(function(t){switch(t.label){case 0:return this.Pf&&this.Pf.stop(),[4,this.Ol._r()];case 1:return t.sent(),[4,this.Ll._r()];case 2:return t.sent(),[4,this.persistence._r()];case 3:return t.sent(),this.credentials.ba(),[2]}}))}))}))},t.prototype.waitForPendingWrites=function(){var t=this;this.kf();var e=new zn;return this.ao.Zi((function(){return t.oc.u_(e)})),e.promise},t.prototype.listen=function(t,e,n){var r=this;this.kf();var i=new fs(t,e,n);return this.ao.Zi((function(){return r.Mf.listen(i)})),i},t.prototype.ic=function(t){var e=this;this.Lf||this.ao.Zi((function(){return e.Mf.ic(t)}))},t.prototype.qf=function(t){return i.__awaiter(this,void 0,void 0,(function(){var e,n=this;return i.__generator(this,(function(r){switch(r.label){case 0:return this.kf(),e=new zn,[4,this.ao.enqueue((function(){return i.__awaiter(n,void 0,void 0,(function(){var n,r,o;return i.__generator(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,this.$u.$h(t)];case 1:return(n=i.sent())instanceof nn?e.resolve(n):n instanceof rn?e.resolve(null):e.reject(new P(x.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=i.sent(),o=ci(r,"Failed to get document '"+t+" from cache"),e.reject(o),[3,3];case 3:return[2]}}))}))}))];case 1:return[2,(r.sent(),e.promise)]}}))}))},t.prototype.Bf=function(t){return i.__awaiter(this,void 0,void 0,(function(){var e,n=this;return i.__generator(this,(function(r){switch(r.label){case 0:return this.kf(),e=new zn,[4,this.ao.enqueue((function(){return i.__awaiter(n,void 0,void 0,(function(){var n,r,o,s,u,a;return i.__generator(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,this.$u.xh(t,!0)];case 1:return n=i.sent(),r=new Xo(t,n.Mh),o=r.Rl(n.documents),s=r.qn(o,!1),e.resolve(s.snapshot),[3,3];case 2:return u=i.sent(),a=ci(u,"Failed to execute query '"+t+" against cache"),e.reject(a),[3,3];case 3:return[2]}}))}))}))];case 1:return[2,(r.sent(),e.promise)]}}))}))},t.prototype.write=function(t){var e=this;this.kf();var n=new zn;return this.ao.Zi((function(){return e.oc.write(t,n)})),n.promise},t.prototype.s=function(){return this.Cf.s},t.prototype.R_=function(t){var e=this;this.kf(),this.ao.Zi((function(){return e.Mf.R_(t),Promise.resolve()}))},t.prototype.P_=function(t){var e=this;this.Lf||this.ao.Zi((function(){return e.Mf.P_(t),Promise.resolve()}))},Object.defineProperty(t.prototype,"Lf",{get:function(){return this.ao.yo},enumerable:!1,configurable:!0}),t.prototype.transaction=function(t){var e=this;this.kf();var n=new zn;return this.ao.Zi((function(){return e.oc.runTransaction(e.ao,t,n),Promise.resolve()})),n.promise},t}(),Ss=function(){function t(t){this.observer=t,this.muted=!1}return t.prototype.next=function(t){this.Uf(this.observer.next,t)},t.prototype.error=function(t){this.Uf(this.observer.error,t)},t.prototype.Wf=function(){this.muted=!0},t.prototype.Uf=function(t,e){var n=this;this.muted||setTimeout((function(){n.muted||t(e)}),0)},t}();function xs(t){return function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=t,r=0,i=["next","error","complete"];r<i.length;r++){var o=i[r];if(o in n&&"function"==typeof n[o])return!0}return!1}(t)}var Ps=function(){function t(t,e,n,r){this.s=t,this.timestampsInSnapshots=e,this.Qf=n,this.jf=r}return t.prototype.Kf=function(t){switch(xt(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Rt(t.integerValue||t.doubleValue);case 3:return this.Gf(t.timestampValue);case 4:return this.zf(t);case 5:return t.stringValue;case 6:return new zi(Ut(t.bytesValue));case 7:return this.Hf(t.referenceValue);case 8:return this.Yf(t.geoPointValue);case 9:return this.Jf(t.arrayValue);case 10:return this.Xf(t.mapValue);default:throw y()}},t.prototype.Xf=function(t){var e=this,n={};return O(t.fields||{},(function(t,r){n[t]=e.Kf(r)})),n},t.prototype.Yf=function(t){return new no(Rt(t.latitude),Rt(t.longitude))},t.prototype.Jf=function(t){var e=this;return(t.values||[]).map((function(t){return e.Kf(t)}))},t.prototype.zf=function(t){switch(this.Qf){case"previous":var e=function t(e){var n=e.mapValue.fields.__previous_value__;return Ot(n)?t(n):n}(t);return null==e?null:this.Kf(e);case"estimate":return this.Gf(Nt(t));default:return null}},t.prototype.Gf=function(t){var e=Ct(t),n=new D(e.seconds,e.nanos);return this.timestampsInSnapshots?n:n.toDate()},t.prototype.Hf=function(t){var e=L.N(t);v(we(e));var n=new T(e.get(1),e.get(3)),r=new U(e.V(5));return n.isEqual(this.s)||p("Document "+r+" contains a document reference within a different database ("+n.projectId+"/"+n.database+") which is not supported. It will be treated as a reference in the current database ("+this.s.projectId+"/"+this.s.database+") instead."),this.jf(r)},t}(),Ds=pi.Xo,ks=function(){function t(t){var e,n,r,i;if(void 0===t.host){if(void 0!==t.ssl)throw new P(x.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else Si("settings","non-empty string","host",t.host),this.host=t.host,xi("settings","boolean","ssl",t.ssl),this.ssl=null===(e=t.ssl)||void 0===e||e;if(Ri("settings",t,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling","ignoreUndefinedProperties"]),xi("settings","object","credentials",t.credentials),this.credentials=t.credentials,xi("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),xi("settings","boolean","ignoreUndefinedProperties",t.ignoreUndefinedProperties),!0===t.timestampsInSnapshots?p("The setting 'timestampsInSnapshots: true' is no longer required and should be removed."):!1===t.timestampsInSnapshots&&p("Support for 'timestampsInSnapshots: false' will be removed soon. You must update your code to handle Timestamp objects."),this.timestampsInSnapshots=null===(n=t.timestampsInSnapshots)||void 0===n||n,this.ignoreUndefinedProperties=null!==(r=t.ignoreUndefinedProperties)&&void 0!==r&&r,xi("settings","number","cacheSizeBytes",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=pi.th;else{if(t.cacheSizeBytes!==Ds&&t.cacheSizeBytes<pi.Zo)throw new P(x.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+pi.Zo);this.cacheSizeBytes=t.cacheSizeBytes}xi("settings","boolean","experimentalForceLongPolling",t.experimentalForceLongPolling),this.forceLongPolling=null!==(i=t.experimentalForceLongPolling)&&void 0!==i&&i}return t.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.forceLongPolling===t.forceLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},t}(),js=function(){function t(e,n,r){var o=this;if(void 0===r&&(r=new As),this.Zf=null,this.td=new ai,this.INTERNAL={delete:function(){return i.__awaiter(o,void 0,void 0,(function(){return i.__generator(this,(function(t){switch(t.label){case 0:return this.ed(),[4,this.nd.terminate()];case 1:return t.sent(),[2]}}))}))}},"object"==typeof e.options){var s=e;this.Zf=s,this.aa=t.sd(s),this.rd=s.name,this.od=new No(n)}else{var u=e;if(!u.projectId)throw new P(x.INVALID_ARGUMENT,"Must provide projectId");this.aa=new T(u.projectId,u.database),this.rd="[DEFAULT]",this.od=new Oo}this.hd=r,this.ad=new ks({})}return Object.defineProperty(t.prototype,"ud",{get:function(){return this.ld||(this.ld=new ho(this.aa,this.ad.ignoreUndefinedProperties)),this.ld},enumerable:!1,configurable:!0}),t.prototype.settings=function(t){Ei("Firestore.settings",arguments,1),Oi("Firestore.settings","object",1,t);var e=new ks(t);if(this.nd&&!this.ad.isEqual(e))throw new P(x.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");this.ad=e,void 0!==e.credentials&&(this.od=function(t){if(!t)return new Oo;switch(t.type){case"gapi":var e=t._d;return v(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new xo(e,t.$a||"0");case"provider":return t._d;default:throw new P(x.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(e.credentials))},t.prototype.enableNetwork=function(){return this.ed(),this.nd.enableNetwork()},t.prototype.disableNetwork=function(){return this.ed(),this.nd.disableNetwork()},t.prototype.enablePersistence=function(t){var e,n;if(this.nd)throw new P(x.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var r=!1,i=!1;if(t&&(void 0!==t.experimentalTabSynchronization&&p("The 'experimentalTabSynchronization' setting will be removed. Use 'synchronizeTabs' instead."),r=null!==(n=null!==(e=t.synchronizeTabs)&&void 0!==e?e:t.experimentalTabSynchronization)&&void 0!==n&&n,i=!!t.experimentalForceOwningTab&&t.experimentalForceOwningTab,r&&i))throw new P(x.INVALID_ARGUMENT,"The 'experimentalForceOwningTab' setting cannot be used with 'synchronizeTabs'.");return this.fd(this.hd,{$f:!0,cacheSizeBytes:this.ad.cacheSizeBytes,synchronizeTabs:r,Di:i})},t.prototype.clearPersistence=function(){return i.__awaiter(this,void 0,void 0,(function(){var t,e=this;return i.__generator(this,(function(n){if(void 0!==this.nd&&!this.nd.Lf)throw new P(x.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");return t=new zn,[2,(this.td.po((function(){return i.__awaiter(e,void 0,void 0,(function(){var e;return i.__generator(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.hd.clearPersistence(this.aa,this.rd)];case 1:return n.sent(),t.resolve(),[3,3];case 2:return e=n.sent(),t.reject(e),[3,3];case 3:return[2]}}))}))})),t.promise)]}))}))},t.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(t.prototype,"dd",{get:function(){return this.ed(),this.nd.Lf},enumerable:!1,configurable:!0}),t.prototype.waitForPendingWrites=function(){return this.ed(),this.nd.waitForPendingWrites()},t.prototype.onSnapshotsInSync=function(t){return this.ed(),xs(t)?Ls(this.nd,t):(Oi("Firestore.onSnapshotsInSync","function",1,t),Ls(this.nd,{next:t}))},t.prototype.ed=function(){return this.nd||this.fd(new As,{$f:!1}),this.nd},t.prototype.wd=function(){return new E(this.aa,this.rd,this.ad.host,this.ad.ssl,this.ad.forceLongPolling)},t.prototype.fd=function(t,e){var n=this.wd();return this.nd=new Ns(this.od,this.td),this.nd.start(n,t,e)},t.sd=function(t){if(!Object.prototype.hasOwnProperty.call(t.options,"projectId"))throw new P(x.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var e=t.options.projectId;if(!e||"string"!=typeof e)throw new P(x.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new T(e)},Object.defineProperty(t.prototype,"app",{get:function(){if(!this.Zf)throw new P(x.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Zf},enumerable:!1,configurable:!0}),t.prototype.collection=function(t){return Ei("Firestore.collection",arguments,1),Oi("Firestore.collection","non-empty string",1,t),this.ed(),new Ys(L.N(t),this,null)},t.prototype.doc=function(t){return Ei("Firestore.doc",arguments,1),Oi("Firestore.doc","non-empty string",1,t),this.ed(),Us.Td(L.N(t),this,null)},t.prototype.collectionGroup=function(t){if(Ei("Firestore.collectionGroup",arguments,1),Oi("Firestore.collectionGroup","non-empty string",1,t),t.indexOf("/")>=0)throw new P(x.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.ed(),new Ks(function(t){return new un(L.k(),t)}(t),this,null)},t.prototype.runTransaction=function(t){var e=this;return Ei("Firestore.runTransaction",arguments,1),Oi("Firestore.runTransaction","function",1,t),this.ed().transaction((function(n){return t(new Cs(e,n))}))},t.prototype.batch=function(){return this.ed(),new Rs(this)},Object.defineProperty(t,"logLevel",{get:function(){switch(f()){case s.LogLevel.DEBUG:return"debug";case s.LogLevel.ERROR:return"error";case s.LogLevel.SILENT:return"silent";case s.LogLevel.WARN:return"warn";case s.LogLevel.INFO:return"info";case s.LogLevel.VERBOSE:return"verbose";default:return"error"}},enumerable:!1,configurable:!0}),t.setLogLevel=function(t){Ei("Firestore.setLogLevel",arguments,1),Di("setLogLevel",["debug","error","silent","warn","info","verbose"],1,t),h.setLogLevel(t)},t.prototype.Ed=function(){return this.ad.timestampsInSnapshots},t}();function Ls(t,e){var n=new Ss({next:function(){e.next&&e.next()},error:function(t){throw y()}});return t.R_(n),function(){n.Wf(),t.P_(n)}}var Cs=function(){function t(t,e){this.Id=t,this.md=e}return t.prototype.get=function(t){var e=this;Ei("Transaction.get",arguments,1);var n=eu("Transaction.get",t,this.Id);return this.md.Au([n.ua]).then((function(t){if(!t||1!==t.length)return y();var r=t[0];if(r instanceof rn)return new Vs(e.Id,n.ua,null,!1,!1,n.ca);if(r instanceof nn)return new Vs(e.Id,n.ua,r,!1,!1,n.ca);throw y()}))},t.prototype.set=function(t,e,n){Ai("Transaction.set",arguments,2,3);var r=eu("Transaction.set",t,this.Id);n=Js("Transaction.set",n);var i=ru(r.ca,e,n),o=fo(this.Id.ud,"Transaction.set",r.ua,i,null!==r.ca,n);return this.md.set(r.ua,o),this},t.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return"string"==typeof e||e instanceof Wi?(Ti("Transaction.update",arguments,3),r=eu("Transaction.update",t,this.Id),i=po(this.Id.ud,"Transaction.update",r.ua,e,n,o)):(Ei("Transaction.update",arguments,2),r=eu("Transaction.update",t,this.Id),i=lo(this.Id.ud,"Transaction.update",r.ua,e)),this.md.update(r.ua,i),this},t.prototype.delete=function(t){Ei("Transaction.delete",arguments,1);var e=eu("Transaction.delete",t,this.Id);return this.md.delete(e.ua),this},t}(),Rs=function(){function t(t){this.Id=t,this.Ad=[],this.Rd=!1}return t.prototype.set=function(t,e,n){Ai("WriteBatch.set",arguments,2,3),this.Pd();var r=eu("WriteBatch.set",t,this.Id);n=Js("WriteBatch.set",n);var i=ru(r.ca,e,n),o=fo(this.Id.ud,"WriteBatch.set",r.ua,i,null!==r.ca,n);return this.Ad=this.Ad.concat(o.la(r.ua,Re.We())),this},t.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return this.Pd(),"string"==typeof e||e instanceof Wi?(Ti("WriteBatch.update",arguments,3),r=eu("WriteBatch.update",t,this.Id),i=po(this.Id.ud,"WriteBatch.update",r.ua,e,n,o)):(Ei("WriteBatch.update",arguments,2),r=eu("WriteBatch.update",t,this.Id),i=lo(this.Id.ud,"WriteBatch.update",r.ua,e)),this.Ad=this.Ad.concat(i.la(r.ua,Re.exists(!0))),this},t.prototype.delete=function(t){Ei("WriteBatch.delete",arguments,1),this.Pd();var e=eu("WriteBatch.delete",t,this.Id);return this.Ad=this.Ad.concat(new $e(e.ua,Re.We())),this},t.prototype.commit=function(){return this.Pd(),this.Rd=!0,this.Ad.length>0?this.Id.ed().write(this.Ad):Promise.resolve()},t.prototype.Pd=function(){if(this.Rd)throw new P(x.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},t}(),Us=function(t){function e(e,n,r){var i=this;return(i=t.call(this,n.aa,e,r)||this).ua=e,i.firestore=n,i.ca=r,i.nd=i.firestore.ed(),i}return i.__extends(e,t),e.Td=function(t,n,r){if(t.length%2!=0)throw new P(x.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.$()+" has "+t.length);return new e(new U(t),n,r)},Object.defineProperty(e.prototype,"id",{get:function(){return this.ua.path.S()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return new Ys(this.ua.path.p(),this.firestore,this.ca)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this.ua.path.$()},enumerable:!1,configurable:!0}),e.prototype.collection=function(t){if(Ei("DocumentReference.collection",arguments,1),Oi("DocumentReference.collection","non-empty string",1,t),!t)throw new P(x.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var e=L.N(t);return new Ys(this.ua.path.child(e),this.firestore,null)},e.prototype.isEqual=function(t){if(!(t instanceof e))throw Ui("isEqual","DocumentReference",1,t);return this.firestore===t.firestore&&this.ua.isEqual(t.ua)&&this.ca===t.ca},e.prototype.set=function(t,e){Ai("DocumentReference.set",arguments,1,2),e=Js("DocumentReference.set",e);var n=ru(this.ca,t,e),r=fo(this.firestore.ud,"DocumentReference.set",this.ua,n,null!==this.ca,e);return this.nd.write(r.la(this.ua,Re.We()))},e.prototype.update=function(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];return"string"==typeof t||t instanceof Wi?(Ti("DocumentReference.update",arguments,2),n=po(this.firestore.ud,"DocumentReference.update",this.ua,t,e,r)):(Ei("DocumentReference.update",arguments,1),n=lo(this.firestore.ud,"DocumentReference.update",this.ua,t)),this.nd.write(n.la(this.ua,Re.exists(!0)))},e.prototype.delete=function(){return Ei("DocumentReference.delete",arguments,0),this.nd.write([new $e(this.ua,Re.We())])},e.prototype.onSnapshot=function(){for(var t,e,n,r=this,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];Ai("DocumentReference.onSnapshot",arguments,1,4);var s={includeMetadataChanges:!1},u=0;"object"!=typeof i[u]||xs(i[u])||(Ri("DocumentReference.onSnapshot",s=i[u],["includeMetadataChanges"]),xi("DocumentReference.onSnapshot","boolean","includeMetadataChanges",s.includeMetadataChanges),u++);var a={includeMetadataChanges:s.includeMetadataChanges};if(xs(i[u])){var c=i[u];i[u]=null===(t=c.next)||void 0===t?void 0:t.bind(c),i[u+1]=null===(e=c.error)||void 0===e?void 0:e.bind(c),i[u+2]=null===(n=c.complete)||void 0===n?void 0:n.bind(c)}else Oi("DocumentReference.onSnapshot","function",u,i[u]),Ni("DocumentReference.onSnapshot","function",u+1,i[u+1]),Ni("DocumentReference.onSnapshot","function",u+2,i[u+2]);var h={next:function(t){i[u]&&i[u](r.gd(t))},error:i[u+1],complete:i[u+2]};return Ms(this.nd,this.ua,a,h)},e.prototype.get=function(t){var e=this;return Ai("DocumentReference.get",arguments,0,1),tu("DocumentReference.get",t),t&&"cache"===t.source?this.firestore.ed().qf(this.ua).then((function(t){return new Vs(e.firestore,e.ua,t,!0,t instanceof nn&&t.Ke,e.ca)})):function(t,e,n){var r=new zn,i=Ms(t,e,{includeMetadataChanges:!0,S_:!0},{next:function(t){i();var o=t.docs.has(e);!o&&t.fromCache?r.reject(new P(x.UNAVAILABLE,"Failed to get document because the client is offline.")):o&&t.fromCache&&n&&"server"===n.source?r.reject(new P(x.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):r.resolve(t)},error:function(t){return r.reject(t)}});return r.promise}(this.nd,this.ua,t).then((function(t){return e.gd(t)}))},e.prototype.withConverter=function(t){return new e(this.ua,this.firestore,t)},e.prototype.gd=function(t){var e=t.docs.get(this.ua);return new Vs(this.firestore,this.ua,e,t.fromCache,t.hasPendingWrites,this.ca)},e}(oo);function Ms(t,e,n,r){var i=function(t){console.error("Uncaught Error in onSnapshot:",t)};r.error&&(i=r.error.bind(r));var o=new Ss({next:function(t){r.next&&r.next(t)},error:i}),s=t.listen(cn(e.path),o,n);return function(){o.Wf(),t.ic(s)}}var Fs=function(){function t(t,e){this.hasPendingWrites=t,this.fromCache=e}return t.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},t}(),Vs=function(){function t(t,e,n,r,i,o){this.Id=t,this.ua=e,this.Vd=n,this.yd=r,this.pd=i,this.ca=o}return t.prototype.data=function(t){var e=this;if(Ai("DocumentSnapshot.data",arguments,0,1),t=Zs("DocumentSnapshot.data",t),this.Vd){if(this.ca){var n=new qs(this.Id,this.ua,this.Vd,this.yd,this.pd,null);return this.ca.fromFirestore(n,t)}return new Ps(this.Id.aa,this.Id.Ed(),t.serverTimestamps||"none",(function(t){return new Us(t,e.Id,null)})).Kf(this.Vd.Ze())}},t.prototype.get=function(t,e){var n=this;if(Ai("DocumentSnapshot.get",arguments,1,2),e=Zs("DocumentSnapshot.get",e),this.Vd){var r=this.Vd.data().field(wo("DocumentSnapshot.get",t,this.ua));if(null!==r)return new Ps(this.Id.aa,this.Id.Ed(),e.serverTimestamps||"none",(function(t){return new Us(t,n.Id,n.ca)})).Kf(r)}},Object.defineProperty(t.prototype,"id",{get:function(){return this.ua.path.S()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new Us(this.ua,this.Id,this.ca)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"exists",{get:function(){return null!==this.Vd},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return new Fs(this.pd,this.yd)},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){if(!(e instanceof t))throw Ui("isEqual","DocumentSnapshot",1,e);return this.Id===e.Id&&this.yd===e.yd&&this.ua.isEqual(e.ua)&&(null===this.Vd?null===e.Vd:this.Vd.isEqual(e.Vd))&&this.ca===e.ca},t}(),qs=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i.__extends(e,t),e.prototype.data=function(e){return t.prototype.data.call(this,e)},e}(Vs);function Bs(t,e,n,r,i,o,s){var u;if(i.O()){if("array-contains"===o||"array-contains-any"===o)throw new P(x.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o+"' queries on FieldPath.documentId().");if("in"===o){Ws(s,o);for(var a=[],c=0,h=s;c<h.length;c++)a.push(Gs(r,t,h[c]));u={arrayValue:{values:a}}}else u=Gs(r,t,s)}else"in"!==o&&"array-contains-any"!==o||Ws(s,o),u=yo(n,e,s,"in"===o);var f=_n.create(i,o,u);return function(t,e){if(e instanceof _n){var n=["array-contains","array-contains-any"],r=["in","array-contains-any"],i=n.indexOf(e.op)>=0,o=r.indexOf(e.op)>=0;if(e.ln()){var s=t.cn();if(null!==s&&!s.isEqual(e.field))throw new P(x.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+s.toString()+"' and '"+e.field.toString()+"'");var u=t.un();null!==u&&Qs(0,e.field,u)}else if(o||i){var a=null;if(o&&(a=t._n(r)),null===a&&i&&(a=t._n(n)),null!==a)throw new P(x.INVALID_ARGUMENT,a===e.op?"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter.":"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+a.toString()+"' filters.")}}}(t,f),f}function zs(t,e,n){if(null!==t.startAt)throw new P(x.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new P(x.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new Dn(e,n);return function(t,e){if(null===t.un()){var n=t.cn();null!==n&&Qs(0,n,e.field)}}(t,r),r}function Gs(t,e,n){if("string"==typeof n){if(""===n)throw new P(x.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!hn(e)&&-1!==n.indexOf("/"))throw new P(x.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=e.path.child(L.N(n));if(!U.W(r))throw new P(x.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return Mt(t,new U(r))}if(n instanceof oo)return Mt(t,n.ua);throw new P(x.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Li(n)+".")}function Ws(t,e){if(!Array.isArray(t)||0===t.length)throw new P(x.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(t.length>10)throw new P(x.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.");if(t.indexOf(null)>=0)throw new P(x.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'null' in the value array.");if(t.filter((function(t){return Number.isNaN(t)})).length>0)throw new P(x.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'NaN' in the value array.")}function Qs(t,e,n){if(!n.isEqual(e))throw new P(x.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function Hs(t){if(t.an()&&0===t.tn.length)throw new P(x.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Ks=function(){function t(t,e,n){this.bd=t,this.firestore=e,this.ca=n}return t.prototype.where=function(e,n,r){Ei("Query.where",arguments,3),Ci("Query.where",3,r);var i=Di("Query.where",["<","<=","==",">=",">","array-contains","in","array-contains-any"],2,n),o=wo("Query.where",e),s=Bs(this.bd,"Query.where",this.firestore.ud,this.firestore.aa,o,i,r);return new t(function(t,e){var n=t.filters.concat([e]);return new un(t.path,t.collectionGroup,t.tn.slice(),n,t.limit,t.en,t.startAt,t.endAt)}(this.bd,s),this.firestore,this.ca)},t.prototype.orderBy=function(e,n){var r;if(Ai("Query.orderBy",arguments,1,2),Ni("Query.orderBy","non-empty string",2,n),void 0===n||"asc"===n)r="asc";else{if("desc"!==n)throw new P(x.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+n+"', expected 'asc' or 'desc'.");r="desc"}var i=wo("Query.orderBy",e),o=zs(this.bd,i,r);return new t(function(t,e){var n=t.tn.concat([e]);return new un(t.path,t.collectionGroup,n,t.filters.slice(),t.limit,t.en,t.startAt,t.endAt)}(this.bd,o),this.firestore,this.ca)},t.prototype.limit=function(e){return Ei("Query.limit",arguments,1),Oi("Query.limit","number",1,e),Mi("Query.limit",1,e),new t(pn(this.bd,e,"F"),this.firestore,this.ca)},t.prototype.limitToLast=function(e){return Ei("Query.limitToLast",arguments,1),Oi("Query.limitToLast","number",1,e),Mi("Query.limitToLast",1,e),new t(pn(this.bd,e,"L"),this.firestore,this.ca)},t.prototype.startAt=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Ti("Query.startAt",arguments,1);var i=this.vd("Query.startAt",e,n,!0);return new t(dn(this.bd,i),this.firestore,this.ca)},t.prototype.startAfter=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Ti("Query.startAfter",arguments,1);var i=this.vd("Query.startAfter",e,n,!1);return new t(dn(this.bd,i),this.firestore,this.ca)},t.prototype.endBefore=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Ti("Query.endBefore",arguments,1);var i=this.vd("Query.endBefore",e,n,!0);return new t(yn(this.bd,i),this.firestore,this.ca)},t.prototype.endAt=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Ti("Query.endAt",arguments,1);var i=this.vd("Query.endAt",e,n,!1);return new t(yn(this.bd,i),this.firestore,this.ca)},t.prototype.isEqual=function(e){if(!(e instanceof t))throw Ui("isEqual","Query",1,e);return this.firestore===e.firestore&&vn(this.bd,e.bd)&&this.ca===e.ca},t.prototype.withConverter=function(e){return new t(this.bd,this.firestore,e)},t.prototype.vd=function(t,e,n,r){if(Ci(t,1,e),e instanceof Vs)return Ei(t,i.__spreadArrays([e],n),1),function(t,e,n,r,i){if(!r)throw new P(x.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+n+"().");for(var o=[],s=0,u=fn(t);s<u.length;s++){var a=u[s];if(a.field.O())o.push(Mt(e,r.key));else{var c=r.field(a.field);if(Ot(c))throw new P(x.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+a.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===c){var h=a.field.$();throw new P(x.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+h+"' (used as the orderBy) does not exist.")}o.push(c)}}return new Nn(o,i)}(this.bd,this.firestore.aa,t,e.Vd,r);var o=[e].concat(n);return function(t,e,n,r,i,o){var s=t.tn;if(i.length>s.length)throw new P(x.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var c=i[a];if(s[a].field.O()){if("string"!=typeof c)throw new P(x.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!hn(t)&&-1!==c.indexOf("/"))throw new P(x.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(L.N(c));if(!U.W(h))throw new P(x.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");var f=new U(h);u.push(Mt(e,f))}else{var l=yo(n,r,c);u.push(l)}}return new Nn(u,o)}(this.bd,this.firestore.aa,this.firestore.ud,t,o,r)},t.prototype.onSnapshot=function(){for(var t,e,n,r=this,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];Ai("Query.onSnapshot",arguments,1,4);var s={},u=0;if("object"!=typeof i[u]||xs(i[u])||(Ri("Query.onSnapshot",s=i[u],["includeMetadataChanges"]),xi("Query.onSnapshot","boolean","includeMetadataChanges",s.includeMetadataChanges),u++),xs(i[u])){var a=i[u];i[u]=null===(t=a.next)||void 0===t?void 0:t.bind(a),i[u+1]=null===(e=a.error)||void 0===e?void 0:e.bind(a),i[u+2]=null===(n=a.complete)||void 0===n?void 0:n.bind(a)}else Oi("Query.onSnapshot","function",u,i[u]),Ni("Query.onSnapshot","function",u+1,i[u+1]),Ni("Query.onSnapshot","function",u+2,i[u+2]);var c={next:function(t){i[u]&&i[u](new $s(r.firestore,r.bd,t,r.ca))},error:i[u+1],complete:i[u+2]};return Hs(this.bd),Xs(this.firestore.ed(),this.bd,s,c)},t.prototype.get=function(t){var e=this;Ai("Query.get",arguments,0,1),tu("Query.get",t),Hs(this.bd);var n=this.firestore.ed();return(t&&"cache"===t.source?n.Bf(this.bd):function(t,e,n){var r=new zn,i=Xs(t,e,{includeMetadataChanges:!0,S_:!0},{next:function(t){i(),t.fromCache&&n&&"server"===n.source?r.reject(new P(x.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):r.resolve(t)},error:function(t){return r.reject(t)}});return r.promise}(n,this.bd,t)).then((function(t){return new $s(e.firestore,e.bd,t,e.ca)}))},t}();function Xs(t,e,n,r){var i=function(t){console.error("Uncaught Error in onSnapshot:",t)};r.error&&(i=r.error.bind(r));var o=new Ss({next:function(t){r.next&&r.next(t)},error:i}),s=t.listen(e,o,n);return function(){o.Wf(),t.ic(s)}}var $s=function(){function t(t,e,n,r){this.Id=t,this.Sd=e,this.Dd=n,this.ca=r,this.Cd=null,this.Fd=null,this.metadata=new Fs(n.hasPendingWrites,n.fromCache)}return Object.defineProperty(t.prototype,"docs",{get:function(){var t=[];return this.forEach((function(e){return t.push(e)})),t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return this.Dd.docs._()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this.Dd.docs.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t,e){var n=this;Ai("QuerySnapshot.forEach",arguments,1,2),Oi("QuerySnapshot.forEach","function",1,t),this.Dd.docs.forEach((function(r){t.call(e,n.$d(r,n.metadata.fromCache,n.Dd.Lt.has(r.key)))}))},Object.defineProperty(t.prototype,"query",{get:function(){return new Ks(this.Sd,this.Id,this.ca)},enumerable:!1,configurable:!0}),t.prototype.docChanges=function(t){t&&(Ri("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),xi("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges));var e=!(!t||!t.includeMetadataChanges);if(e&&this.Dd.Bt)throw new P(x.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.Cd&&this.Fd===e||(this.Cd=function(t,e,n){if(t.Ot._()){var r=0;return t.docChanges.map((function(e){return{type:"added",doc:n(e.doc,t.fromCache,t.Lt.has(e.doc.key)),oldIndex:-1,newIndex:r++}}))}var i=t.Ot;return t.docChanges.filter((function(t){return e||3!==t.type})).map((function(e){var r=n(e.doc,t.fromCache,t.Lt.has(e.doc.key)),o=-1,s=-1;return 0!==e.type&&(o=i.indexOf(e.doc.key),i=i.delete(e.doc.key)),1!==e.type&&(s=(i=i.add(e.doc)).indexOf(e.doc.key)),{type:nu(e.type),doc:r,oldIndex:o,newIndex:s}}))}(this.Dd,e,this.$d.bind(this)),this.Fd=e),this.Cd},t.prototype.isEqual=function(e){if(!(e instanceof t))throw Ui("isEqual","QuerySnapshot",1,e);return this.Id===e.Id&&vn(this.Sd,e.Sd)&&this.Dd.isEqual(e.Dd)&&this.ca===e.ca},t.prototype.$d=function(t,e,n){return new qs(this.Id,t.key,t,e,n,this.ca)},t}(),Ys=function(t){function e(e,n,r){var i=this;if((i=t.call(this,cn(e),n,r)||this).Nd=e,e.length%2!=1)throw new P(x.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+e.$()+" has "+e.length);return i}return i.__extends(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this.bd.path.S()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this.bd.path.p();return t._()?null:new Us(new U(t),this.firestore,null)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this.bd.path.$()},enumerable:!1,configurable:!0}),e.prototype.doc=function(t){Ai("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=m.t()),Oi("CollectionReference.doc","non-empty string",1,t);var e=L.N(t);return Us.Td(this.bd.path.child(e),this.firestore,this.ca)},e.prototype.add=function(t){Ei("CollectionReference.add",arguments,1),Oi("CollectionReference.add","object",1,this.ca?this.ca.toFirestore(t):t);var e=this.doc();return e.set(t).then((function(){return e}))},e.prototype.withConverter=function(t){return new e(this.Nd,this.firestore,t)},e}(Ks);function Js(t,e){if(void 0===e)return{merge:!1};if(Ri(t,e,["merge","mergeFields"]),xi(t,"boolean","merge",e.merge),function(t,e,n,r,i){void 0!==r&&function(t,e,n,r,i){if(!(r instanceof Array))throw new P(x.INVALID_ARGUMENT,"Function "+t+"() requires its "+e+" option to be an array, but it was: "+Li(r));for(var o=0;o<r.length;++o)if(!i(r[o]))throw new P(x.INVALID_ARGUMENT,"Function "+t+"() requires all "+e+" elements to be a string or a FieldPath, but the value at index "+o+" was: "+Li(r[o]))}(t,"mergeFields",0,r,(function(t){return"string"==typeof t||t instanceof Wi}))}(t,0,0,e.mergeFields),void 0!==e.mergeFields&&void 0!==e.merge)throw new P(x.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function Zs(t,e){return void 0===e?{}:(Ri(t,e,["serverTimestamps"]),Pi(t,0,"serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function tu(t,e){Ni(t,"object",1,e),e&&(Ri(t,e,["source"]),Pi(t,0,"source",e.source,["default","server","cache"]))}function eu(t,e,n){if(e instanceof oo){if(e.firestore!==n)throw new P(x.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw Ui(t,"DocumentReference",1,e)}function nu(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return y()}}function ru(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var iu={Firestore:js,GeoPoint:no,Timestamp:D,Blob:zi,Transaction:Cs,WriteBatch:Rs,DocumentReference:Us,DocumentSnapshot:Vs,Query:Ks,QueryDocumentSnapshot:qs,QuerySnapshot:$s,CollectionReference:Ys,FieldPath:Wi,FieldValue:to,setLogLevel:js.setLogLevel,CACHE_SIZE_UNLIMITED:Ds};function ou(t){!function(t,e){t.INTERNAL.registerComponent(new c.Component("firestore",(function(t){return function(t,e){return new js(t,e,new Os)}(t.getProvider("app").getImmediate(),t.getProvider("auth-internal"))}),"PUBLIC").setServiceProps(Object.assign({},iu)))}(t),t.registerVersion("@firebase/firestore","1.16.2")}ou(o),e.__PRIVATE_registerFirestore=ou},"7Hc7":function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));let r=1;const i=(()=>Promise.resolve())(),o={};function s(t){return t in o&&(delete o[t],!0)}const u={setImmediate(t){const e=r++;return o[e]=!0,i.then(()=>s(e)&&t()),e},clearImmediate(t){s(t)}};var a=n("3N8a");class c extends a.a{constructor(t,e){super(t,e),this.scheduler=t,this.work=e}requestAsyncId(t,e,n=0){return null!==n&&n>0?super.requestAsyncId(t,e,n):(t.actions.push(this),t.scheduled||(t.scheduled=u.setImmediate(t.flush.bind(t,null))))}recycleAsyncId(t,e,n=0){if(null!==n&&n>0||null===n&&this.delay>0)return super.recycleAsyncId(t,e,n);0===t.actions.length&&(u.clearImmediate(e),t.scheduled=void 0)}}var h=n("IjjT");class f extends h.a{flush(t){this.active=!0,this.scheduled=void 0;const{actions:e}=this;let n,r=-1,i=e.length;t=t||e.shift();do{if(n=t.execute(t.state,t.delay))break}while(++r<i&&(t=e.shift()));if(this.active=!1,n){for(;++r<i&&(t=e.shift());)t.unsubscribe();throw n}}}const l=new f(c)},FpXt:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n("ofXK"),i=n("fXoL");let o=(()=>{class t{}return t.\u0275mod=i.Jb({type:t}),t.\u0275inj=i.Ib({factory:function(e){return new(e||t)},imports:[[r.c]]}),t})()},"S+S0":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("Tr+X"),i=n("zVF4"),o=function(){function t(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}return t.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},t.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},t.prototype.setServiceProps=function(t){return this.serviceProps=t,this},t}(),s=function(){function t(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map}return t.prototype.get=function(t){void 0===t&&(t="[DEFAULT]");var e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){var n=new i.Deferred;this.instancesDeferred.set(e,n);try{var r=this.getOrInitializeService(e);r&&n.resolve(r)}catch(o){}}return this.instancesDeferred.get(e).promise},t.prototype.getImmediate=function(t){var e=r.__assign({identifier:"[DEFAULT]",optional:!1},t),n=e.optional,i=this.normalizeInstanceIdentifier(e.identifier);try{var o=this.getOrInitializeService(i);if(!o){if(n)return null;throw Error("Service "+this.name+" is not available")}return o}catch(s){if(n)return null;throw s}},t.prototype.getComponent=function(){return this.component},t.prototype.setComponent=function(t){var e,n;if(t.name!==this.name)throw Error("Mismatching Component "+t.name+" for Provider "+this.name+".");if(this.component)throw Error("Component for "+this.name+" has already been provided");if(this.component=t,function(t){return"EAGER"===t.instantiationMode}(t))try{this.getOrInitializeService("[DEFAULT]")}catch(h){}try{for(var i=r.__values(this.instancesDeferred.entries()),o=i.next();!o.done;o=i.next()){var s=r.__read(o.value,2),u=s[1],a=this.normalizeInstanceIdentifier(s[0]);try{var c=this.getOrInitializeService(a);u.resolve(c)}catch(h){}}}catch(f){e={error:f}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}},t.prototype.clearInstance=function(t){void 0===t&&(t="[DEFAULT]"),this.instancesDeferred.delete(t),this.instances.delete(t)},t.prototype.delete=function(){return r.__awaiter(this,void 0,void 0,(function(){var t;return r.__generator(this,(function(e){switch(e.label){case 0:return t=Array.from(this.instances.values()),[4,Promise.all(t.filter((function(t){return"INTERNAL"in t})).map((function(t){return t.INTERNAL.delete()})))];case 1:return e.sent(),[2]}}))}))},t.prototype.isComponentSet=function(){return null!=this.component},t.prototype.getOrInitializeService=function(t){var e=this.instances.get(t);return!e&&this.component&&(e=this.component.instanceFactory(this.container,function(t){return"[DEFAULT]"===t?void 0:t}(t)),this.instances.set(t,e)),e||null},t.prototype.normalizeInstanceIdentifier=function(t){return this.component?this.component.multipleInstances?t:"[DEFAULT]":t},t}(),u=function(){function t(t){this.name=t,this.providers=new Map}return t.prototype.addComponent=function(t){var e=this.getProvider(t.name);if(e.isComponentSet())throw new Error("Component "+t.name+" has already been registered with "+this.name);e.setComponent(t)},t.prototype.addOrOverwriteComponent=function(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)},t.prototype.getProvider=function(t){if(this.providers.has(t))return this.providers.get(t);var e=new s(t,this);return this.providers.set(t,e),e},t.prototype.getProviders=function(){return Array.from(this.providers.values())},t}();e.Component=o,e.ComponentContainer=u,e.Provider=s},"Tr+X":function(t,e,n){"use strict";n.r(e),n.d(e,"__extends",(function(){return i})),n.d(e,"__assign",(function(){return o})),n.d(e,"__rest",(function(){return s})),n.d(e,"__decorate",(function(){return u})),n.d(e,"__param",(function(){return a})),n.d(e,"__metadata",(function(){return c})),n.d(e,"__awaiter",(function(){return h})),n.d(e,"__generator",(function(){return f})),n.d(e,"__createBinding",(function(){return l})),n.d(e,"__exportStar",(function(){return p})),n.d(e,"__values",(function(){return d})),n.d(e,"__read",(function(){return y})),n.d(e,"__spread",(function(){return v})),n.d(e,"__spreadArrays",(function(){return g})),n.d(e,"__await",(function(){return b})),n.d(e,"__asyncGenerator",(function(){return m})),n.d(e,"__asyncDelegator",(function(){return w})),n.d(e,"__asyncValues",(function(){return _})),n.d(e,"__makeTemplateObject",(function(){return I})),n.d(e,"__importStar",(function(){return E})),n.d(e,"__importDefault",(function(){return T})),n.d(e,"__classPrivateFieldGet",(function(){return A})),n.d(e,"__classPrivateFieldSet",(function(){return O}));var r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function i(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var o=function(){return(o=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function s(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n}function u(t,e,n,r){var i,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,r);else for(var u=t.length-1;u>=0;u--)(i=t[u])&&(s=(o<3?i(s):o>3?i(e,n,s):i(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s}function a(t,e){return function(n,r){e(n,r,t)}}function c(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}function h(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{a(r.next(t))}catch(e){o(e)}}function u(t){try{a(r.throw(t))}catch(e){o(e)}}function a(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,u)}a((r=r.apply(t,e||[])).next())}))}function f(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(u){o=[6,u],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}}function l(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}function p(t,e){for(var n in t)"default"===n||e.hasOwnProperty(n)||(e[n]=t[n])}function d(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function y(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(u){i={error:u}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s}function v(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(y(arguments[e]));return t}function g(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function b(t){return this instanceof b?(this.v=t,this):new b(t)}function m(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(t,e||[]),o=[];return r={},s("next"),s("throw"),s("return"),r[Symbol.asyncIterator]=function(){return this},r;function s(t){i[t]&&(r[t]=function(e){return new Promise((function(n,r){o.push([t,e,n,r])>1||u(t,e)}))})}function u(t,e){try{(n=i[t](e)).value instanceof b?Promise.resolve(n.value.v).then(a,c):h(o[0][2],n)}catch(r){h(o[0][3],r)}var n}function a(t){u("next",t)}function c(t){u("throw",t)}function h(t,e){t(e),o.shift(),o.length&&u(o[0][0],o[0][1])}}function w(t){var e,n;return e={},r("next"),r("throw",(function(t){throw t})),r("return"),e[Symbol.iterator]=function(){return this},e;function r(r,i){e[r]=t[r]?function(e){return(n=!n)?{value:b(t[r](e)),done:"return"===r}:i?i(e):e}:i}}function _(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,n=t[Symbol.asyncIterator];return n?n.call(t):(t=d(t),e={},r("next"),r("throw"),r("return"),e[Symbol.asyncIterator]=function(){return this},e);function r(n){e[n]=t[n]&&function(e){return new Promise((function(r,i){!function(t,e,n,r){Promise.resolve(r).then((function(e){t({value:e,done:n})}),e)}(r,i,(e=t[n](e)).done,e.value)}))}}}function I(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function E(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function T(t){return t&&t.__esModule?t:{default:t}}function A(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function O(t,e,n){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,n),n}},UXun:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n("jtHE");function i(t,e,n){let i;return i=t&&"object"==typeof t?t:{bufferSize:t,windowTime:e,refCount:!1,scheduler:n},t=>t.lift(function({bufferSize:t=Number.POSITIVE_INFINITY,windowTime:e=Number.POSITIVE_INFINITY,refCount:n,scheduler:i}){let o,s,u=0,a=!1,c=!1;return function(h){u++,o&&!a||(a=!1,o=new r.a(t,e,i),s=h.subscribe({next(t){o.next(t)},error(t){a=!0,o.error(t)},complete(){c=!0,s=void 0,o.complete()}}));const f=o.subscribe(this);this.add(()=>{u--,f.unsubscribe(),s&&!c&&n&&0===u&&(s.unsubscribe(),s=void 0,o=void 0)})}}(i))}},Wcq6:function(t,e,n){"use strict";var r,i=(r=n("wj3C"))&&"object"==typeof r&&"default"in r?r.default:r;i.registerVersion("firebase","7.17.1","app"),t.exports=i},Y7HM:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n("DH7j");function i(t){return!Object(r.a)(t)&&t-parseFloat(t)+1>=0}},Zy1z:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n("7o/Q");function i(){return t=>t.lift(new o)}class o{call(t,e){return e.subscribe(new s(t))}}class s extends r.a{constructor(t){super(t),this.hasPrev=!1}_next(t){let e;this.hasPrev?e=[this.prev,t]:this.hasPrev=!0,this.prev=t,e&&this.destination.next(e)}}},ebwL:function(t,e,n){"use strict";n.r(e),n.d(e,"MainModule",(function(){return tn}));var r=n("ofXK"),i=n("tyNb"),o=n("Tr+X"),s=n("fXoL"),u=n("LRne"),a=n("EY2u"),c=n("HDdC"),h=n("Cfvw"),f=n("pxpQ"),l=n("eIep"),p=n("lJxs"),d=n("vkgz"),y=n("UXun"),v=n("pLZG"),g=n("l7GE"),b=n("ZUHj");function m(...t){return e=>{let n;return"function"==typeof t[t.length-1]&&(n=t.pop()),e.lift(new w(t,n))}}class w{constructor(t,e){this.observables=t,this.project=e}call(t,e){return e.subscribe(new _(t,this.observables,this.project))}}class _ extends g.a{constructor(t,e,n){super(t),this.observables=e,this.project=n,this.toRespond=[];const r=e.length;this.values=new Array(r);for(let i=0;i<r;i++)this.toRespond.push(i);for(let i=0;i<r;i++){let t=e[i];this.add(Object(b.a)(this,t,t,i))}}notifyNext(t,e,n,r,i){this.values[n]=e;const o=this.toRespond;if(o.length>0){const t=o.indexOf(n);-1!==t&&o.splice(t,1)}}notifyComplete(){}_next(t){if(0===this.toRespond.length){const e=[t,...this.values];this.project?this._tryProject(e):this.destination.next(e)}}_tryProject(t){let e;try{e=this.project.apply(this,t)}catch(n){return void this.destination.error(n)}this.destination.next(e)}}var I=n("7o/Q"),E=n("quSY"),T=n("XNiG");class A{constructor(t,e,n,r){this.keySelector=t,this.elementSelector=e,this.durationSelector=n,this.subjectSelector=r}call(t,e){return e.subscribe(new O(t,this.keySelector,this.elementSelector,this.durationSelector,this.subjectSelector))}}class O extends I.a{constructor(t,e,n,r,i){super(t),this.keySelector=e,this.elementSelector=n,this.durationSelector=r,this.subjectSelector=i,this.groups=null,this.attemptedToUnsubscribe=!1,this.count=0}_next(t){let e;try{e=this.keySelector(t)}catch(n){return void this.error(n)}this._group(t,e)}_group(t,e){let n=this.groups;n||(n=this.groups=new Map);let r,i=n.get(e);if(this.elementSelector)try{r=this.elementSelector(t)}catch(o){this.error(o)}else r=t;if(!i){i=this.subjectSelector?this.subjectSelector():new T.a,n.set(e,i);const t=new S(e,i,this);if(this.destination.next(t),this.durationSelector){let t;try{t=this.durationSelector(new S(e,i))}catch(o){return void this.error(o)}this.add(t.subscribe(new N(e,i,this)))}}i.closed||i.next(r)}_error(t){const e=this.groups;e&&(e.forEach((e,n)=>{e.error(t)}),e.clear()),this.destination.error(t)}_complete(){const t=this.groups;t&&(t.forEach((t,e)=>{t.complete()}),t.clear()),this.destination.complete()}removeGroup(t){this.groups.delete(t)}unsubscribe(){this.closed||(this.attemptedToUnsubscribe=!0,0===this.count&&super.unsubscribe())}}class N extends I.a{constructor(t,e,n){super(e),this.key=t,this.group=e,this.parent=n}_next(t){this.complete()}_unsubscribe(){const{parent:t,key:e}=this;this.key=this.parent=null,t&&t.removeGroup(e)}}class S extends c.a{constructor(t,e,n){super(),this.key=t,this.groupSubject=e,this.refCountSubscription=n}_subscribe(t){const e=new E.a,{refCountSubscription:n,groupSubject:r}=this;return n&&!n.closed&&e.add(new x(n)),e.add(r.subscribe(t)),e}}class x extends E.a{constructor(t){super(),this.parent=t,t.count++}unsubscribe(){const t=this.parent;t.closed||this.closed||(super.unsubscribe(),t.count-=1,0===t.count&&t.attemptedToUnsubscribe&&t.unsubscribe())}}var P=n("5+tZ"),D=n("JX91"),k=n("Zy1z"),j=n("qgXg"),L=n("D0XW"),C=n("7Hc7"),R=n("Y7HM");class U extends c.a{constructor(t,e=0,n=C.a){super(),this.source=t,this.delayTime=e,this.scheduler=n,(!Object(R.a)(e)||e<0)&&(this.delayTime=0),n&&"function"==typeof n.schedule||(this.scheduler=C.a)}static create(t,e=0,n=C.a){return new U(t,e,n)}static dispatch(t){const{source:e,subscriber:n}=t;return this.add(e.subscribe(n))}_subscribe(t){return this.scheduler.schedule(U.dispatch,this.delayTime,{source:this.source,subscriber:t})}}class M{constructor(t,e){this.scheduler=t,this.delay=e}call(t,e){return new U(e,this.delay,this.scheduler).subscribe(t)}}var F=n("Wcq6");function V(){}class q{constructor(t,e=j.a){this.zone=t,this.delegate=e}now(){return this.delegate.now()}schedule(t,e,n){const r=this.zone;return this.delegate.schedule((function(e){r.runGuarded(()=>{t.apply(this,[e])})}),e,n)}}class B{constructor(t){this.zone=t,this.task=null}call(t,e){const n=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",V,{},V,V)),e.pipe(Object(d.a)({next:n,complete:n,error:n})).subscribe(t).add(n)}unscheduleTask(){setTimeout(()=>{null!=this.task&&"scheduled"===this.task.state&&(this.task.invoke(),this.task=null)},10)}}class z{constructor(t){this.ngZone=t,this.outsideAngular=t.runOutsideAngular(()=>new q(Zone.current)),this.insideAngular=t.run(()=>new q(Zone.current,L.a))}}const G=["ngOnDestroy"],W=new s.q("angularfire2.app.options"),Q=new s.q("angularfire2.app.nameOrConfig"),H=new s.P("6.0.2");function K(t,e,n){const r="object"==typeof n&&n||{};return r.name=r.name||"string"==typeof n&&n||"[DEFAULT]",F.apps.filter(t=>t&&t.name===r.name)[0]||e.runOutsideAngular(()=>Object(F.initializeApp)(t,r))}const X={provide:class{},useFactory:K,deps:[W,s.z,[new s.A,Q]]};let $=(()=>{class t{constructor(t){Object(F.registerVersion)("angularfire",H.full,t.toString()),Object(F.registerVersion)("angular",s.O.full)}static initializeApp(e,n){return{ngModule:t,providers:[{provide:W,useValue:e},{provide:Q,useValue:n}]}}}return t.\u0275mod=s.Jb({type:t}),t.\u0275inj=s.Ib({factory:function(e){return new(e||t)(s.Ub(s.B))},providers:[X]}),t})();var Y=n("jhN1");const J=new s.q("angularfire2.analytics.analyticsCollectionEnabled"),Z=new s.q("angularfire2.analytics.appVersion"),tt=new s.q("angularfire2.analytics.appName"),et=new s.q("angularfire2.analytics.debugMode"),nt=new s.q("angularfire2.analytics.config");let rt,it;const ot={};let st=(()=>{class t{constructor(t,e,i,o,s,c,h,v,g){this.options=t,it||(Object(r.r)(v)?(rt=window.gtag||((...t)=>{window.dataLayer.push(t)}),window.dataLayer=window.dataLayer||[],it=g.runOutsideAngular(()=>new Promise(t=>{window.gtag=(...e)=>{"js"===e[0]&&t(),rt(...e)}}))):(rt=()=>{},it=Promise.resolve()));let b=ot[t.measurementId];return b||(b=Object(u.a)(void 0).pipe(Object(f.b)(new z(g).outsideAngular),Object(l.a)(()=>Object(r.r)(v)?n.e(5).then(n.bind(null,"AAub")):a.a),Object(p.a)(()=>K(t,g,e)),Object(p.a)(t=>t.analytics()),Object(d.a)(t=>{!1===i&&t.setAnalyticsCollectionEnabled(!1)}),Object(y.a)({bufferSize:1,refCount:!1})),ot[t.measurementId]=b),h&&this.updateConfig(h),s&&this.updateConfig({app_name:s}),o&&this.updateConfig({app_version:o}),c&&this.updateConfig({debug_mode:1}),((t,e,n)=>new Proxy(t,{get:(r,i)=>n.runOutsideAngular(()=>{if(t[i])return t[i];if(G.includes(i))return()=>{};const r=e.toPromise().then(t=>{const e=t&&t[i];return"function"==typeof e?e.bind(t):e&&e.then?e.then(t=>n.run(()=>t)):n.run(()=>e)});return new Proxy(()=>{},{get:(t,e)=>r[e],apply:(t,e,n)=>r.then(t=>t&&t(...n))})})}))(this,b,g)}updateConfig(t){return Object(o.__awaiter)(this,void 0,void 0,(function*(){yield it,rt("config",this.options.measurementId,Object.assign(Object.assign({},t),{update:!0}))}))}}return t.\u0275fac=function(e){return new(e||t)(s.Ub(W),s.Ub(Q,8),s.Ub(J,8),s.Ub(Z,8),s.Ub(tt,8),s.Ub(et,8),s.Ub(nt,8),s.Ub(s.B),s.Ub(s.z))},t.\u0275prov=Object(s.Hb)({factory:function(){return new t(Object(s.Ub)(W),Object(s.Ub)(Q,8),Object(s.Ub)(J,8),Object(s.Ub)(Z,8),Object(s.Ub)(tt,8),Object(s.Ub)(et,8),Object(s.Ub)(nt,8),Object(s.Ub)(s.B),Object(s.Ub)(s.z))},token:t,providedIn:"any"}),t})(),ut=Math.floor(Math.random()*(Math.pow(2,32)-1))-Math.pow(2,31);const at={},ct=t=>{const e=[t.screen_class,t.outlet].join("#");if(at.hasOwnProperty(e))return at[e];{const t=ut++;return at[e]=t,t}};let ht=(()=>{class t{constructor(t,e,n,o,a,f,y,g){if(!e||!Object(r.r)(a))return this;y.runOutsideAngular(()=>{const r=e.events.pipe(Object(v.a)(t=>t instanceof i.a)),a=e.events.pipe(Object(v.a)(t=>t instanceof i.b));var b;this.disposable=a.pipe(m(r),Object(l.a)(([t,e])=>{const r=t.url,a=e.snapshot.routeConfig&&e.snapshot.routeConfig.path||r,f={screen_name:a,page_path:r,firebase_event_origin:"auto",firebase_screen:a,outlet:e.snapshot.outlet};n&&(f.page_title=n.getTitle());const l=e.snapshot.component,d=e.snapshot.routeConfig,y=d&&d.loadChildren;if("string"==typeof y)return Object(u.a)(Object.assign(Object.assign({},f),{screen_class:y.split("#")[1]}));if("string"==typeof l)return Object(u.a)(Object.assign(Object.assign({},f),{screen_class:l}));if(l){const t=o.resolveComponentFactory(l);return Object(u.a)(Object.assign(Object.assign({},f),{screen_class:t.selector}))}if(y){const t=y();return(t instanceof c.a?t:Object(h.a)(Promise.resolve(t))).pipe(Object(p.a)(t=>{if(!(t instanceof s.v)){const e=[].concat.apply([],(t.__annotations__||[]).map(t=>t.declarations)),n=[].concat.apply([],e.map(t=>(t.__annotations__||[]).map(t=>t.selector)));return Object.assign(Object.assign({},f),{screen_class:n[0]||"???"})}{const n=t.create(g),r=n.injector.get(i.c)[0][0].component;try{const t=n.componentFactoryResolver.resolveComponentFactory(r);return Object.assign(Object.assign({},f),{screen_class:t.selector})}catch(e){return Object.assign(Object.assign({},f),{screen_class:"???"})}}}))}return Object(u.a)(Object.assign(Object.assign({},f),{screen_class:"???"}))}),Object(p.a)(t=>Object.assign({firebase_screen_class:t.screen_class,firebase_screen_id:ct(t)},t)),Object(d.a)(e=>{"primary"===e.outlet&&(t.setCurrentScreen(e.screen_name),t.updateConfig({page_path:e.page_path,screen_class:e.screen_class}),n&&t.updateConfig({page_title:e.page_title}))}),(b=t=>t.outlet,t=>t.lift(new A(b,void 0,void 0,void 0))),Object(P.a)(t=>t.pipe(Object(D.a)(void 0),Object(k.a)())),Object(p.a)(([t,e])=>t?Object.assign({firebase_previous_class:t.screen_class,firebase_previous_screen:t.screen_name,firebase_previous_id:t.firebase_screen_id},e):e),Object(d.a)(t=>f&&console.info("screen_view",t)),Object(d.a)(e=>y.runOutsideAngular(()=>t.logEvent("screen_view",e)))).subscribe()})}ngOnDestroy(){this.disposable&&this.disposable.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(s.Ub(st),s.Ub(i.d,8),s.Ub(Y.c,8),s.Ub(s.j),s.Ub(s.B),s.Ub(et,8),s.Ub(s.z),s.Ub(s.r))},t.\u0275prov=Object(s.Hb)({factory:function(){return new t(Object(s.Ub)(st),Object(s.Ub)(i.d,8),Object(s.Ub)(Y.c,8),Object(s.Ub)(s.j),Object(s.Ub)(s.B),Object(s.Ub)(et,8),Object(s.Ub)(s.z),Object(s.Ub)(s.o))},token:t,providedIn:"any"}),t})(),ft=(()=>{class t{constructor(t,e,i){const o=new z(e);Object(r.s)(i)||e.runOutsideAngular(()=>{this.disposable=Object(h.a)(n.e(6).then(n.bind(null,"6nsN"))).pipe(Object(f.b)(o.outsideAngular),Object(l.a)(()=>t.app),Object(p.a)(t=>t.auth()),Object(l.a)(t=>new c.a(t.onAuthStateChanged.bind(t))),Object(l.a)(e=>t.setUserId(e?e.uid:null))).subscribe()})}ngOnDestroy(){this.disposable&&this.disposable.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(s.Ub(st),s.Ub(s.z),s.Ub(s.B))},t.\u0275prov=Object(s.Hb)({factory:function(){return new t(Object(s.Ub)(st),Object(s.Ub)(s.z),Object(s.Ub)(s.B))},token:t,providedIn:"any"}),t})(),lt=(()=>{class t{constructor(t,e,n){}}return t.\u0275mod=s.Jb({type:t}),t.\u0275inj=s.Ib({factory:function(e){return new(e||t)(s.Ub(st),s.Ub(ht,8),s.Ub(ft,8))},providers:[st]}),t})();var pt=n("Kqap"),dt=n("wj3C"),yt=n.n(dt),vt=n("6Joi");function gt(t,e){return function(t,e=L.a){return new c.a(n=>{let r;return null!=e?e.schedule(()=>{r=t.onSnapshot(n)}):r=t.onSnapshot(n),()=>{null!=r&&r()}})}(t,e)}function bt(t,e){return gt(t,e).pipe(Object(p.a)(t=>({payload:t,type:"query"})))}function mt(t,e){return bt(t,e).pipe(Object(p.a)(t=>t.payload.docChanges().map(t=>({type:t.type,payload:t}))))}function wt(t,e,n){return bt(t,n).pipe(Object(p.a)(t=>t.payload.docChanges()),Object(pt.a)((t,n)=>function(t,e,n){return e.forEach(e=>{n.indexOf(e.type)>-1&&(t=function(t,e){switch(e.type){case"added":t[e.newIndex]&&t[e.newIndex].doc.ref.isEqual(e.doc.ref)||t.splice(e.newIndex,0,e);break;case"modified":(null==t[e.oldIndex]||t[e.oldIndex].doc.ref.isEqual(e.doc.ref))&&(e.oldIndex!==e.newIndex?(t.splice(e.oldIndex,1),t.splice(e.newIndex,0,e)):t.splice(e.newIndex,1,e));break;case"removed":t[e.oldIndex]&&t[e.oldIndex].doc.ref.isEqual(e.doc.ref)&&t.splice(e.oldIndex,1)}return t}(t,e))}),t}(t,n,e),[]),Object(p.a)(t=>t.map(t=>({type:t.type,payload:t}))))}function _t(t){return t&&0!==t.length||(t=["added","removed","modified"]),t}class It{constructor(t,e,n){this.ref=t,this.query=e,this.afs=n}stateChanges(t){return t&&0!==t.length?mt(this.query,this.afs.schedulers.outsideAngular).pipe(Object(p.a)(e=>e.filter(e=>t.indexOf(e.type)>-1)),Object(v.a)(t=>t.length>0),this.afs.keepUnstableUntilFirst):mt(this.query,this.afs.schedulers.outsideAngular).pipe(this.afs.keepUnstableUntilFirst)}auditTrail(t){return this.stateChanges(t).pipe(Object(pt.a)((t,e)=>[...t,...e],[]))}snapshotChanges(t){const e=_t(t);return wt(this.query,e,this.afs.schedulers.outsideAngular).pipe(this.afs.keepUnstableUntilFirst)}valueChanges(t={}){return bt(this.query,this.afs.schedulers.outsideAngular).pipe(Object(p.a)(e=>e.payload.docs.map(e=>t.idField?Object.assign(Object.assign({},e.data()),{[t.idField]:e.id}):e.data())),this.afs.keepUnstableUntilFirst)}get(t){return Object(h.a)(this.query.get(t)).pipe(Object(f.b)(this.afs.schedulers.insideAngular))}add(t){return this.ref.add(t)}doc(t){return new Et(this.ref.doc(t),this.afs)}}class Et{constructor(t,e){this.ref=t,this.afs=e}set(t,e){return this.ref.set(t,e)}update(t){return this.ref.update(t)}delete(){return this.ref.delete()}collection(t,e){const n=this.ref.collection(t),{ref:r,query:i}=St(n,e);return new It(r,i,this.afs)}snapshotChanges(){return gt(this.ref,this.afs.schedulers.outsideAngular).pipe(Object(p.a)(t=>({payload:t,type:"value"}))).pipe(this.afs.keepUnstableUntilFirst)}valueChanges(){return this.snapshotChanges().pipe(Object(p.a)(t=>t.payload.data()))}get(t){return Object(h.a)(this.ref.get(t)).pipe(Object(f.b)(this.afs.schedulers.insideAngular))}}class Tt{constructor(t,e){this.query=t,this.afs=e}stateChanges(t){return t&&0!==t.length?mt(this.query,this.afs.schedulers.outsideAngular).pipe(Object(p.a)(e=>e.filter(e=>t.indexOf(e.type)>-1)),Object(v.a)(t=>t.length>0),this.afs.keepUnstableUntilFirst):mt(this.query,this.afs.schedulers.outsideAngular).pipe(this.afs.keepUnstableUntilFirst)}auditTrail(t){return this.stateChanges(t).pipe(Object(pt.a)((t,e)=>[...t,...e],[]))}snapshotChanges(t){const e=_t(t);return wt(this.query,e,this.afs.schedulers.outsideAngular).pipe(this.afs.keepUnstableUntilFirst)}valueChanges(){return bt(this.query,this.afs.schedulers.outsideAngular).pipe(Object(p.a)(t=>t.payload.docs.map(t=>t.data())),this.afs.keepUnstableUntilFirst)}get(t){return Object(h.a)(this.query.get(t)).pipe(Object(f.b)(this.afs.schedulers.insideAngular))}}const At=new s.q("angularfire2.enableFirestorePersistence"),Ot=new s.q("angularfire2.firestore.persistenceSettings"),Nt=new s.q("angularfire2.firestore.settings");function St(t,e=(t=>t)){return{query:e(t),ref:t}}let xt=(()=>{class t{constructor(t,e,n,i,o,s,a){var c;this.schedulers=new z(s),this.keepUnstableUntilFirst=(c=this.schedulers,function(t){return(t=t.lift(new B(c.ngZone))).pipe(function(t,e=0){return function(n){return n.lift(new M(t,e))}}(c.outsideAngular),Object(f.b)(c.insideAngular))}),this.firestore=s.runOutsideAngular(()=>{const n=K(t,s,e);vt.registerFirestore&&Object(vt.registerFirestore)(yt.a);const r=n.firestore();return i&&r.settings(i),r}),this.persistenceEnabled$=n&&!Object(r.s)(o)?s.runOutsideAngular(()=>{try{return Object(h.a)(this.firestore.enablePersistence(a||void 0).then(()=>!0,()=>!1))}catch(t){return Object(u.a)(!1)}}):Object(u.a)(!1)}collection(t,e){let n;n="string"==typeof t?this.firestore.collection(t):t;const{ref:r,query:i}=St(n,e),o=this.schedulers.ngZone.run(()=>r);return new It(o,i,this)}collectionGroup(t,e){const n=e||(t=>t),r=this.firestore.collectionGroup(t);return new Tt(n(r),this)}doc(t){let e;e="string"==typeof t?this.firestore.doc(t):t;const n=this.schedulers.ngZone.run(()=>e);return new Et(n,this)}createId(){return this.firestore.collection("_").doc().id}}return t.\u0275fac=function(e){return new(e||t)(s.Ub(W),s.Ub(Q,8),s.Ub(At,8),s.Ub(Nt,8),s.Ub(s.B),s.Ub(s.z),s.Ub(Ot,8))},t.\u0275prov=Object(s.Hb)({factory:function(){return new t(Object(s.Ub)(W),Object(s.Ub)(Q,8),Object(s.Ub)(At,8),Object(s.Ub)(Nt,8),Object(s.Ub)(s.B),Object(s.Ub)(s.z),Object(s.Ub)(Ot,8))},token:t,providedIn:"any"}),t})(),Pt=(()=>{class t{static enablePersistence(e){return{ngModule:t,providers:[{provide:At,useValue:!0},{provide:Ot,useValue:e}]}}}return t.\u0275mod=s.Jb({type:t}),t.\u0275inj=s.Ib({factory:function(e){return new(e||t)},providers:[xt]}),t})();var Dt=n("2Vo4"),kt=n("/uUt");let jt={};const Lt="@ngrx/store/init";let Ct=(()=>{class t extends Dt.a{constructor(){super({type:Lt})}next(t){if("function"==typeof t)throw new TypeError("\n        Dispatch expected an object, instead it received a function.\n        If you're using the createAction function, make sure to invoke the function\n        before dispatching the action. For example, someAction should be someAction().");if(void 0===t)throw new TypeError("Actions must be objects");if(void 0===t.type)throw new TypeError("Actions must have a type property");super.next(t)}complete(){}ngOnDestroy(){super.complete()}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=s.Hb({token:t,factory:t.\u0275fac}),t})();const Rt=[Ct],Ut=new s.q("@ngrx/store Internal Root Guard"),Mt=new s.q("@ngrx/store Internal Initial State"),Ft=new s.q("@ngrx/store Initial State"),Vt=new s.q("@ngrx/store Reducer Factory"),qt=new s.q("@ngrx/store Internal Reducer Factory Provider"),Bt=new s.q("@ngrx/store Initial Reducers"),zt=new s.q("@ngrx/store Internal Initial Reducers"),Gt=new s.q("@ngrx/store Store Features"),Wt=new s.q("@ngrx/store Internal Store Reducers"),Qt=new s.q("@ngrx/store Internal Feature Reducers"),Ht=new s.q("@ngrx/store Internal Feature Configs"),Kt=new s.q("@ngrx/store Internal Store Features"),Xt=new s.q("@ngrx/store Internal Feature Reducers Token"),$t=new s.q("@ngrx/store Feature Reducers"),Yt=new s.q("@ngrx/store User Provided Meta Reducers"),Jt=new s.q("@ngrx/store Meta Reducers"),Zt=new s.q("@ngrx/store Internal Resolved Meta Reducers"),te=new s.q("@ngrx/store User Runtime Checks Config"),ee=new s.q("@ngrx/store Internal User Runtime Checks Config"),ne=new s.q("@ngrx/store Internal Runtime Checks"),re=new s.q("@ngrx/store Check if Action types are unique");function ie(t,e={}){const n=Object.keys(t),r={};for(let o=0;o<n.length;o++){const e=n[o];"function"==typeof t[e]&&(r[e]=t[e])}const i=Object.keys(r);return function(t,n){t=void 0===t?e:t;let o=!1;const s={};for(let e=0;e<i.length;e++){const u=i[e],a=t[u],c=(0,r[u])(a,n);s[u]=c,o=o||c!==a}return o?s:t}}function oe(...t){return function(e){if(0===t.length)return e;const n=t[t.length-1];return t.slice(0,-1).reduceRight((t,e)=>e(t),n(e))}}function se(t,e){return Array.isArray(e)&&e.length>0&&(t=oe.apply(null,[...e,t])),(e,n)=>{const r=t(e);return(t,e)=>r(t=void 0===t?n:t,e)}}class ue extends c.a{}class ae extends Ct{}let ce=(()=>{class t extends Dt.a{constructor(t,e,n,r){super(r(n,e)),this.dispatcher=t,this.initialState=e,this.reducers=n,this.reducerFactory=r}addFeature(t){this.addFeatures([t])}addFeatures(t){const e=t.reduce((t,{reducers:e,reducerFactory:n,metaReducers:r,initialState:i,key:o})=>{const s="function"==typeof e?function(t){const e=Array.isArray(t)&&t.length>0?oe(...t):t=>t;return(t,n)=>(t=e(t),(e,r)=>t(e=void 0===e?n:e,r))}(r)(e,i):se(n,r)(e,i);return t[o]=s,t},{});this.addReducers(e)}removeFeature(t){this.removeFeatures([t])}removeFeatures(t){this.removeReducers(t.map(t=>t.key))}addReducer(t,e){this.addReducers({[t]:e})}addReducers(t){this.reducers=Object.assign(Object.assign({},this.reducers),t),this.updateReducers(Object.keys(t))}removeReducer(t){this.removeReducers([t])}removeReducers(t){t.forEach(t=>{var e,n;this.reducers=(e=this.reducers,n=t,Object.keys(e).filter(t=>t!==n).reduce((t,n)=>Object.assign(t,{[n]:e[n]}),{}))}),this.updateReducers(t)}updateReducers(t){this.next(this.reducerFactory(this.reducers,this.initialState)),this.dispatcher.next({type:"@ngrx/store/update-reducers",features:t})}ngOnDestroy(){this.complete()}}return t.\u0275fac=function(e){return new(e||t)(s.Ub(ae),s.Ub(Ft),s.Ub(Bt),s.Ub(Vt))},t.\u0275prov=s.Hb({token:t,factory:t.\u0275fac}),t})();const he=[ce,{provide:ue,useExisting:ce},{provide:ae,useExisting:Ct}];let fe=(()=>{class t extends T.a{ngOnDestroy(){this.complete()}}return t.\u0275fac=function(e){return le(e||t)},t.\u0275prov=s.Hb({token:t,factory:t.\u0275fac}),t})();const le=s.Sb(fe),pe=[fe];class de extends c.a{}let ye=(()=>{class t extends Dt.a{constructor(t,e,n,r){super(r);const i={state:r},o=t.pipe(Object(f.b)(j.a)).pipe(m(e)).pipe(Object(pt.a)(ve,i));this.stateSubscription=o.subscribe(({state:t,action:e})=>{this.next(t),n.next(e)})}ngOnDestroy(){this.stateSubscription.unsubscribe(),this.complete()}}return t.\u0275fac=function(e){return new(e||t)(s.Ub(Ct),s.Ub(ue),s.Ub(fe),s.Ub(Ft))},t.\u0275prov=s.Hb({token:t,factory:t.\u0275fac}),t.INIT=Lt,t})();function ve(t={state:void 0},[e,n]){const{state:r}=t;return{state:n(r,e),action:e}}const ge=[ye,{provide:de,useExisting:ye}];let be=(()=>{class t extends c.a{constructor(t,e,n){super(),this.actionsObserver=e,this.reducerManager=n,this.source=t}select(t,...e){return we.call(null,t,...e)(this)}lift(e){const n=new t(this,this.actionsObserver,this.reducerManager);return n.operator=e,n}dispatch(t){this.actionsObserver.next(t)}next(t){this.actionsObserver.next(t)}error(t){this.actionsObserver.error(t)}complete(){this.actionsObserver.complete()}addReducer(t,e){this.reducerManager.addReducer(t,e)}removeReducer(t){this.reducerManager.removeReducer(t)}}return t.\u0275fac=function(e){return new(e||t)(s.Ub(de),s.Ub(Ct),s.Ub(ce))},t.\u0275prov=s.Hb({token:t,factory:t.\u0275fac}),t})();const me=[be];function we(t,e,...n){return function(r){let i;if("string"==typeof t){const o=[e,...n].filter(Boolean);i=r.pipe(function(...t){const e=t.length;if(0===e)throw new Error("list of properties cannot be empty.");return n=>Object(p.a)(function(t,e){return n=>{let r=n;for(let i=0;i<e;i++){const e=r[t[i]];if(void 0===e)return;r=e}return r}}(t,e))(n)}(t,...o))}else{if("function"!=typeof t)throw new TypeError(`Unexpected type '${typeof t}' in select operator, expected 'string' or 'function'`);i=r.pipe(Object(p.a)(n=>t(n,e)))}return i.pipe(Object(kt.a)())}}const _e="https://ngrx.io/guide/store/configuration/runtime-checks";function Ie(t){return void 0===t}function Ee(t){return null===t}function Te(t){return Array.isArray(t)}function Ae(t){return"object"==typeof t&&null!==t}function Oe(t){return"function"==typeof t}function Ne(t){Object.freeze(t);const e=Oe(t);return Object.getOwnPropertyNames(t).forEach(n=>{if(!n.startsWith("\u0275")&&function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(t,n)&&(!e||"caller"!==n&&"callee"!==n&&"arguments"!==n)){const e=t[n];!Ae(e)&&!Oe(e)||Object.isFrozen(e)||Ne(e)}}),t}function Se(t,e=[]){return(Ie(t)||Ee(t))&&0===e.length?{path:["root"],value:t}:Object.keys(t).reduce((n,r)=>{if(n)return n;const i=t[r];return function(t){return Oe(t)&&t.hasOwnProperty("\u0275cmp")}(i)?n:!(Ie(i)||Ee(i)||function(t){return"number"==typeof t}(i)||function(t){return"boolean"==typeof t}(i)||function(t){return"string"==typeof t}(i)||Te(i))&&(function(t){if(!function(t){return Ae(t)&&!Te(t)}(t))return!1;const e=Object.getPrototypeOf(t);return e===Object.prototype||null===e}(i)?Se(i,[...e,r]):{path:[...e,r],value:i})},!1)}function xe(t,e){if(!1===t)return;const n=t.path.join("."),r=new Error(`Detected unserializable ${e} at "${n}". ${_e}#strict${e}serializability`);throw r.value=t.value,r.unserializablePath=n,r}function Pe(t){return Object(s.W)()?Object.assign({strictStateSerializability:!1,strictActionSerializability:!1,strictStateImmutability:!0,strictActionImmutability:!0,strictActionWithinNgZone:!1,strictActionTypeUniqueness:!1},t):{strictStateSerializability:!1,strictActionSerializability:!1,strictStateImmutability:!1,strictActionImmutability:!1,strictActionWithinNgZone:!1,strictActionTypeUniqueness:!1}}function De({strictActionSerializability:t,strictStateSerializability:e}){return n=>t||e?function(t,e){return function(n,r){e.action(r)&&xe(Se(r),"action");const i=t(n,r);return e.state()&&xe(Se(i),"state"),i}}(n,{action:e=>t&&!je(e),state:()=>e}):n}function ke({strictActionImmutability:t,strictStateImmutability:e}){return n=>t||e?function(t,e){return function(n,r){const i=e.action(r)?Ne(r):r,o=t(n,i);return e.state()?Ne(o):o}}(n,{action:e=>t&&!je(e),state:()=>e}):n}function je(t){return t.type.startsWith("@ngrx")}function Le({strictActionWithinNgZone:t}){return e=>t?function(t,e){return function(n,r){if(e.action(r)&&!s.z.isInAngularZone())throw new Error(`Action '${r.type}' running outside NgZone. ${_e}#strictactionwithinngzone`);return t(n,r)}}(e,{action:e=>t&&!je(e)}):e}function Ce(){return[{provide:re,multi:!0,deps:[ne],useFactory:Ue}]}function Re(t){return t}function Ue(t){if(!t.strictActionTypeUniqueness)return;const e=Object.entries(jt).filter(([,t])=>t>1).map(([t])=>t);if(e.length)throw new Error(`Action types are registered more than once, ${e.map(t=>`"${t}"`).join(", ")}. ${_e}#strictactiontypeuniqueness`)}let Me=(()=>{class t{constructor(t,e,n,r,i,o){}}return t.\u0275mod=s.Jb({type:t}),t.\u0275inj=s.Ib({factory:function(e){return new(e||t)(s.Ub(Ct),s.Ub(ue),s.Ub(fe),s.Ub(be),s.Ub(Ut,8),s.Ub(re,8))}}),t})(),Fe=(()=>{class t{constructor(t,e,n,r,i){this.features=t,this.featureReducers=e,this.reducerManager=n;const o=t.map((t,n)=>{const r=e.shift()[n];return Object.assign(Object.assign({},t),{reducers:r,initialState:Ge(t.initialState)})});n.addFeatures(o)}ngOnDestroy(){this.reducerManager.removeFeatures(this.features)}}return t.\u0275mod=s.Jb({type:t}),t.\u0275inj=s.Ib({factory:function(e){return new(e||t)(s.Ub(Kt),s.Ub($t),s.Ub(ce),s.Ub(Me),s.Ub(re,8))}}),t})(),Ve=(()=>{class t{static forRoot(t,e={}){return{ngModule:Me,providers:[{provide:Ut,useFactory:Qe,deps:[[be,new s.A,new s.J]]},{provide:Mt,useValue:e.initialState},{provide:Ft,useFactory:Ge,deps:[Mt]},{provide:zt,useValue:t},{provide:Wt,useExisting:t instanceof s.q?t:zt},{provide:Bt,deps:[s.r,zt,[new s.p(Wt)]],useFactory:qe},{provide:Yt,useValue:e.metaReducers?e.metaReducers:[]},{provide:Zt,deps:[Jt,Yt],useFactory:We},{provide:qt,useValue:e.reducerFactory?e.reducerFactory:ie},{provide:Vt,deps:[qt,Zt],useFactory:se},Rt,he,pe,ge,me,(n=e.runtimeChecks,[{provide:ee,useValue:n},{provide:te,useFactory:Re,deps:[ee]},{provide:ne,deps:[te],useFactory:Pe},{provide:Jt,multi:!0,deps:[ne],useFactory:ke},{provide:Jt,multi:!0,deps:[ne],useFactory:De},{provide:Jt,multi:!0,deps:[ne],useFactory:Le}]),Ce()]};var n}static forFeature(t,e,n={}){return{ngModule:Fe,providers:[{provide:Ht,multi:!0,useValue:n},{provide:Gt,multi:!0,useValue:{key:t,reducerFactory:n instanceof s.q||!n.reducerFactory?ie:n.reducerFactory,metaReducers:n instanceof s.q||!n.metaReducers?[]:n.metaReducers,initialState:n instanceof s.q||!n.initialState?void 0:n.initialState}},{provide:Kt,deps:[s.r,Ht,Gt],useFactory:Be},{provide:Qt,multi:!0,useValue:e},{provide:Xt,multi:!0,useExisting:e instanceof s.q?e:Qt},{provide:$t,multi:!0,deps:[s.r,Qt,[new s.p(Xt)]],useFactory:ze},Ce()]}}}return t.\u0275mod=s.Jb({type:t}),t.\u0275inj=s.Ib({factory:function(e){return new(e||t)}}),t})();function qe(t,e){return e instanceof s.q?t.get(e):e}function Be(t,e,n){return n.map((n,r)=>{if(e[r]instanceof s.q){const i=t.get(e[r]);return{key:n.key,reducerFactory:i.reducerFactory?i.reducerFactory:ie,metaReducers:i.metaReducers?i.metaReducers:[],initialState:i.initialState}}return n})}function ze(t,e){return e.map(e=>e instanceof s.q?t.get(e):e)}function Ge(t){return"function"==typeof t?t():t}function We(t,e){return t.concat(e)}function Qe(t){if(t)throw new TypeError("StoreModule.forRoot() called twice. Feature modules should use StoreModule.forFeature() instead.");return"guarded"}var He=n("FpXt"),Ke=n("AytR"),Xe=n("opfD");function $e(t,e){if(1&t&&(s.Qb(0,"th"),s.pc(1),s.Pb()),2&t){const t=e.$implicit;s.Ab(1),s.qc(t)}}function Ye(t,e){if(1&t&&(s.Qb(0,"td"),s.pc(1),s.Pb()),2&t){const t=e.$implicit;s.Ab(1),s.qc(t)}}function Je(t,e){if(1&t&&(s.Qb(0,"tr"),s.oc(1,Ye,2,1,"td",20),s.Pb()),2&t){const t=e.$implicit;s.Ab(1),s.ec("ngForOf",t)}}const Ze=[{path:"",component:(()=>{class t{constructor(){this.days=Xe.a,this.rows=Array.from(Array(20)).map((t,e)=>Xe.a.slice())}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=s.Fb({type:t,selectors:[["app-main-container"]],decls:70,vars:2,consts:[[1,"navbar","is-transparent"],[1,"container"],[1,"navbar-brand"],[1,"navbar-item"],["src","assets/logo.svg"],[1,"columns"],[1,"column","is-3"],[1,"menu","is-hidden-mobile"],[1,"menu-label"],[1,"menu-list"],[1,"is-active"],[1,"column","is-9"],[1,"hero","is-primary","is-small"],[1,"hero-body"],[1,"title"],[1,"subtitle"],[1,"card"],[1,"card-table"],[1,"content"],[1,"table","is-fullwidth","is-striped"],[4,"ngFor","ngForOf"],[1,"footer"]],template:function(t,e){1&t&&(s.Qb(0,"nav",0),s.Qb(1,"div",1),s.Qb(2,"div",2),s.Qb(3,"a",3),s.Mb(4,"img",4),s.Pb(),s.Pb(),s.Pb(),s.Pb(),s.Qb(5,"div",1),s.Qb(6,"div",5),s.Qb(7,"div",6),s.Qb(8,"aside",7),s.Qb(9,"p",8),s.pc(10,"General"),s.Pb(),s.Qb(11,"ul",9),s.Qb(12,"li"),s.Qb(13,"a",10),s.pc(14,"Dashboard"),s.Pb(),s.Pb(),s.Qb(15,"li"),s.Qb(16,"a"),s.pc(17,"Customers"),s.Pb(),s.Pb(),s.Qb(18,"li"),s.Qb(19,"a"),s.pc(20,"Other"),s.Pb(),s.Pb(),s.Pb(),s.Qb(21,"p",8),s.pc(22,"Administration"),s.Pb(),s.Qb(23,"ul",9),s.Qb(24,"li"),s.Qb(25,"a"),s.pc(26,"Team Settings"),s.Pb(),s.Pb(),s.Qb(27,"li"),s.Qb(28,"a"),s.pc(29,"Manage Your Team"),s.Pb(),s.Qb(30,"ul"),s.Qb(31,"li"),s.Qb(32,"a"),s.pc(33,"Members"),s.Pb(),s.Pb(),s.Qb(34,"li"),s.Qb(35,"a"),s.pc(36,"Members"),s.Pb(),s.Pb(),s.Qb(37,"li"),s.Qb(38,"a"),s.pc(39,"Members"),s.Pb(),s.Pb(),s.Qb(40,"li"),s.Qb(41,"a"),s.pc(42,"Members"),s.Pb(),s.Pb(),s.Qb(43,"li"),s.Qb(44,"a"),s.pc(45,"Members"),s.Pb(),s.Pb(),s.Qb(46,"li"),s.Qb(47,"a"),s.pc(48,"Members"),s.Pb(),s.Pb(),s.Pb(),s.Pb(),s.Pb(),s.Pb(),s.Pb(),s.Qb(49,"div",11),s.Qb(50,"section",12),s.Qb(51,"div",13),s.Qb(52,"div",1),s.Qb(53,"h1",14),s.pc(54,"Scheduler"),s.Pb(),s.Qb(55,"h2",15),s.pc(56,"10 Shifts this week"),s.Pb(),s.Pb(),s.Pb(),s.Pb(),s.Qb(57,"div",16),s.Qb(58,"div",17),s.Qb(59,"div",18),s.Qb(60,"table",19),s.Qb(61,"tr"),s.oc(62,$e,2,1,"th",20),s.Pb(),s.oc(63,Je,2,1,"tr",20),s.Pb(),s.Pb(),s.Pb(),s.Pb(),s.Pb(),s.Pb(),s.Pb(),s.Qb(64,"footer",21),s.Qb(65,"div",1),s.Qb(66,"p"),s.pc(67,"Hey, this is a "),s.Qb(68,"strong"),s.pc(69,"footer"),s.Pb(),s.Pb(),s.Pb(),s.Pb()),2&t&&(s.Ab(62),s.ec("ngForOf",e.days),s.Ab(1),s.ec("ngForOf",e.rows))},directives:[r.j],encapsulation:2,changeDetection:0}),t})()},{path:"settings",loadChildren:()=>n.e(14).then(n.bind(null,"Cnya")).then(t=>t.UserSettingsModule)}];let tn=(()=>{class t{}return t.\u0275mod=s.Jb({type:t}),t.\u0275inj=s.Ib({factory:function(e){return new(e||t)},imports:[[r.c,He.a,i.f.forChild(Ze),Ve.forRoot({},{}),$.initializeApp(Ke.a.firebase),lt,Pt]]}),t})()},jtHE:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n("XNiG"),i=n("qgXg"),o=n("quSY"),s=n("pxpQ"),u=n("9ppp"),a=n("Ylt2");class c extends r.a{constructor(t=Number.POSITIVE_INFINITY,e=Number.POSITIVE_INFINITY,n){super(),this.scheduler=n,this._events=[],this._infiniteTimeWindow=!1,this._bufferSize=t<1?1:t,this._windowTime=e<1?1:e,e===Number.POSITIVE_INFINITY?(this._infiniteTimeWindow=!0,this.next=this.nextInfiniteTimeWindow):this.next=this.nextTimeWindow}nextInfiniteTimeWindow(t){const e=this._events;e.push(t),e.length>this._bufferSize&&e.shift(),super.next(t)}nextTimeWindow(t){this._events.push(new h(this._getNow(),t)),this._trimBufferThenGetEvents(),super.next(t)}_subscribe(t){const e=this._infiniteTimeWindow,n=e?this._events:this._trimBufferThenGetEvents(),r=this.scheduler,i=n.length;let c;if(this.closed)throw new u.a;if(this.isStopped||this.hasError?c=o.a.EMPTY:(this.observers.push(t),c=new a.a(this,t)),r&&t.add(t=new s.a(t,r)),e)for(let o=0;o<i&&!t.closed;o++)t.next(n[o]);else for(let o=0;o<i&&!t.closed;o++)t.next(n[o].value);return this.hasError?t.error(this.thrownError):this.isStopped&&t.complete(),c}_getNow(){return(this.scheduler||i.a).now()}_trimBufferThenGetEvents(){const t=this._getNow(),e=this._bufferSize,n=this._windowTime,r=this._events,i=r.length;let o=0;for(;o<i&&!(t-r[o].time<n);)o++;return i>e&&(o=Math.max(o,i-e)),o>0&&r.splice(0,o),r}}class h{constructor(t,e){this.time=t,this.value=e}}},pxpQ:function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"a",(function(){return u}));var r=n("7o/Q"),i=n("WMd4");function o(t,e=0){return function(n){return n.lift(new s(t,e))}}class s{constructor(t,e=0){this.scheduler=t,this.delay=e}call(t,e){return e.subscribe(new u(t,this.scheduler,this.delay))}}class u extends r.a{constructor(t,e,n=0){super(t),this.scheduler=e,this.delay=n}static dispatch(t){const{notification:e,destination:n}=t;e.observe(n),this.unsubscribe()}scheduleMessage(t){this.destination.add(this.scheduler.schedule(u.dispatch,this.delay,new a(t,this.destination)))}_next(t){this.scheduleMessage(i.a.createNext(t))}_error(t){this.scheduleMessage(i.a.createError(t)),this.unsubscribe()}_complete(){this.scheduleMessage(i.a.createComplete()),this.unsubscribe()}}class a{constructor(t,e){this.notification=t,this.destination=e}}},"q/0M":function(t,e,n){"use strict";function r(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}var i;n.r(e),n.d(e,"LogLevel",(function(){return s})),n.d(e,"Logger",(function(){return f})),n.d(e,"setLogLevel",(function(){return l})),n.d(e,"setUserLogHandler",(function(){return p}));var o=[],s=function(t){return t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT",t}({}),u={debug:s.DEBUG,verbose:s.VERBOSE,info:s.INFO,warn:s.WARN,error:s.ERROR,silent:s.SILENT},a=s.INFO,c=((i={})[s.DEBUG]="log",i[s.VERBOSE]="log",i[s.INFO]="info",i[s.WARN]="warn",i[s.ERROR]="error",i),h=function(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];if(!(e<t.logLevel)){var o=(new Date).toISOString(),s=c[e];if(!s)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[s].apply(console,r(["["+o+"]  "+t.name+":"],n))}},f=function(){function t(t){this.name=t,this._logLevel=a,this._logHandler=h,this._userLogHandler=null,o.push(this)}return Object.defineProperty(t.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in s))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),t.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?u[t]:t},Object.defineProperty(t.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),t.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,r([this,s.DEBUG],t)),this._logHandler.apply(this,r([this,s.DEBUG],t))},t.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,r([this,s.VERBOSE],t)),this._logHandler.apply(this,r([this,s.VERBOSE],t))},t.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,r([this,s.INFO],t)),this._logHandler.apply(this,r([this,s.INFO],t))},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,r([this,s.WARN],t)),this._logHandler.apply(this,r([this,s.WARN],t))},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,r([this,s.ERROR],t)),this._logHandler.apply(this,r([this,s.ERROR],t))},t}();function l(t){o.forEach((function(e){e.setLogLevel(t)}))}function p(t,e){for(var n=function(n){var r=null;e&&e.level&&(r=u[e.level]),n.userLogHandler=null===t?null:function(e,n){for(var i=[],o=2;o<arguments.length;o++)i[o-2]=arguments[o];var u=i.map((function(t){if(null==t)return null;if("string"==typeof t)return t;if("number"==typeof t||"boolean"==typeof t)return t.toString();if(t instanceof Error)return t.message;try{return JSON.stringify(t)}catch(e){return null}})).filter((function(t){return t})).join(" ");n>=(null!=r?r:e.logLevel)&&t({level:s[n].toLowerCase(),message:u,args:i,type:e.name})}},r=0,i=o;r<i.length;r++)n(i[r])}},qgXg:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n("3N8a");class i extends r.a{constructor(t,e){super(t,e),this.scheduler=t,this.work=e}schedule(t,e=0){return e>0?super.schedule(t,e):(this.delay=e,this.state=t,this.scheduler.flush(this),this)}execute(t,e){return e>0||this.closed?super.execute(t,e):this._execute(t,e)}requestAsyncId(t,e,n=0){return null!==n&&n>0||null===n&&this.delay>0?super.requestAsyncId(t,e,n):t.flush(this)}}var o=n("IjjT");class s extends o.a{}const u=new s(i)},wj3C:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,i,o=n("Tr+X"),s=n("zVF4"),u=n("S+S0"),a=n("q/0M"),c=((r={})["no-app"]="No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",r["bad-app-name"]="Illegal App name: '{$appName}",r["duplicate-app"]="Firebase App named '{$appName}' already exists",r["app-deleted"]="Firebase App named '{$appName}' already deleted",r["invalid-app-argument"]="firebase.{$appName}() takes either no argument or a Firebase App instance.",r["invalid-log-argument"]="First argument to `onLog` must be null or a function.",r),h=new s.ErrorFactory("app","Firebase",c),f=((i={})["@firebase/app"]="fire-core",i["@firebase/analytics"]="fire-analytics",i["@firebase/auth"]="fire-auth",i["@firebase/database"]="fire-rtdb",i["@firebase/functions"]="fire-fn",i["@firebase/installations"]="fire-iid",i["@firebase/messaging"]="fire-fcm",i["@firebase/performance"]="fire-perf",i["@firebase/remote-config"]="fire-rc",i["@firebase/storage"]="fire-gcs",i["@firebase/firestore"]="fire-fst",i["fire-js"]="fire-js",i["firebase-wrapper"]="fire-js-all",i),l=new a.Logger("@firebase/app"),p=function(){function t(t,e,n){var r,i,a=this;this.firebase_=n,this.isDeleted_=!1,this.name_=e.name,this.automaticDataCollectionEnabled_=e.automaticDataCollectionEnabled||!1,this.options_=s.deepCopy(t),this.container=new u.ComponentContainer(e.name),this._addComponent(new u.Component("app",(function(){return a}),"PUBLIC"));try{for(var c=o.__values(this.firebase_.INTERNAL.components.values()),h=c.next();!h.done;h=c.next())this._addComponent(h.value)}catch(f){r={error:f}}finally{try{h&&!h.done&&(i=c.return)&&i.call(c)}finally{if(r)throw r.error}}}return Object.defineProperty(t.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed_(),this.automaticDataCollectionEnabled_},set:function(t){this.checkDestroyed_(),this.automaticDataCollectionEnabled_=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!1,configurable:!0}),t.prototype.delete=function(){var t=this;return new Promise((function(e){t.checkDestroyed_(),e()})).then((function(){return t.firebase_.INTERNAL.removeApp(t.name_),Promise.all(t.container.getProviders().map((function(t){return t.delete()})))})).then((function(){t.isDeleted_=!0}))},t.prototype._getService=function(t,e){return void 0===e&&(e="[DEFAULT]"),this.checkDestroyed_(),this.container.getProvider(t).getImmediate({identifier:e})},t.prototype._removeServiceInstance=function(t,e){void 0===e&&(e="[DEFAULT]"),this.container.getProvider(t).clearInstance(e)},t.prototype._addComponent=function(t){try{this.container.addComponent(t)}catch(e){l.debug("Component "+t.name+" failed to register with FirebaseApp "+this.name,e)}},t.prototype._addOrOverwriteComponent=function(t){this.container.addOrOverwriteComponent(t)},t.prototype.checkDestroyed_=function(){if(this.isDeleted_)throw h.create("app-deleted",{appName:this.name_})},t}();p.prototype.name&&p.prototype.options||p.prototype.delete||console.log("dc");var d=function t(){var e=function(t){var e={},n=new Map,r={__esModule:!0,initializeApp:function(n,i){void 0===i&&(i={}),"object"==typeof i&&null!==i||(i={name:i});var o=i;void 0===o.name&&(o.name="[DEFAULT]");var u=o.name;if("string"!=typeof u||!u)throw h.create("bad-app-name",{appName:String(u)});if(s.contains(e,u))throw h.create("duplicate-app",{appName:u});var a=new t(n,o,r);return e[u]=a,a},app:i,registerVersion:function(t,e,n){var r,i=null!==(r=f[t])&&void 0!==r?r:t;n&&(i+="-"+n);var o=i.match(/\s|\//),s=e.match(/\s|\//);if(o||s){var a=['Unable to register library "'+i+'" with version "'+e+'":'];return o&&a.push('library name "'+i+'" contains illegal characters (whitespace or "/")'),o&&s&&a.push("and"),s&&a.push('version name "'+e+'" contains illegal characters (whitespace or "/")'),void l.warn(a.join(" "))}c(new u.Component(i+"-version",(function(){return{library:i,version:e}}),"VERSION"))},setLogLevel:a.setLogLevel,onLog:function(t,e){if(null!==t&&"function"!=typeof t)throw h.create("invalid-log-argument",{appName:name});a.setUserLogHandler(t,e)},apps:null,SDK_VERSION:"7.17.1",INTERNAL:{registerComponent:c,removeApp:function(t){delete e[t]},components:n,useAsService:function(t,e){return"serverAuth"===e?null:e}}};function i(t){if(!s.contains(e,t=t||"[DEFAULT]"))throw h.create("no-app",{appName:t});return e[t]}function c(u){var a,c,f=u.name;if(n.has(f))return l.debug("There were multiple attempts to register component "+f+"."),"PUBLIC"===u.type?r[f]:null;if(n.set(f,u),"PUBLIC"===u.type){var p=function(t){if(void 0===t&&(t=i()),"function"!=typeof t[f])throw h.create("invalid-app-argument",{appName:f});return t[f]()};void 0!==u.serviceProps&&s.deepExtend(p,u.serviceProps),r[f]=p,t.prototype[f]=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=this._getService.bind(this,f);return n.apply(this,u.multipleInstances?t:[])}}try{for(var d=o.__values(Object.keys(e)),y=d.next();!y.done;y=d.next())e[y.value]._addComponent(u)}catch(v){a={error:v}}finally{try{y&&!y.done&&(c=d.return)&&c.call(d)}finally{if(a)throw a.error}}return"PUBLIC"===u.type?r[f]:null}return r.default=r,Object.defineProperty(r,"apps",{get:function(){return Object.keys(e).map((function(t){return e[t]}))}}),i.App=t,r}(p);return e.INTERNAL=o.__assign(o.__assign({},e.INTERNAL),{createFirebaseNamespace:t,extendNamespace:function(t){s.deepExtend(e,t)},createSubscribe:s.createSubscribe,ErrorFactory:s.ErrorFactory,deepExtend:s.deepExtend}),e}(),y=function(){function t(t){this.container=t}return t.prototype.getPlatformInfoString=function(){return this.container.getProviders().map((function(t){if(function(t){var e=t.getComponent();return"VERSION"===(null==e?void 0:e.type)}(t)){var e=t.getImmediate();return e.library+"/"+e.version}return null})).filter((function(t){return t})).join(" ")},t}();if(s.isBrowser()&&void 0!==self.firebase){l.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");var v=self.firebase.SDK_VERSION;v&&v.indexOf("LITE")>=0&&l.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}var g=d.initializeApp;d.initializeApp=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return s.isNode()&&l.warn('\n      Warning: This is a browser-targeted Firebase bundle but it appears it is being\n      run in a Node environment.  If running in a Node environment, make sure you\n      are using the bundle specified by the "main" field in package.json.\n      \n      If you are using Webpack, you can specify "main" as the first item in\n      "resolve.mainFields":\n      https://webpack.js.org/configuration/resolve/#resolvemainfields\n      \n      If using Rollup, use the rollup-plugin-node-resolve plugin and specify "main"\n      as the first item in "mainFields", e.g. [\'main\', \'module\'].\n      https://github.com/rollup/rollup-plugin-node-resolve\n      '),g.apply(void 0,t)};var b=d;!function(t,e){t.INTERNAL.registerComponent(new u.Component("platform-logger",(function(t){return new y(t)}),"PRIVATE")),t.registerVersion("@firebase/app","0.6.9",void 0),t.registerVersion("fire-js","")}(b),e.default=b,e.firebase=b},x7I3:function(t,e,n){"use strict";function r(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}n.r(e),n.d(e,"ErrorCode",(function(){return Kn})),n.d(e,"EventType",(function(){return Xn})),n.d(e,"WebChannel",(function(){return $n})),n.d(e,"XhrIo",(function(){return Yn})),n.d(e,"createWebChannelTransport",(function(){return Hn}));var i,o="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},s=s||{},u=o||self;function a(){}function c(t){var e=typeof t;if("object"==e){if(!t)return"null";if(t instanceof Array)return"array";if(t instanceof Object)return e;var n=Object.prototype.toString.call(t);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof t.length&&void 0!==t.splice&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||void 0!==t.call&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("call"))return"function"}else if("function"==e&&void 0===t.call)return"object";return e}function h(t){var e=c(t);return"array"==e||"object"==e&&"number"==typeof t.length}function f(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var l="closure_uid_"+(1e9*Math.random()>>>0),p=0;function d(t,e,n){return t.call.apply(t.bind,arguments)}function y(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function v(t,e,n){return(v=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?d:y).apply(null,arguments)}function g(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}var b=Date.now||function(){return+new Date};function m(t,e){function n(){}n.prototype=e.prototype,t.M=e.prototype,t.prototype=new n,t.prototype.constructor=t}function w(){this.j=this.j,this.i=this.i}w.prototype.j=!1,w.prototype.da=function(){!this.j&&(this.j=!0,this.C(),0)&&function(t){Object.prototype.hasOwnProperty.call(t,l)&&t[l]||(t[l]=++p)}(this)},w.prototype.C=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var _=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},I=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function E(t){return Array.prototype.concat.apply([],arguments)}function T(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function A(t){return/^[\s\xa0]*$/.test(t)}var O,N=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function S(t,e){return-1!=t.indexOf(e)}function x(t,e){return t<e?-1:t>e?1:0}t:{var P=u.navigator;if(P){var D=P.userAgent;if(D){O=D;break t}}O=""}function k(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function j(t){var e={};for(var n in t)e[n]=t[n];return e}var L="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function C(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<L.length;o++)n=L[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function R(t){return R[" "](t),t}R[" "]=a;var U,M,F=S(O,"Opera"),V=S(O,"Trident")||S(O,"MSIE"),q=S(O,"Edge"),B=q||V,z=S(O,"Gecko")&&!(S(O.toLowerCase(),"webkit")&&!S(O,"Edge"))&&!(S(O,"Trident")||S(O,"MSIE"))&&!S(O,"Edge"),G=S(O.toLowerCase(),"webkit")&&!S(O,"Edge");function W(){var t=u.document;return t?t.documentMode:void 0}t:{var Q="",H=(M=O,z?/rv:([^\);]+)(\)|;)/.exec(M):q?/Edge\/([\d\.]+)/.exec(M):V?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(M):G?/WebKit\/(\S+)/.exec(M):F?/(?:Version)[ \/]?(\S+)/.exec(M):void 0);if(H&&(Q=H?H[1]:""),V){var K=W();if(null!=K&&K>parseFloat(Q)){U=String(K);break t}}U=Q}var X={};function $(t){return function(t,e){var n=X;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e()}(t,(function(){for(var e=0,n=N(String(U)).split("."),r=N(String(t)).split("."),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++){var s=n[o]||"",u=r[o]||"";do{if(s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],u=/(\d*)(\D*)(.*)/.exec(u)||["","","",""],0==s[0].length&&0==u[0].length)break;e=x(0==s[1].length?0:parseInt(s[1],10),0==u[1].length?0:parseInt(u[1],10))||x(0==s[2].length,0==u[2].length)||x(s[2],u[2]),s=s[3],u=u[3]}while(0==e)}return 0<=e}))}var Y=u.document&&V&&(W()||parseInt(U,10))||void 0,J=!V||9<=Number(Y),Z=V&&!$("9"),tt=function(){if(!u.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{u.addEventListener("test",a,e),u.removeEventListener("test",a,e)}catch(n){}return t}();function et(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function nt(t,e){if(et.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(z){t:{try{R(e.nodeName);var i=!0;break t}catch(o){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:rt[t.pointerType]||"",this.c=t,t.defaultPrevented&&this.b()}}et.prototype.b=function(){this.defaultPrevented=!0},m(nt,et);var rt={2:"touch",3:"pen",4:"mouse"};nt.prototype.b=function(){nt.M.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,Z)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(e){}};var it="closure_listenable_"+(1e6*Math.random()|0),ot=0;function st(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.aa=i,this.key=++ot,this.V=this.X=!1}function ut(t){t.V=!0,t.listener=null,t.proxy=null,t.src=null,t.aa=null}function at(t){this.src=t,this.a={},this.b=0}function ct(t,e){var n=e.type;if(n in t.a){var r,i=t.a[n],o=_(i,e);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(ut(e),0==t.a[n].length&&(delete t.a[n],t.b--))}}function ht(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.V&&o.listener==e&&o.capture==!!n&&o.aa==r)return i}return-1}at.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=ht(t,e,r,i);return-1<s?(e=t[s],n||(e.X=!1)):((e=new st(e,this.src,o,!!r,i)).X=n,t.push(e)),e};var ft="closure_lm_"+(1e6*Math.random()|0),lt={};function pt(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}return r=_t(r),e&&e[it]?e.sa(n,r,f(i)?!!i.capture:!!i,o):dt(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)pt(t,e[o],n,r,i);return null}return n=_t(n),t&&t[it]?t.ra(e,n,f(r)?!!r.capture:!!r,i):dt(t,e,n,!1,r,i)}function dt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=f(i)?!!i.capture:!!i;if(s&&!J)return null;var u=mt(t);if(u||(t[ft]=u=new at(t)),(n=u.add(e,n,r,s,o)).proxy)return n;if(r=function(){var t=bt,e=J?function(n){return t.call(e.src,e.listener,n)}:function(n){if(!(n=t.call(e.src,e.listener,n)))return n};return e}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)tt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(vt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function yt(t){if("number"!=typeof t&&t&&!t.V){var e=t.src;if(e&&e[it])ct(e.c,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(vt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=mt(e))?(ct(n,t),0==n.b&&(n.src=null,e[ft]=null)):ut(t)}}}function vt(t){return t in lt?lt[t]:lt[t]="on"+t}function gt(t,e){var n=t.listener,r=t.aa||t.src;return t.X&&yt(t),n.call(r,e)}function bt(t,e){if(t.V)return!0;if(!J){if(!e)t:{e=["window","event"];for(var n=u,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return gt(t,e=new nt(e,this))}return gt(t,new nt(e,this))}function mt(t){return(t=t[ft])instanceof at?t:null}var wt="__closure_events_fn_"+(1e9*Math.random()>>>0);function _t(t){return"function"==c(t)?t:(t[wt]||(t[wt]=function(e){return t.handleEvent(e)}),t[wt])}function It(){w.call(this),this.c=new at(this),this.J=this,this.A=null}function Et(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s=e[o];if(s&&!s.V&&s.capture==n){var u=s.listener,a=s.aa||s.src;s.X&&ct(t.c,s),i=!1!==u.call(a,r)&&i}}return i&&!r.defaultPrevented}m(It,w),It.prototype[it]=!0,(i=It.prototype).addEventListener=function(t,e,n,r){pt(this,t,e,n,r)},i.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=f(i)?!!i.capture:!!i,r=_t(r),e&&e[it]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=ht(s=e.a[n],r,i,o))&&(ut(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):e&&(e=mt(e))&&(n=e.a[n.toString()],e=-1,n&&(e=ht(n,r,i,o)),(r=-1<e?n[e]:null)&&yt(r))}(this,t,e,n,r)},i.dispatchEvent=function(t){var e,n=this.A;if(n)for(e=[];n;n=n.A)e.push(n);n=this.J;var r=t.type||t;if("string"==typeof t)t=new et(t,n);else if(t instanceof et)t.target=t.target||n;else{var i=t;C(t=new et(r,n),i)}if(i=!0,e)for(var o=e.length-1;0<=o;o--){var s=t.a=e[o];i=Et(s,r,!0,t)&&i}if(i=Et(s=t.a=n,r,!0,t)&&i,i=Et(s,r,!1,t)&&i,e)for(o=0;o<e.length;o++)i=Et(s=t.a=e[o],r,!1,t)&&i;return i},i.C=function(){if(It.M.C.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)ut(n[r]);delete e.a[t],e.b--}}this.A=null},i.ra=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},i.sa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Tt=u.JSON.stringify;function At(){this.b=this.a=null}var Ot,Nt=new(function(){function t(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}return t.prototype.get=function(){var t;return 0<this.b?(this.b--,this.a=(t=this.a).next,t.next=null):t=this.c(),t},t}())((function(){return new xt}),(function(t){t.reset()}),100);function St(){var t=jt,e=null;return t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e}function xt(){this.next=this.b=this.a=null}function Pt(t){u.setTimeout((function(){throw t}),0)}function Dt(t,e){Ot||function(){var t=u.Promise.resolve(void 0);Ot=function(){t.then(Lt)}}(),kt||(Ot(),kt=!0),jt.add(t,e)}At.prototype.add=function(t,e){var n=Nt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},xt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},xt.prototype.reset=function(){this.next=this.b=this.a=null};var kt=!1,jt=new At;function Lt(){for(var t;t=St();){try{t.a.call(t.b)}catch(n){Pt(n)}var e=Nt;e.g(t),e.b<e.f&&(e.b++,t.next=e.a,e.a=t)}kt=!1}function Ct(t,e){It.call(this),this.b=t||1,this.a=e||u,this.f=v(this.Ua,this),this.g=b()}function Rt(t){t.Z=!1,t.L&&(t.a.clearTimeout(t.L),t.L=null)}function Ut(t,e,n){if("function"==c(t))n&&(t=v(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=v(t.handleEvent,t)}return 2147483647<Number(e)?-1:u.setTimeout(t,e||0)}function Mt(t,e,n){w.call(this),this.f=null!=n?v(t,n):t,this.c=e,this.b=v(this.Pa,this),this.a=[]}function Ft(t){t.T=Ut(t.b,t.c),t.f.apply(null,t.a)}function Vt(t){w.call(this),this.b=t,this.a={}}m(Ct,It),(i=Ct.prototype).Z=!1,i.L=null,i.Ua=function(){if(this.Z){var t=b()-this.g;0<t&&t<.8*this.b?this.L=this.a.setTimeout(this.f,this.b-t):(this.L&&(this.a.clearTimeout(this.L),this.L=null),this.dispatchEvent("tick"),this.Z&&(Rt(this),this.start()))}},i.start=function(){this.Z=!0,this.L||(this.L=this.a.setTimeout(this.f,this.b),this.g=b())},i.C=function(){Ct.M.C.call(this),Rt(this),delete this.a},m(Mt,w),(i=Mt.prototype).ba=!1,i.T=null,i.Ia=function(t){this.a=arguments,this.T?this.ba=!0:Ft(this)},i.C=function(){Mt.M.C.call(this),this.T&&(u.clearTimeout(this.T),this.T=null,this.ba=!1,this.a=[])},i.Pa=function(){this.T=null,this.ba&&(this.ba=!1,Ft(this))},m(Vt,w);var qt=[];function Bt(t,e,n,r){Array.isArray(n)||(n&&(qt[0]=n.toString()),n=qt);for(var i=0;i<n.length;i++){var o=pt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function zt(t){k(t.a,(function(t,e){this.a.hasOwnProperty(e)&&yt(t)}),t),t.a={}}function Gt(){}Vt.prototype.C=function(){Vt.M.C.call(this),zt(this)},Vt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Wt=null;function Qt(){return Wt=Wt||new It}function Ht(t){et.call(this,"serverreachability",t)}function Kt(t){var e=Qt();e.dispatchEvent(new Ht(e,t))}function Xt(t){et.call(this,"statevent",t)}function $t(t){var e=Qt();e.dispatchEvent(new Xt(e,t))}function Yt(t){et.call(this,"timingevent",t)}function Jt(t,e){if("function"!=c(t))throw Error("Fn must not be null and must be a function");return u.setTimeout((function(){t()}),e)}m(Ht,et),m(Xt,et),m(Yt,et);var Zt={NO_ERROR:0,Va:1,bb:2,ab:3,Ya:4,$a:5,cb:6,za:7,TIMEOUT:8,gb:9},te={Xa:"complete",kb:"success",Aa:"error",za:"abort",ib:"ready",jb:"readystatechange",TIMEOUT:"timeout",eb:"incrementaldata",hb:"progress",Za:"downloadprogress",lb:"uploadprogress"};function ee(){}function ne(){}ee.prototype.a=null;var re,ie={OPEN:"a",Wa:"b",Aa:"c",fb:"d"};function oe(){et.call(this,"d")}function se(){et.call(this,"c")}function ue(){}function ae(t,e,n){this.g=t,this.W=e,this.U=n||1,this.G=new Vt(this),this.N=ce,this.O=new Ct(t=B?125:void 0),this.m=null,this.b=!1,this.j=this.A=this.f=this.B=this.s=this.P=this.h=null,this.i=[],this.a=null,this.w=0,this.c=this.v=null,this.H=-1,this.l=!1,this.J=0,this.D=null,this.o=this.R=this.F=!1}m(oe,et),m(se,et),m(ue,ee),re=new ue;var ce=45e3,he={},fe={};function le(t,e,n){t.B=1,t.f=Le(Se(e)),t.j=n,t.F=!0,pe(t,null)}function pe(t,e){t.s=b(),ve(t),t.A=Se(t.f);var n=t.A,r=t.U;Array.isArray(r)||(r=[String(r)]),He(n.b,"t",r),t.w=0,t.a=Fn(t.g,t.g.w?e:null),0<t.J&&(t.D=new Mt(v(t.ya,t,t.a),t.J)),Bt(t.G,t.a,"readystatechange",t.Sa),e=t.m?j(t.m):{},t.j?(t.v||(t.v="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.$(t.A,t.v,t.j,e)):(t.v="GET",t.a.$(t.A,t.v,null,e)),Kt(1)}function de(t,e,n){for(var r=!0;!t.l&&t.w<n.length;){var i=ye(t,n);if(i==fe){4==e&&(t.c=4,$t(14),r=!1);break}if(i==he){t.c=4,$t(15),r=!1;break}_e(t,i)}4==e&&0==n.length&&(t.c=1,$t(16),r=!1),t.b=t.b&&r,r||(we(t),me(t))}function ye(t,e){var n=t.w,r=e.indexOf("\n",n);return-1==r?fe:(n=Number(e.substring(n,r)),isNaN(n)?he:(r+=1)+n>e.length?fe:(e=e.substr(r,n),t.w=r+n,e))}function ve(t){t.P=b()+t.N,ge(t,t.N)}function ge(t,e){if(null!=t.h)throw Error("WatchDog timer not null");t.h=Jt(v(t.Qa,t),e)}function be(t){t.h&&(u.clearTimeout(t.h),t.h=null)}function me(t){0==t.g.u||t.l||Ln(t.g,t)}function we(t){be(t);var e=t.D;e&&"function"==typeof e.da&&e.da(),t.D=null,Rt(t.O),zt(t.G),t.a&&(e=t.a,t.a=null,e.abort(),e.da())}function _e(t,e){try{var n=t.g;if(0!=n.u&&(n.a==t||tn(n.b,t)))if(n.A=t.H,!t.o&&tn(n.b,t)&&3==n.u){try{var r=n.ja.a.parse(e)}catch(y){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){t:if(!n.i){if(n.a){if(!(n.a.s+3e3<t.s))break t;jn(n),n.a.cancel(),n.a=null}kn(n),$t(18)}}else n.ia=i[1],0<n.ia-n.G&&37500>i[2]&&n.U&&0==n.m&&!n.l&&(n.l=Jt(v(n.Na,n),6e3));if(1>=Ze(n.b)&&n.O){try{n.O()}catch(y){}n.O=void 0}}else Rn(n,11)}else if((t.o||n.a==t)&&jn(n),!A(e))for(e=r=n.ja.a.parse(e),r=0;r<e.length;r++)if(n.G=(i=e[r])[0],i=i[1],2==n.u)if("c"==i[0]){n.B=i[1],n.R=i[2];var o=i[3];null!=o&&(n.oa=o);var s=i[5];null!=s&&"number"==typeof s&&0<s&&(n.D=1.5*s);var u=n,a=t.a;if(a){var c=a.a?a.a.getResponseHeader("X-Client-Wire-Protocol"):null;if(c){var h=u.b;!h.a&&(S(c,"spdy")||S(c,"quic")||S(c,"h2"))&&(h.f=h.g,h.a=new Set,h.b&&(en(h,h.b),h.b=null))}if(u.s){var f=a.a?a.a.getResponseHeader("X-HTTP-Session-Id"):null;f&&(u.ha=f,je(u.v,u.s,f))}}n.u=3,n.c&&n.c.na();var l=t;if((u=n).ea=Mn(u,u.w?u.R:null,u.P),l.o){nn(u.b,l);var p=l,d=u.D;d&&p.setTimeout(d),p.h&&(be(p),ve(p)),u.a=l}else Dn(u);0<n.f.length&&Nn(n)}else"stop"!=i[0]&&"close"!=i[0]||Rn(n,7);else 3==n.u&&("stop"==i[0]||"close"==i[0]?"stop"==i[0]?Rn(n,7):Tn(n):"noop"!=i[0]&&n.c&&n.c.ma(i),n.m=0);Kt(4)}catch(y){}}function Ie(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(h(t)||"string"==typeof t)I(t,e,void 0);else{if(t.K&&"function"==typeof t.K)var n=t.K();else if(t.I&&"function"==typeof t.I)n=void 0;else if(h(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.I&&"function"==typeof t.I)return t.I();if("string"==typeof t)return t.split("");if(h(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function Ee(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Ee)for(n=t.K(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Te(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Ae(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)Ae(i,r=t.a[e])||(t.a[n++]=r,i[r]=1),e++;t.a.length=n}}function Ae(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(i=ae.prototype).setTimeout=function(t){this.N=t},i.Sa=function(t){t=t.target;var e=this.D;e&&3==wn(t)?e.Ia():this.ya(t)},i.ya=function(t){try{if(t==this.a)t:{var e=wn(this.a),n=this.a.qa(),r=this.a.S();if(!(3>e||3==e&&!B&&!this.a.Y())){this.l||4!=e||7==n||Kt(8==n||0>=r?3:2),be(this);var i=this.a.S();this.H=i;var o=this.a.Y();if(this.b=200==i){if(this.R&&!this.o){e:{if(this.a){var s,u=this.a;if((s=u.a?u.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!A(s)){var a=s;break e}}a=null}if(!a){this.b=!1,this.c=3,$t(12),we(this),me(this);break t}this.o=!0,_e(this,a)}this.F?(de(this,e,o),B&&this.b&&3==e&&(Bt(this.G,this.O,"tick",this.Ra),this.O.start())):_e(this,o),4==e&&we(this),this.b&&!this.l&&(4==e?Ln(this.g,this):(this.b=!1,ve(this)))}else 400==i&&0<o.indexOf("Unknown SID")?(this.c=3,$t(12)):(this.c=0,$t(13)),we(this),me(this)}}}catch(c){}},i.Ra=function(){if(this.a){var t=wn(this.a),e=this.a.Y();this.w<e.length&&(be(this),de(this,t,e),this.b&&4!=t&&ve(this))}},i.cancel=function(){this.l=!0,we(this)},i.Qa=function(){this.h=null;var t=b();0<=t-this.P?(2!=this.B&&(Kt(3),$t(17)),we(this),this.c=2,me(this)):ge(this,this.P-t)},(i=Ee.prototype).I=function(){Te(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},i.K=function(){return Te(this),this.a.concat()},i.get=function(t,e){return Ae(this.b,t)?this.b[t]:e},i.set=function(t,e){Ae(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},i.forEach=function(t,e){for(var n=this.K(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Oe=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Ne(t,e){if(this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Ne){this.a=void 0!==e?e:t.a,xe(this,t.f),this.j=t.j,Pe(this,t.c),De(this,t.h),this.g=t.g,e=t.b;var n=new ze;n.c=e.c,e.a&&(n.a=new Ee(e.a),n.b=e.b),ke(this,n),this.i=t.i}else t&&(n=String(t).match(Oe))?(this.a=!!e,xe(this,n[1]||"",!0),this.j=Ce(n[2]||""),Pe(this,n[3]||"",!0),De(this,n[4]),this.g=Ce(n[5]||"",!0),ke(this,n[6]||"",!0),this.i=Ce(n[7]||"")):(this.a=!!e,this.b=new ze(null,this.a))}function Se(t){return new Ne(t)}function xe(t,e,n){t.f=n?Ce(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function Pe(t,e,n){t.c=n?Ce(e,!0):e}function De(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.h=e}else t.h=null}function ke(t,e,n){e instanceof ze?(t.b=e,function(t,e){e&&!t.f&&(Ge(t),t.c=null,t.a.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(We(this,e),He(this,n,t))}),t)),t.f=e}(t.b,t.a)):(n||(e=Re(e,qe)),t.b=new ze(e,t.a))}function je(t,e,n){t.b.set(e,n)}function Le(t){return je(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^b()).toString(36)),t}function Ce(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Re(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,Ue),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function Ue(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Ne.prototype.toString=function(){var t=[],e=this.f;e&&t.push(Re(e,Me,!0),":");var n=this.c;return(n||"file"==e)&&(t.push("//"),(e=this.j)&&t.push(Re(e,Me,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(Re(n,"/"==n.charAt(0)?Ve:Fe,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",Re(n,Be)),t.join("")};var Me=/[#\/\?@]/g,Fe=/[#\?:]/g,Ve=/[#\?]/g,qe=/[#\?@]/g,Be=/#/g;function ze(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function Ge(t){t.a||(t.a=new Ee,t.b=0,t.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.c,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function We(t,e){Ge(t),e=Ke(t,e),Ae(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Ae((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Te(t)))}function Qe(t,e){return Ge(t),e=Ke(t,e),Ae(t.a.b,e)}function He(t,e,n){We(t,e),0<n.length&&(t.c=null,t.a.set(Ke(t,e),T(n)),t.b+=n.length)}function Ke(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function Xe(t,e){this.b=t,this.a=e}function $e(t){this.g=t||Ye,t=u.PerformanceNavigationTiming?0<(t=u.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(u.ca&&u.ca.ua&&u.ca.ua()&&u.ca.ua().mb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(i=ze.prototype).add=function(t,e){Ge(this),this.c=null,t=Ke(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},i.forEach=function(t,e){Ge(this),this.a.forEach((function(n,r){I(n,(function(n){t.call(e,n,r,this)}),this)}),this)},i.K=function(){Ge(this);for(var t=this.a.I(),e=this.a.K(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},i.I=function(t){Ge(this);var e=[];if("string"==typeof t)Qe(this,t)&&(e=E(e,this.a.get(Ke(this,t))));else{t=this.a.I();for(var n=0;n<t.length;n++)e=E(e,t[n])}return e},i.set=function(t,e){return Ge(this),this.c=null,Qe(this,t=Ke(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},i.get=function(t,e){return t&&0<(t=this.I(t)).length?String(t[0]):e},i.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.K(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.I(r);for(var o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}}return this.c=t.join("&")};var Ye=10;function Je(t){return!!t.b||!!t.a&&t.a.size>=t.f}function Ze(t){return t.b?1:t.a?t.a.size:0}function tn(t,e){return t.b?t.b==e:!!t.a&&t.a.has(e)}function en(t,e){t.a?t.a.add(e):t.b=e}function nn(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function rn(t){var e,n;if(null!=t.b)return t.c.concat(t.b.i);if(null!=t.a&&0!==t.a.size){var i=t.c;try{for(var o=r(t.a.values()),s=o.next();!s.done;s=o.next())i=i.concat(s.value.i)}catch(u){e={error:u}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}return i}return T(t.c)}function on(){}function sn(){this.a=new on}function un(t,e,n){var r=n||"";try{Ie(t,(function(t,n){var i=t;f(t)&&(i=Tt(t)),e.push(r+n+"="+encodeURIComponent(i))}))}catch(i){throw e.push(r+"type="+encodeURIComponent("_badmap")),i}}function an(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(o){}}$e.prototype.cancel=function(){var t,e;if(this.c=rn(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=r(this.a.values()),i=n.next();!i.done;i=n.next())i.value.cancel()}catch(o){t={error:o}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},on.prototype.stringify=function(t){return u.JSON.stringify(t,void 0)},on.prototype.parse=function(t){return u.JSON.parse(t,void 0)};var cn=u.JSON.parse;function hn(t){It.call(this),this.headers=new Ee,this.G=t||null,this.b=!1,this.s=this.a=null,this.D="",this.h=0,this.f="",this.g=this.w=this.l=this.v=!1,this.o=0,this.m=null,this.H=fn,this.B=this.F=!1}m(hn,It);var fn="",ln=/^https?$/i,pn=["POST","PUT"];function dn(t){return"content-type"==t.toLowerCase()}function yn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,vn(t),bn(t)}function vn(t){t.v||(t.v=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function gn(t){if(t.b&&void 0!==s&&(!t.s[1]||4!=wn(t)||2!=t.S()))if(t.l&&4==wn(t))Ut(t.va,0,t);else if(t.dispatchEvent("readystatechange"),4==wn(t)){t.b=!1;try{var e,n=t.S();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=String(t.D).match(Oe)[1]||null;if(!o&&u.self&&u.self.location){var a=u.self.location.protocol;o=a.substr(0,a.length-1)}i=!ln.test(o?o.toLowerCase():"")}e=i}if(e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var c=2<wn(t)?t.a.statusText:""}catch(h){c=""}t.f=c+" ["+t.S()+"]",vn(t)}}finally{bn(t)}}}function bn(t,e){if(t.a){mn(t);var n=t.a,r=t.s[0]?a:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(i){}}}function mn(t){t.a&&t.B&&(t.a.ontimeout=null),t.m&&(u.clearTimeout(t.m),t.m=null)}function wn(t){return t.a?t.a.readyState:0}function _n(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}r||(n=function(t){var e="";return k(t,(function(t,n){e+=n,e+=":",e+=t,e+="\r\n"})),e}(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):je(t,e,n))}function In(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function En(t){this.f=[],this.R=this.ea=this.v=this.P=this.a=this.ha=this.s=this.N=this.h=this.F=this.j=null,this.Fa=this.H=0,this.Ca=In("failFast",!1,t),this.U=this.l=this.i=this.g=this.c=null,this.W=!0,this.A=this.ia=this.G=-1,this.J=this.m=this.o=0,this.Ba=In("baseRetryDelayMs",5e3,t),this.Ga=In("retryDelaySeedMs",1e4,t),this.Da=In("forwardChannelMaxRetries",2,t),this.ga=In("forwardChannelRequestTimeoutMs",2e4,t),this.Ea=t&&t.nb||void 0,this.D=void 0,this.w=t&&t.supportsCrossDomainXhr||!1,this.B="",this.b=new $e(t&&t.concurrentRequestLimit),this.ja=new sn,this.fa=t&&t.fastHandshake||!1,t&&t.forceLongPolling&&(this.W=!1),this.O=void 0}function Tn(t){if(An(t),3==t.u){var e=t.H++,n=Se(t.v);je(n,"SID",t.B),je(n,"RID",e),je(n,"TYPE","terminate"),xn(t,n),(e=new ae(t,e,void 0)).B=2,e.f=Le(Se(n)),n=!1,u.navigator&&u.navigator.sendBeacon&&(n=u.navigator.sendBeacon(e.f.toString(),"")),!n&&u.Image&&((new Image).src=e.f,n=!0),n||(e.a=Fn(e.g,null),e.a.$(e.f)),e.s=b(),ve(e)}Un(t)}function An(t){t.a&&(t.a.cancel(),t.a=null),t.i&&(u.clearTimeout(t.i),t.i=null),jn(t),t.b.cancel(),t.g&&("number"==typeof t.g&&u.clearTimeout(t.g),t.g=null)}function On(t,e){t.f.push(new Xe(t.Fa++,e)),3==t.u&&Nn(t)}function Nn(t){Je(t.b)||t.g||(t.g=!0,Dt(t.xa,t),t.o=0)}function Sn(t,e){var n;n=e?e.W:t.H++;var r=Se(t.v);je(r,"SID",t.B),je(r,"RID",n),je(r,"AID",t.G),xn(t,r),t.h&&t.j&&_n(r,t.h,t.j),n=new ae(t,n,t.o+1),null===t.h&&(n.m=t.j),e&&(t.f=e.i.concat(t.f)),e=Pn(t,n,1e3),n.setTimeout(Math.round(.5*t.ga)+Math.round(.5*t.ga*Math.random())),en(t.b,n),le(n,r,e)}function xn(t,e){t.c&&Ie({},(function(t,n){je(e,n,t)}))}function Pn(t,e,n){n=Math.min(t.f.length,n);var r=t.c?v(t.c.Ha,t.c,t):null;t:for(var i=t.f,o=-1;;){var s=["count="+n];-1==o?0<n?s.push("ofs="+(o=i[0].b)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var c=i[a].b,h=i[a].a;if(0>(c-=o))o=Math.max(0,i[a].b-100),u=!1;else try{un(h,s,"req"+c+"_")}catch(f){r&&r(h)}}if(u){r=s.join("&");break t}}return t=t.f.splice(0,n),e.i=t,r}function Dn(t){t.a||t.i||(t.J=1,Dt(t.wa,t),t.m=0)}function kn(t){return!(t.a||t.i||3<=t.m||(t.J++,t.i=Jt(v(t.wa,t),Cn(t,t.m)),t.m++,0))}function jn(t){null!=t.l&&(u.clearTimeout(t.l),t.l=null)}function Ln(t,e){var n=null;if(t.a==e){jn(t),t.a=null;var r=2}else{if(!tn(t.b,e))return;n=e.i,nn(t.b,e),r=1}if(t.A=e.H,0!=t.u)if(e.b)if(1==r){n=e.j?e.j.length:0,e=b()-e.s;var i=t.o;(r=Qt()).dispatchEvent(new Yt(r,n,e,i)),Nn(t)}else Dn(t);else if(3==(i=e.c)||0==i&&0<t.A||!(1==r&&function(t,e){return!(Ze(t.b)>=t.b.f-(t.g?1:0)||(t.g?(t.f=e.i.concat(t.f),0):1==t.u||2==t.u||t.o>=(t.Ca?0:t.Da)||(t.g=Jt(v(t.xa,t,e),Cn(t,t.o)),t.o++,0)))}(t,e)||2==r&&kn(t)))switch(n&&0<n.length&&(e=t.b,e.c=e.c.concat(n)),i){case 1:Rn(t,5);break;case 4:Rn(t,10);break;case 3:Rn(t,6);break;default:Rn(t,2)}}function Cn(t,e){var n=t.Ba+Math.floor(Math.random()*t.Ga);return t.c||(n*=2),n*e}function Rn(t,e){if(2==e){var n=null;t.c&&(n=null);var r=v(t.Ta,t);n||(n=new Ne("//www.google.com/images/cleardot.gif"),u.location&&"http"==u.location.protocol||xe(n,"https"),Le(n)),function(t,e){var n=new Gt;if(u.Image){var r=new Image;r.onload=g(an,n,r,"TestLoadImage: loaded",!0,e),r.onerror=g(an,n,r,"TestLoadImage: error",!1,e),r.onabort=g(an,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=g(an,n,r,"TestLoadImage: timeout",!1,e),u.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=t}else e(!1)}(n.toString(),r)}else $t(2);t.u=0,t.c&&t.c.la(e),Un(t),An(t)}function Un(t){t.u=0,t.A=-1,t.c&&(0==rn(t.b).length&&0==t.f.length||(t.b.c.length=0,T(t.f),t.f.length=0),t.c.ka())}function Mn(t,e,n){var r=function(t){return t instanceof Ne?Se(t):new Ne(t,void 0)}(n);if(""!=r.c)e&&Pe(r,e+"."+r.c),De(r,r.h);else{var i=u.location;r=function(t,e,n,r){var i=new Ne(null,void 0);return t&&xe(i,t),e&&Pe(i,e),n&&De(i,n),r&&(i.g=r),i}(i.protocol,e?e+"."+i.hostname:i.hostname,+i.port,n)}return t.N&&k(t.N,(function(t,e){je(r,e,t)})),n=t.ha,(e=t.s)&&n&&je(r,e,n),je(r,"VER",t.oa),xn(t,r),r}function Fn(t,e){if(e&&!t.w)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new hn(t.Ea)).F=t.w,e}function Vn(){}function qn(){if(V&&!(10<=Number(Y)))throw Error("Environmental error: no available transport.")}function Bn(t,e){It.call(this),this.a=new En(e),this.l=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.j=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.pa&&(t?t["X-WebChannel-Client-Profile"]=e.pa:t={"X-WebChannel-Client-Profile":e.pa}),this.a.F=t,(t=e&&e.httpHeadersOverwriteParam)&&!A(t)&&(this.a.h=t),this.h=e&&e.supportsCrossDomainXhr||!1,this.g=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!A(e)&&(this.a.s=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new Wn(this)}function zn(t){oe.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function Gn(){se.call(this),this.status=1}function Wn(t){this.a=t}(i=hn.prototype).$=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+t);e=e?e.toUpperCase():"GET",this.D=t,this.f="",this.h=0,this.v=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=function(t){var e;return(e=t.a)||(e=t.a={}),e}(this.G?this.G:re),this.a.onreadystatechange=v(this.va,this);try{this.w=!0,this.a.open(e,String(t),!0),this.w=!1}catch(o){return void yn(this,o)}t=n||"";var i=new Ee(this.headers);r&&Ie(r,(function(t,e){i.set(e,t)})),r=function(t){t:{for(var e=dn,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:"string"==typeof t?t.charAt(e):t[e]}(i.K()),n=u.FormData&&t instanceof u.FormData,!(0<=_(pn,e))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach((function(t,e){this.a.setRequestHeader(e,t)}),this),this.H&&(this.a.responseType=this.H),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{mn(this),0<this.o&&((this.B=function(t){return V&&$(9)&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.a))?(this.a.timeout=this.o,this.a.ontimeout=v(this.ta,this)):this.m=Ut(this.ta,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(o){yn(this,o)}},i.ta=function(){void 0!==s&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},i.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),bn(this))},i.C=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),bn(this,!0)),hn.M.C.call(this)},i.va=function(){this.j||(this.w||this.l||this.g?gn(this):this.Oa())},i.Oa=function(){gn(this)},i.S=function(){try{return 2<wn(this)?this.a.status:-1}catch(M){return-1}},i.Y=function(){try{return this.a?this.a.responseText:""}catch(M){return""}},i.Ja=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),cn(e)}},i.qa=function(){return this.h},i.Ma=function(){return"string"==typeof this.f?this.f:String(this.f)},(i=En.prototype).oa=8,i.u=1,i.xa=function(t){if(this.g)if(this.g=null,1==this.u){if(!t){this.H=Math.floor(1e5*Math.random());var e,n=new ae(this,t=this.H++,void 0),r=this.j;if(this.F&&(r?C(r=j(r),this.F):r=this.F),null===this.h&&(n.m=r),this.fa)t:{for(var i=e=0;i<this.f.length;i++){var o=this.f[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.f.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=Pn(this,n,e),je(i=Se(this.v),"RID",t),je(i,"CVER",22),this.s&&je(i,"X-HTTP-Session-Id",this.s),xn(this,i),this.h&&r&&_n(i,this.h,r),en(this.b,n),this.fa?(je(i,"$req",e),je(i,"SID","null"),n.R=!0,le(n,i,null)):le(n,i,e),this.u=2}}else 3==this.u&&(t?Sn(this,t):0==this.f.length||Je(this.b)||Sn(this))},i.wa=function(){this.i=null,this.a=new ae(this,"rpc",this.J),null===this.h&&(this.a.m=this.j),this.a.J=0;var t=Se(this.ea);je(t,"RID","rpc"),je(t,"SID",this.B),je(t,"CI",this.U?"0":"1"),je(t,"AID",this.G),xn(this,t),je(t,"TYPE","xmlhttp"),this.h&&this.j&&_n(t,this.h,this.j),this.D&&this.a.setTimeout(this.D);var e=this.a,n=this.R;e.B=1,e.f=Le(Se(t)),e.j=null,e.F=!0,pe(e,n)},i.Na=function(){null!=this.l&&(this.l=null,this.a.cancel(),this.a=null,kn(this),$t(19))},i.Ta=function(t){$t(t?2:1)},(i=Vn.prototype).na=function(){},i.ma=function(){},i.la=function(){},i.ka=function(){},i.Ha=function(){},qn.prototype.a=function(t,e){return new Bn(t,e)},m(Bn,It),(i=Bn.prototype).addEventListener=function(t,e,n,r){Bn.M.addEventListener.call(this,t,e,n,r)},i.removeEventListener=function(t,e,n,r){Bn.M.removeEventListener.call(this,t,e,n,r)},i.Ka=function(){this.a.c=this.f,this.h&&(this.a.w=!0);var t=this.a,e=this.l,n=this.b||void 0;$t(0),t.P=e,t.N=n||{},t.U=t.W,t.v=Mn(t,null,t.P),Nn(t)},i.close=function(){Tn(this.a)},i.La=function(t){if("string"==typeof t){var e={};e.__data__=t,On(this.a,e)}else this.g?((e={}).__data__=Tt(t),On(this.a,e)):On(this.a,t)},i.C=function(){this.a.c=null,delete this.f,Tn(this.a),delete this.a,Bn.M.C.call(this)},m(zn,oe),m(Gn,se),m(Wn,Vn),Wn.prototype.na=function(){this.a.dispatchEvent("a")},Wn.prototype.ma=function(t){this.a.dispatchEvent(new zn(t))},Wn.prototype.la=function(t){this.a.dispatchEvent(new Gn(t))},Wn.prototype.ka=function(){this.a.dispatchEvent("b")},qn.prototype.createWebChannel=qn.prototype.a,Bn.prototype.send=Bn.prototype.La,Bn.prototype.open=Bn.prototype.Ka,Bn.prototype.close=Bn.prototype.close,Zt.NO_ERROR=0,Zt.TIMEOUT=8,Zt.HTTP_ERROR=6,te.COMPLETE="complete",ne.EventType=ie,ie.OPEN="a",ie.CLOSE="b",ie.ERROR="c",ie.MESSAGE="d",It.prototype.listen=It.prototype.ra,hn.prototype.listenOnce=hn.prototype.sa,hn.prototype.getLastError=hn.prototype.Ma,hn.prototype.getLastErrorCode=hn.prototype.qa,hn.prototype.getStatus=hn.prototype.S,hn.prototype.getResponseJson=hn.prototype.Ja,hn.prototype.getResponseText=hn.prototype.Y,hn.prototype.send=hn.prototype.$;var Qn={createWebChannelTransport:function(){return new qn},ErrorCode:Zt,EventType:te,WebChannel:ne,XhrIo:hn},Hn=Qn.createWebChannelTransport,Kn=Qn.ErrorCode,Xn=Qn.EventType,$n=Qn.WebChannel,Yn=Qn.XhrIo;e.default=Qn},zVF4:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("Tr+X"),i={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"},o=function(t,e){if(!t)throw s(e)},s=function(t){return new Error("Firebase Database ("+i.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)},u=function(t){for(var e=[],n=0,r=0;r<t.length;r++){var i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=63&i|128):55296==(64512&i)&&r+1<t.length&&56320==(64512&t.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&t.charCodeAt(++r)),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=63&i|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=63&i|128)}return e},a={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<t.length;i+=3){var o=t[i],s=i+1<t.length,u=s?t[i+1]:0,a=i+2<t.length,c=a?t[i+2]:0,h=(15&u)<<2|c>>6,f=63&c;a||(f=64,s||(h=64)),r.push(n[o>>2],n[(3&o)<<4|u>>4],n[h],n[f])}return r.join("")},encodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(u(t),e)},decodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){for(var e=[],n=0,r=0;n<t.length;){var i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){var o=t[n++];e[r++]=String.fromCharCode((31&i)<<6|63&o)}else if(i>239&&i<365){var s=((7&i)<<18|(63&(o=t[n++]))<<12|(63&(u=t[n++]))<<6|63&t[n++])-65536;e[r++]=String.fromCharCode(55296+(s>>10)),e[r++]=String.fromCharCode(56320+(1023&s))}else{o=t[n++];var u=t[n++];e[r++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&u)}}return e.join("")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray:function(t,e){this.init_();for(var n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<t.length;){var o=n[t.charAt(i++)],s=i<t.length?n[t.charAt(i)]:0,u=++i<t.length?n[t.charAt(i)]:64,a=++i<t.length?n[t.charAt(i)]:64;if(++i,null==o||null==s||null==u||null==a)throw Error();r.push(o<<2|s>>4),64!==u&&(r.push(s<<4&240|u>>2),64!==a&&r.push(u<<6&192|a))}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},c=function(t){try{return a.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function h(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:return new Date(e.getTime());case Object:void 0===t&&(t={});break;case Array:t=[];break;default:return e}for(var n in e)e.hasOwnProperty(n)&&(t[n]=h(t[n],e[n]));return t}var f=function(){function t(){var t=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))}return t.prototype.wrapCallback=function(t){var e=this;return function(n,r){n?e.reject(n):e.resolve(r),"function"==typeof t&&(e.promise.catch((function(){})),1===t.length?t(n):t(n,r))}},t}();function l(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function p(){try{return"[object process]"===Object.prototype.toString.call(global.process)}catch(t){return!1}}var d=function(t){function e(n,r){var i=t.call(this,r)||this;return i.code=n,i.name="FirebaseError",Object.setPrototypeOf(i,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(i,y.prototype.create),i}return r.__extends(e,t),e}(Error),y=function(){function t(t,e,n){this.service=t,this.serviceName=e,this.errors=n}return t.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=e[0]||{},i=this.service+"/"+t,o=this.errors[t],s=o?v(o,r):"Error",u=this.serviceName+": "+s+" ("+i+").",a=new d(i,u),c=0,h=Object.keys(r);c<h.length;c++){var f=h[c];"_"!==f.slice(-1)&&(f in a&&console.warn('Overwriting FirebaseError base field "'+f+'" can cause unexpected behavior.'),a[f]=r[f])}return a},t}();function v(t,e){return t.replace(g,(function(t,n){var r=e[n];return null!=r?String(r):"<"+n+"?>"}))}var g=/\{\$([^}]+)}/g;function b(t){return JSON.parse(t)}var m=function(t){var e={},n={},r={},i="";try{var o=t.split(".");e=b(c(o[0])||""),n=b(c(o[1])||""),i=o[2],r=n.d||{},delete n.d}catch(s){}return{header:e,claims:n,data:r,signature:i}},w=function(){function t(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(var t=1;t<this.blockSize;++t)this.pad_[t]=0;this.reset()}return t.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},t.prototype.compress_=function(t,e){e||(e=0);var n=this.W_;if("string"==typeof t)for(var r=0;r<16;r++)n[r]=t.charCodeAt(e)<<24|t.charCodeAt(e+1)<<16|t.charCodeAt(e+2)<<8|t.charCodeAt(e+3),e+=4;else for(r=0;r<16;r++)n[r]=t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3],e+=4;for(r=16;r<80;r++)n[r]=4294967295&((f=n[r-3]^n[r-8]^n[r-14]^n[r-16])<<1|f>>>31);var i,o,s=this.chain_[0],u=this.chain_[1],a=this.chain_[2],c=this.chain_[3],h=this.chain_[4];for(r=0;r<80;r++){r<40?r<20?(i=c^u&(a^c),o=1518500249):(i=u^a^c,o=1859775393):r<60?(i=u&a|c&(u|a),o=2400959708):(i=u^a^c,o=3395469782);var f=(s<<5|s>>>27)+i+h+o+n[r]&4294967295;h=c,c=a,a=4294967295&(u<<30|u>>>2),u=s,s=f}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+u&4294967295,this.chain_[2]=this.chain_[2]+a&4294967295,this.chain_[3]=this.chain_[3]+c&4294967295,this.chain_[4]=this.chain_[4]+h&4294967295},t.prototype.update=function(t,e){if(null!=t){void 0===e&&(e=t.length);for(var n=e-this.blockSize,r=0,i=this.buf_,o=this.inbuf_;r<e;){if(0===o)for(;r<=n;)this.compress_(t,r),r+=this.blockSize;if("string"==typeof t){for(;r<e;)if(i[o]=t.charCodeAt(r),++r,++o===this.blockSize){this.compress_(i),o=0;break}}else for(;r<e;)if(i[o]=t[r],++r,++o===this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=e}},t.prototype.digest=function(){var t=[],e=8*this.total_;this.update(this.pad_,this.inbuf_<56?56-this.inbuf_:this.blockSize-(this.inbuf_-56));for(var n=this.blockSize-1;n>=56;n--)this.buf_[n]=255&e,e/=256;this.compress_(this.buf_);var r=0;for(n=0;n<5;n++)for(var i=24;i>=0;i-=8)t[r]=this.chain_[n]>>i&255,++r;return t},t}(),_=function(){function t(t,e){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then((function(){t(n)})).catch((function(t){n.error(t)}))}return t.prototype.next=function(t){this.forEachObserver((function(e){e.next(t)}))},t.prototype.error=function(t){this.forEachObserver((function(e){e.error(t)})),this.close(t)},t.prototype.complete=function(){this.forEachObserver((function(t){t.complete()})),this.close()},t.prototype.subscribe=function(t,e,n){var r,i=this;if(void 0===t&&void 0===e&&void 0===n)throw new Error("Missing Observer.");void 0===(r=function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=0,r=["next","error","complete"];n<r.length;n++){var i=r[n];if(i in t&&"function"==typeof t[i])return!0}return!1}(t)?t:{next:t,error:e,complete:n}).next&&(r.next=I),void 0===r.error&&(r.error=I),void 0===r.complete&&(r.complete=I);var o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(t){}})),this.observers.push(r),o},t.prototype.unsubscribeOne=function(t){void 0!==this.observers&&void 0!==this.observers[t]&&(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},t.prototype.forEachObserver=function(t){if(!this.finalized)for(var e=0;e<this.observers.length;e++)this.sendOne(e,t)},t.prototype.sendOne=function(t,e){var n=this;this.task.then((function(){if(void 0!==n.observers&&void 0!==n.observers[t])try{e(n.observers[t])}catch(r){"undefined"!=typeof console&&console.error&&console.error(r)}}))},t.prototype.close=function(t){var e=this;this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then((function(){e.observers=void 0,e.onNoObservers=void 0})))},t}();function I(){}function E(t,e,n){var r="";switch(e){case 1:r=n?"first":"First";break;case 2:r=n?"second":"Second";break;case 3:r=n?"third":"Third";break;case 4:r=n?"fourth":"Fourth";break;default:throw new Error("errorPrefix called with argumentNumber > 4.  Need to update it?")}return t+" failed: "+r+" argument "}e.CONSTANTS=i,e.Deferred=f,e.ErrorFactory=y,e.FirebaseError=d,e.Sha1=w,e.areCookiesEnabled=function(){return!(!navigator||!navigator.cookieEnabled)},e.assert=o,e.assertionError=s,e.async=function(t,e){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];Promise.resolve(!0).then((function(){t.apply(void 0,n)})).catch((function(t){e&&e(t)}))}},e.base64=a,e.base64Decode=c,e.base64Encode=function(t){var e=u(t);return a.encodeByteArray(e,!0)},e.contains=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.createSubscribe=function(t,e){var n=new _(t,e);return n.subscribe.bind(n)},e.decode=m,e.deepCopy=function(t){return h(void 0,t)},e.deepExtend=h,e.errorPrefix=E,e.getUA=l,e.isAdmin=function(t){var e=m(t).claims;return"object"==typeof e&&!0===e.admin},e.isBrowser=function(){return"object"==typeof self&&self.self===self},e.isBrowserExtension=function(){var t="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof t&&void 0!==t.id},e.isElectron=function(){return l().indexOf("Electron/")>=0},e.isEmpty=function(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0},e.isIE=function(){var t=l();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0},e.isIndexedDBAvailable=function(){return"indexedDB"in window&&null!==indexedDB},e.isMobileCordova=function(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(l())},e.isNode=p,e.isNodeSdk=function(){return!0===i.NODE_CLIENT||!0===i.NODE_ADMIN},e.isReactNative=function(){return"object"==typeof navigator&&"ReactNative"===navigator.product},e.isSafari=function(){return!p()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")},e.isUWP=function(){return l().indexOf("MSAppHost/")>=0},e.isValidFormat=function(t){var e=m(t).claims;return!!e&&"object"==typeof e&&e.hasOwnProperty("iat")},e.isValidTimestamp=function(t){var e=m(t).claims,n=Math.floor((new Date).getTime()/1e3),r=0,i=0;return"object"==typeof e&&(e.hasOwnProperty("nbf")?r=e.nbf:e.hasOwnProperty("iat")&&(r=e.iat),i=e.hasOwnProperty("exp")?e.exp:r+86400),!!n&&!!r&&!!i&&n>=r&&n<=i},e.issuedAtTime=function(t){var e=m(t).claims;return"object"==typeof e&&e.hasOwnProperty("iat")?e.iat:null},e.jsonEval=b,e.map=function(t,e,n){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(r[i]=e.call(n,t[i],i,t));return r},e.querystring=function(t){for(var e=[],n=function(t,n){Array.isArray(n)?n.forEach((function(n){e.push(encodeURIComponent(t)+"="+encodeURIComponent(n))})):e.push(encodeURIComponent(t)+"="+encodeURIComponent(n))},r=0,i=Object.entries(t);r<i.length;r++){var o=i[r];n(o[0],o[1])}return e.length?"&"+e.join("&"):""},e.querystringDecode=function(t){var e={};return t.replace(/^\?/,"").split("&").forEach((function(t){if(t){var n=t.split("=");e[n[0]]=n[1]}})),e},e.safeGet=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)?t[e]:void 0},e.stringLength=function(t){for(var e=0,n=0;n<t.length;n++){var r=t.charCodeAt(n);r<128?e++:r<2048?e+=2:r>=55296&&r<=56319?(e+=4,n++):e+=3}return e},e.stringToByteArray=function(t){for(var e=[],n=0,r=0;r<t.length;r++){var i=t.charCodeAt(r);if(i>=55296&&i<=56319){var s=i-55296;r++,o(r<t.length,"Surrogate pair missing trail surrogate."),i=65536+(s<<10)+(t.charCodeAt(r)-56320)}i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=63&i|128):i<65536?(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=63&i|128):(e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=63&i|128)}return e},e.stringify=function(t){return JSON.stringify(t)},e.validateArgCount=function(t,e,n,r){var i;if(r<e?i="at least "+e:r>n&&(i=0===n?"none":"no more than "+n),i)throw new Error(t+" failed: Was called with "+r+(1===r?" argument.":" arguments.")+" Expects "+i+".")},e.validateCallback=function(t,e,n,r){if((!r||n)&&"function"!=typeof n)throw new Error(E(t,e,r)+"must be a valid function.")},e.validateContextObject=function(t,e,n,r){if((!r||n)&&("object"!=typeof n||null===n))throw new Error(E(t,e,r)+"must be a valid context object.")},e.validateIndexedDBOpenable=function(){return new Promise((function(t,e){try{var n=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=window.indexedDB.open(r);i.onsuccess=function(){i.result.close(),n||window.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=function(){n=!1},i.onerror=function(){var t;e((null===(t=i.error)||void 0===t?void 0:t.message)||"")}}catch(o){e(o)}}))},e.validateNamespace=function(t,e,n,r){if((!r||n)&&"string"!=typeof n)throw new Error(E(t,e,r)+"must be a valid firebase namespace.")}}}]);
//# sourceMappingURL=main-main-module.6b5976bf325dc2483a9a.js.map